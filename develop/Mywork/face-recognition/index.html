
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="知足且上进，温柔且坚定">
      
      
        <meta name="author" content="王科文(Wcowin)">
      
      
        <link rel="canonical" href="http://wcowin.work/develop/Mywork/face-recognition/">
      
      
        <link rel="prev" href="../muplayer/">
      
      
        <link rel="next" href="../email/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS 订阅" href="../../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="已更新内容的 RSS 订阅" href="../../../feed_rss_updated.xml">
      
      <link rel="icon" href="https://i.stardots.io/wcowin/1750090373988.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>人脸识别系统 - Wcowin's Blog</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra2.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/link.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/customize.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/ziti.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
      <link rel="stylesheet" href="../../../assets/document_dates/tippy/light.css">
    
      <link rel="stylesheet" href="../../../assets/document_dates/tippy/material.css">
    
      <link rel="stylesheet" href="../../../assets/document_dates/tippy/tippy.css">
    
      <link rel="stylesheet" href="../../../assets/document_dates/tippy/scale.css">
    
      <link rel="stylesheet" href="../../../assets/document_dates/tippy/shift-away.css">
    
      <link rel="stylesheet" href="../../../assets/document_dates/tippy/backdrop.css">
    
      <link rel="stylesheet" href="../../../assets/document_dates/core/core.css">
    
      <link rel="stylesheet" href="../../../assets/document_dates/user.config.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-29HZMNR0KG"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-29HZMNR0KG",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-29HZMNR0KG",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="Wcowin&#39;s Blog" class="md-header__button md-logo" aria-label="Wcowin's Blog" data-md-component="logo">
      
  <img src="https://pica.zhimg.com/80/v2-74ecd899c7c4cc0258930eaff239a21b_1440w.webp" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Wcowin's Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              人脸识别系统
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="关闭自动模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="关闭自动模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="切换至夜间模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换至夜间模式" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="切换至日间模式"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="切换至日间模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="选择当前语言">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 128c0-35.3 28.7-64 64-64h512c35.3 0 64 28.7 64 64v256c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64zm320 0v256h256V128zm-141.7 47.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4zM160 233.2l19 42.8h-38zM448 164c11 0 20 9 20 20v4h60c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5 0-28.3s20.5-7.8 28.3 0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45l-35.2.1h-72c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/" hreflang="zh" class="md-select__link">
              简体中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/en/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/ZH-TW/" hreflang="Taiwan" class="md-select__link">
              ZH-TW
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Wcowin/Wcowin.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Wcowin.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../blog/indexblog/" class="md-tabs__link">
          
  
  
    
  
  技术

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  开发

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../relax/" class="md-tabs__link">
          
  
  
    
  
  闲聊

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../trip/" class="md-tabs__link">
          
  
  
    
  
  旅行

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../tag/" class="md-tabs__link">
        
  
  
    
  
  标签

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../waline/" class="md-tabs__link">
        
  
  
    
  
  留言板

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../link/" class="md-tabs__link">
          
  
  
    
  
  朋友

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../blog/" class="md-tabs__link">
          
  
  
    
  
  博客

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../about/geren/" class="md-tabs__link">
          
  
  
    
  
  关于

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://wcowin.work/Mkdocs-Wcowin/" class="md-tabs__link">
        
  
  
    
  
  Mkdocs教程

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://wcowin.work/Personal-Profile/#" class="md-tabs__link">
        
  
  
    
  
  个人简介

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://www.travellings.cn/go.html" class="md-tabs__link">
        
  
  
    
  
  开往

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Wcowin&#39;s Blog" class="md-nav__button md-logo" aria-label="Wcowin's Blog" data-md-component="logo">
      
  <img src="https://pica.zhimg.com/80/v2-74ecd899c7c4cc0258930eaff239a21b_1440w.webp" alt="logo">

    </a>
    Wcowin's Blog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Wcowin/Wcowin.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Wcowin.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../blog/indexblog/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    技术
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    开发
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            开发
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deepseek/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DeepSeek:从入门到精通
    
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="最近添加">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    MCP
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            MCP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://mcp-docs.cn/introduction" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MCP中文文档
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AI/mcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is MCP
    
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="最近添加">
    </span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AI工具
    
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="最近添加">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ChatGPT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    如何注册ChatGPT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mydevice/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    我的设备
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Markdown
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Markdown
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Markdown/markdown/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Markdown指南
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Markdown/MWeb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MWeb Pro
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git 实用技巧
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" checked>
        
          
          <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    我的项目/作品
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            我的项目/作品
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mkdocs-wcowin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Wcowin for MkDocs主题
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../muplayer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    简单的 JavaScript 音乐播放器
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    人脸识别系统
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    人脸识别系统
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      基本原理
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      创建虚拟环境
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      我在原作者基础上做的优化版
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      效果
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ing" class="md-nav__link">
    <span class="md-ellipsis">
      持续优化ing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      参考文献
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../email/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    用AirScript脚本给女/男朋友发送每日早安邮件(极简版本)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../face_compare/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    基于讯飞人脸算法进行人脸比对
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../opencv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    基于百度API和opencv的智能车牌识别程序
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aizhiwu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    利用百度API进行植物识别
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    玩的设计
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_10" >
        
          
          <label class="md-nav__link" for="__nav_2_10" id="__nav_2_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    设计美学
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            设计美学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../designbeauty/db1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    唐·诺曼—情感设计的三个层次
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../designbeauty/my-to-desihn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    我对设计的一些观点
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1024code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1024code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lighthouse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    利用Lighthouse测试网站性能
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Github/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is Github
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vercel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    如何将 github pages 迁移到 vercel 上托管
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fenxiang/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    大厂们的良心软件～
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Mac/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    写给所有 Mac 用户的摸鱼指北
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kanyuanma/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    看源码才懂
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../relax/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    闲聊
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../trip/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    旅行
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    标签
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../waline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    留言板
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../link/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    朋友
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../blog/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    博客
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../about/geren/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    关于
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://wcowin.work/Mkdocs-Wcowin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mkdocs教程
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://wcowin.work/Personal-Profile/#" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    个人简介
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.travellings.cn/go.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    开往
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      基本原理
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      创建虚拟环境
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      我在原作者基础上做的优化版
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      效果
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ing" class="md-nav__link">
    <span class="md-ellipsis">
      持续优化ing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      参考文献
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags" >
    
      
      
      
        <a href="../../../tag/#tag:我的作品" class="md-tag">我的作品</a>
      
    
  </nav>


  
  


  <h1>人脸识别系统</h1>

<div class="admonition info">
<p class="admonition-title">💾 AI智能摘要 (GLM-4)</p>
<p>本文介绍了一个基于300行Python代码实现的人脸识别系统，采用dlib库进行数据收集与预处理，深度学习模型提取特征向量，支持实时检测、识别和用户交互。通过优化，系统识别精度显著提升，支持多人脸识别和多种模型，并具备人脸图像预处理和隐私安全保护功能。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">📖 阅读信息</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"/></svg></span>阅读时间：<strong>5</strong> 分钟 | <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"/></svg></span>中文字符：<strong>1852</strong> | <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"/></svg></span>有效代码行数：<strong>725</strong></p>
</div>
<div class='document-dates-plugin-wrapper document-dates-top'><div class='document-dates-plugin'><span data-tippy-content='创建时间: 2023-09-23'><span class='material-icons' data-icon='doc_created'></span><time datetime='2023-09-23T01:47:24' locale='zh_CN'>2023-09-23</time></span><span data-tippy-content='最后更新: 2025-07-08'><span class='material-icons' data-icon='doc_modified'></span><time datetime='2025-07-08T04:17:57.948280' locale='zh_CN'>2025-07-08</time></span><span data-tippy-content='作者: <a href="mailto:1135801806@qq.com">Wcowin</a>'><span class='material-icons' data-icon='doc_author'></span>Wcowin</span></div></div>
<p><strong>原文：</strong></p>
<blockquote>
<p>Bilibili:  <a href="https://www.bilibili.com/video/BV1ZZ4y1S76N/" target="_blank">用300行代码实现人脸识别系统_哔哩哔哩_bilibili</a>    </p>
<p>CSDN博客：<a href="https://blog.csdn.net/ECHOSON/article/details/122404926" target="_blank">用300行Python代码实现一个人脸识别系统_dejahu的博客-CSDN博客</a></p>
</blockquote>
<h2 id="_1">基本原理<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>数据收集与预处理:<br />
首先，主要是借助dlib库，系统需要收集用于人脸识别的数据。这些数据包括已知身份的人脸图像，通常是系统的训练数据集。这些图像将用于创建人脸特征向量以及后续的人脸匹配。在收集数据后，对图像进行预处理，包括增强图像质量、调整大小和归一化等操作，以便进行更准确的识别。</p>
<p>人脸特征提取:<br />
对于每个人脸图像，系统使用人脸识别模型（通常是深度学习模型）来提取人脸的特征向量。这些特征向量是对人脸的独特表示，用于后续的比对和匹配。</p>
<p>人脸识别模型:<br />
通常，系统使用已经训练好的深度学习模型，例如基于卷积神经网络（CNN）的模型来进行人脸特征提取。这些模型在训练阶段学会了如何从人脸图像中提取有用的特征。</p>
<p>实时检测与识别:<br />
在实时检测过程中，系统捕捉视频流或图像帧，并使用人脸检测算法（例如Haar级联分类器或更高级的人脸检测器）来检测图像中的人脸位置。一旦检测到人脸，系统会提取该人脸的特征向量。</p>
<p>人脸匹配:<br />
提取的人脸特征向量与已知的人脸特征向量进行比对。这可以通过计算两个特征向量之间的相似度来实现。如果相似度超过预定的阈值（例如0.5），则认为是同一个人，否则被标记为“未知”。</p>
<p>结果显示:<br />
识别结果会显示在屏幕上，通常会在人脸周围绘制边界框，并显示人名或"Unknown"，表示未知身份。这些结果会实时更新，以便用户可以在视频流或图像中看到识别的人脸。</p>
<p>用户交互:<br />
系统通常提供用户交互界面，允许用户上传图像、开始或停止实时识别，并可能提供管理已知人脸数据的功能</p>
<p><strong>示意图</strong>
<img alt="image-20220109232309780" src="https://vehicle4cm.oss-cn-beijing.aliyuncs.com/typoraimgs/image-20220109232309780.png" />  </p>
<h2 id="_2">创建虚拟环境<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>创建虚拟环境前先下载<a href="https://gitee.com/song-laogou/face_dlib_py37_42" target="_blank">源码</a>到本地。</p>
<p>需要使用到python3.7的虚拟环境，命令如下：
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>face<span class="w"> </span><span class="nv">python</span><span class="o">==</span><span class="m">3</span>.7.3
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>conda<span class="w"> </span>activate<span class="w"> </span>face
</code></pre></div></td></tr></table></div></p>
<p>跑轮子（原作者<a href="https://mbd.pub/o/bread/ZJeYkpdt?next=pay&amp;author_name=肆十二&amp;author_avatar=https%3A%2F%2Fcdn.2zimu.com%2Fmbd_file_1679134971152.jpg">这里</a>是要钱的，轮子也是必要的，其实也有其他方法实现，但是<strong>我也付费了的</strong>，也请尊重知识付费）
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>pip<span class="w"> </span>install<span class="w"> </span>dlib-19.17.0-cp37-cp37m-win_amd64.whl
</code></pre></div></td></tr></table></div></p>
<p>安装必要的库
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</code></pre></div></td></tr></table></div></p>
<p>运行<br />
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>python<span class="w"> </span>文件名.py
</code></pre></div></td></tr></table></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>如果Anaconda都不会，移步：<br />
<a href="https://blog.csdn.net/ECHOSON/article/details/117220445" target="_blank">如何在pycharm中配置anaconda的虚拟环境</a> <br />
<a href="https://www.bilibili.com/video/BV15o4y127Rt/?vd_source=4c6908c51297ba49ec55863b71e0d24f" target="_blank">Python学习中Anaconda和Pycharm的正确打开方式</a></p>
</div>
<p>Pycharm/Vs code也不会的话，那…………下面的内容就不推荐阅读了</p>
<h2 id="_3">我在原作者基础上做的优化版<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>提高人脸识别精度的改进：</p>
<ol>
<li>
<p><strong>增加人脸图像的数量和多样性</strong>：在数据库中收集更多不同角度、不同光照条件下的人脸图像，以便算法可以更好地适应不同情况。</p>
</li>
<li>
<p><strong>使用更高级的人脸识别模型</strong>：你目前使用的是基于dlib的人脸识别模型，可以考虑使用更高级的模型，例如基于深度学习的人脸识别模型，如FaceNet、VGGFace等。这些模型在大规模人脸识别任务上表现良好。</p>
</li>
<li>
<p><strong>进行人脸图像预处理</strong>：你可以在上传人脸图像时进行一些预处理，例如：</p>
</li>
<li>图像增强：你已经在代码中实现了对比度增强，可以考虑添加其他增强技术，如直方图均衡化，以改善图像质量。</li>
<li>人脸对齐：确保上传的人脸图像都经过对齐，这有助于减少姿态和光照差异对识别的影响。</li>
</ol>
<p>（4. <strong>调整识别阈值</strong>：在代码中，你可以通过调整人脸匹配的阈值来控制识别的严格程度。较高的阈值会提高识别的准确性，但可能会导致漏识别。较低的阈值可能会增加误识别的风险。</p>
<ol>
<li>
<p><strong>处理多个人脸的情况</strong>：当前的代码处理多个人脸时，只返回最相似的一个人名，你可以考虑扩展代码以识别和标识多个人脸。</p>
</li>
<li>
<p><strong>引入人脸质量评估</strong>：在进行人脸匹配之前，可以使用人脸质量评估工具来评估图像中人脸的质量，然后选择性地处理质量较高的人脸，以提高准确性。</p>
</li>
<li>
<p><strong>在线学习和更新</strong>：允许用户根据新上传的人脸图像不断更新人脸数据库，以不断改进模型的性能。</p>
</li>
<li>
<p><strong>异常处理</strong>：在人脸检测和识别中，添加异常处理，以应对检测不到人脸或识别失败的情况，并提供用户友好的反馈。</p>
</li>
<li>
<p><strong>考虑隐私和安全性</strong>：确保你的人脸识别系统遵守隐私法规，并采取适当的安全措施，以防止滥用和数据泄漏。</p>
</li>
<li>
<p><strong>性能优化</strong>：对于实时人脸识别，优化代码以提高处理速度，以便更快地响应用户的请求。）</p>
</li>
</ol>
<p><strong>后面几条暂未实现</strong>，但是也增加了100多行代码</p>
<p>代码如下，已做注释：
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">  1</a></span>
<span class="normal"><a href="#__codelineno-4-2">  2</a></span>
<span class="normal"><a href="#__codelineno-4-3">  3</a></span>
<span class="normal"><a href="#__codelineno-4-4">  4</a></span>
<span class="normal"><a href="#__codelineno-4-5">  5</a></span>
<span class="normal"><a href="#__codelineno-4-6">  6</a></span>
<span class="normal"><a href="#__codelineno-4-7">  7</a></span>
<span class="normal"><a href="#__codelineno-4-8">  8</a></span>
<span class="normal"><a href="#__codelineno-4-9">  9</a></span>
<span class="normal"><a href="#__codelineno-4-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-4-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-4-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-4-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-4-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-4-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-4-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-4-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-4-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-4-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-4-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-4-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-4-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-4-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-4-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-4-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-4-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-4-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-4-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-4-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-4-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-4-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-4-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-4-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-4-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-4-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-4-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-4-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-4-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-4-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-4-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-4-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-4-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-4-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-4-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-4-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-4-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-4-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-4-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-4-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-4-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-4-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-4-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-4-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-4-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-4-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-4-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-4-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-4-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-4-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-4-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-4-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-4-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-4-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-4-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-4-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-4-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-4-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-4-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-4-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-4-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-4-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-4-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-4-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-4-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-4-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-4-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-4-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-4-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-4-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-4-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-4-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-4-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-4-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-4-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-4-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-4-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-4-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-4-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-4-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-4-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-4-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-4-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-4-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-4-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-4-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-4-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-4-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-4-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-4-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-4-100">100</a></span>
<span class="normal"><a href="#__codelineno-4-101">101</a></span>
<span class="normal"><a href="#__codelineno-4-102">102</a></span>
<span class="normal"><a href="#__codelineno-4-103">103</a></span>
<span class="normal"><a href="#__codelineno-4-104">104</a></span>
<span class="normal"><a href="#__codelineno-4-105">105</a></span>
<span class="normal"><a href="#__codelineno-4-106">106</a></span>
<span class="normal"><a href="#__codelineno-4-107">107</a></span>
<span class="normal"><a href="#__codelineno-4-108">108</a></span>
<span class="normal"><a href="#__codelineno-4-109">109</a></span>
<span class="normal"><a href="#__codelineno-4-110">110</a></span>
<span class="normal"><a href="#__codelineno-4-111">111</a></span>
<span class="normal"><a href="#__codelineno-4-112">112</a></span>
<span class="normal"><a href="#__codelineno-4-113">113</a></span>
<span class="normal"><a href="#__codelineno-4-114">114</a></span>
<span class="normal"><a href="#__codelineno-4-115">115</a></span>
<span class="normal"><a href="#__codelineno-4-116">116</a></span>
<span class="normal"><a href="#__codelineno-4-117">117</a></span>
<span class="normal"><a href="#__codelineno-4-118">118</a></span>
<span class="normal"><a href="#__codelineno-4-119">119</a></span>
<span class="normal"><a href="#__codelineno-4-120">120</a></span>
<span class="normal"><a href="#__codelineno-4-121">121</a></span>
<span class="normal"><a href="#__codelineno-4-122">122</a></span>
<span class="normal"><a href="#__codelineno-4-123">123</a></span>
<span class="normal"><a href="#__codelineno-4-124">124</a></span>
<span class="normal"><a href="#__codelineno-4-125">125</a></span>
<span class="normal"><a href="#__codelineno-4-126">126</a></span>
<span class="normal"><a href="#__codelineno-4-127">127</a></span>
<span class="normal"><a href="#__codelineno-4-128">128</a></span>
<span class="normal"><a href="#__codelineno-4-129">129</a></span>
<span class="normal"><a href="#__codelineno-4-130">130</a></span>
<span class="normal"><a href="#__codelineno-4-131">131</a></span>
<span class="normal"><a href="#__codelineno-4-132">132</a></span>
<span class="normal"><a href="#__codelineno-4-133">133</a></span>
<span class="normal"><a href="#__codelineno-4-134">134</a></span>
<span class="normal"><a href="#__codelineno-4-135">135</a></span>
<span class="normal"><a href="#__codelineno-4-136">136</a></span>
<span class="normal"><a href="#__codelineno-4-137">137</a></span>
<span class="normal"><a href="#__codelineno-4-138">138</a></span>
<span class="normal"><a href="#__codelineno-4-139">139</a></span>
<span class="normal"><a href="#__codelineno-4-140">140</a></span>
<span class="normal"><a href="#__codelineno-4-141">141</a></span>
<span class="normal"><a href="#__codelineno-4-142">142</a></span>
<span class="normal"><a href="#__codelineno-4-143">143</a></span>
<span class="normal"><a href="#__codelineno-4-144">144</a></span>
<span class="normal"><a href="#__codelineno-4-145">145</a></span>
<span class="normal"><a href="#__codelineno-4-146">146</a></span>
<span class="normal"><a href="#__codelineno-4-147">147</a></span>
<span class="normal"><a href="#__codelineno-4-148">148</a></span>
<span class="normal"><a href="#__codelineno-4-149">149</a></span>
<span class="normal"><a href="#__codelineno-4-150">150</a></span>
<span class="normal"><a href="#__codelineno-4-151">151</a></span>
<span class="normal"><a href="#__codelineno-4-152">152</a></span>
<span class="normal"><a href="#__codelineno-4-153">153</a></span>
<span class="normal"><a href="#__codelineno-4-154">154</a></span>
<span class="normal"><a href="#__codelineno-4-155">155</a></span>
<span class="normal"><a href="#__codelineno-4-156">156</a></span>
<span class="normal"><a href="#__codelineno-4-157">157</a></span>
<span class="normal"><a href="#__codelineno-4-158">158</a></span>
<span class="normal"><a href="#__codelineno-4-159">159</a></span>
<span class="normal"><a href="#__codelineno-4-160">160</a></span>
<span class="normal"><a href="#__codelineno-4-161">161</a></span>
<span class="normal"><a href="#__codelineno-4-162">162</a></span>
<span class="normal"><a href="#__codelineno-4-163">163</a></span>
<span class="normal"><a href="#__codelineno-4-164">164</a></span>
<span class="normal"><a href="#__codelineno-4-165">165</a></span>
<span class="normal"><a href="#__codelineno-4-166">166</a></span>
<span class="normal"><a href="#__codelineno-4-167">167</a></span>
<span class="normal"><a href="#__codelineno-4-168">168</a></span>
<span class="normal"><a href="#__codelineno-4-169">169</a></span>
<span class="normal"><a href="#__codelineno-4-170">170</a></span>
<span class="normal"><a href="#__codelineno-4-171">171</a></span>
<span class="normal"><a href="#__codelineno-4-172">172</a></span>
<span class="normal"><a href="#__codelineno-4-173">173</a></span>
<span class="normal"><a href="#__codelineno-4-174">174</a></span>
<span class="normal"><a href="#__codelineno-4-175">175</a></span>
<span class="normal"><a href="#__codelineno-4-176">176</a></span>
<span class="normal"><a href="#__codelineno-4-177">177</a></span>
<span class="normal"><a href="#__codelineno-4-178">178</a></span>
<span class="normal"><a href="#__codelineno-4-179">179</a></span>
<span class="normal"><a href="#__codelineno-4-180">180</a></span>
<span class="normal"><a href="#__codelineno-4-181">181</a></span>
<span class="normal"><a href="#__codelineno-4-182">182</a></span>
<span class="normal"><a href="#__codelineno-4-183">183</a></span>
<span class="normal"><a href="#__codelineno-4-184">184</a></span>
<span class="normal"><a href="#__codelineno-4-185">185</a></span>
<span class="normal"><a href="#__codelineno-4-186">186</a></span>
<span class="normal"><a href="#__codelineno-4-187">187</a></span>
<span class="normal"><a href="#__codelineno-4-188">188</a></span>
<span class="normal"><a href="#__codelineno-4-189">189</a></span>
<span class="normal"><a href="#__codelineno-4-190">190</a></span>
<span class="normal"><a href="#__codelineno-4-191">191</a></span>
<span class="normal"><a href="#__codelineno-4-192">192</a></span>
<span class="normal"><a href="#__codelineno-4-193">193</a></span>
<span class="normal"><a href="#__codelineno-4-194">194</a></span>
<span class="normal"><a href="#__codelineno-4-195">195</a></span>
<span class="normal"><a href="#__codelineno-4-196">196</a></span>
<span class="normal"><a href="#__codelineno-4-197">197</a></span>
<span class="normal"><a href="#__codelineno-4-198">198</a></span>
<span class="normal"><a href="#__codelineno-4-199">199</a></span>
<span class="normal"><a href="#__codelineno-4-200">200</a></span>
<span class="normal"><a href="#__codelineno-4-201">201</a></span>
<span class="normal"><a href="#__codelineno-4-202">202</a></span>
<span class="normal"><a href="#__codelineno-4-203">203</a></span>
<span class="normal"><a href="#__codelineno-4-204">204</a></span>
<span class="normal"><a href="#__codelineno-4-205">205</a></span>
<span class="normal"><a href="#__codelineno-4-206">206</a></span>
<span class="normal"><a href="#__codelineno-4-207">207</a></span>
<span class="normal"><a href="#__codelineno-4-208">208</a></span>
<span class="normal"><a href="#__codelineno-4-209">209</a></span>
<span class="normal"><a href="#__codelineno-4-210">210</a></span>
<span class="normal"><a href="#__codelineno-4-211">211</a></span>
<span class="normal"><a href="#__codelineno-4-212">212</a></span>
<span class="normal"><a href="#__codelineno-4-213">213</a></span>
<span class="normal"><a href="#__codelineno-4-214">214</a></span>
<span class="normal"><a href="#__codelineno-4-215">215</a></span>
<span class="normal"><a href="#__codelineno-4-216">216</a></span>
<span class="normal"><a href="#__codelineno-4-217">217</a></span>
<span class="normal"><a href="#__codelineno-4-218">218</a></span>
<span class="normal"><a href="#__codelineno-4-219">219</a></span>
<span class="normal"><a href="#__codelineno-4-220">220</a></span>
<span class="normal"><a href="#__codelineno-4-221">221</a></span>
<span class="normal"><a href="#__codelineno-4-222">222</a></span>
<span class="normal"><a href="#__codelineno-4-223">223</a></span>
<span class="normal"><a href="#__codelineno-4-224">224</a></span>
<span class="normal"><a href="#__codelineno-4-225">225</a></span>
<span class="normal"><a href="#__codelineno-4-226">226</a></span>
<span class="normal"><a href="#__codelineno-4-227">227</a></span>
<span class="normal"><a href="#__codelineno-4-228">228</a></span>
<span class="normal"><a href="#__codelineno-4-229">229</a></span>
<span class="normal"><a href="#__codelineno-4-230">230</a></span>
<span class="normal"><a href="#__codelineno-4-231">231</a></span>
<span class="normal"><a href="#__codelineno-4-232">232</a></span>
<span class="normal"><a href="#__codelineno-4-233">233</a></span>
<span class="normal"><a href="#__codelineno-4-234">234</a></span>
<span class="normal"><a href="#__codelineno-4-235">235</a></span>
<span class="normal"><a href="#__codelineno-4-236">236</a></span>
<span class="normal"><a href="#__codelineno-4-237">237</a></span>
<span class="normal"><a href="#__codelineno-4-238">238</a></span>
<span class="normal"><a href="#__codelineno-4-239">239</a></span>
<span class="normal"><a href="#__codelineno-4-240">240</a></span>
<span class="normal"><a href="#__codelineno-4-241">241</a></span>
<span class="normal"><a href="#__codelineno-4-242">242</a></span>
<span class="normal"><a href="#__codelineno-4-243">243</a></span>
<span class="normal"><a href="#__codelineno-4-244">244</a></span>
<span class="normal"><a href="#__codelineno-4-245">245</a></span>
<span class="normal"><a href="#__codelineno-4-246">246</a></span>
<span class="normal"><a href="#__codelineno-4-247">247</a></span>
<span class="normal"><a href="#__codelineno-4-248">248</a></span>
<span class="normal"><a href="#__codelineno-4-249">249</a></span>
<span class="normal"><a href="#__codelineno-4-250">250</a></span>
<span class="normal"><a href="#__codelineno-4-251">251</a></span>
<span class="normal"><a href="#__codelineno-4-252">252</a></span>
<span class="normal"><a href="#__codelineno-4-253">253</a></span>
<span class="normal"><a href="#__codelineno-4-254">254</a></span>
<span class="normal"><a href="#__codelineno-4-255">255</a></span>
<span class="normal"><a href="#__codelineno-4-256">256</a></span>
<span class="normal"><a href="#__codelineno-4-257">257</a></span>
<span class="normal"><a href="#__codelineno-4-258">258</a></span>
<span class="normal"><a href="#__codelineno-4-259">259</a></span>
<span class="normal"><a href="#__codelineno-4-260">260</a></span>
<span class="normal"><a href="#__codelineno-4-261">261</a></span>
<span class="normal"><a href="#__codelineno-4-262">262</a></span>
<span class="normal"><a href="#__codelineno-4-263">263</a></span>
<span class="normal"><a href="#__codelineno-4-264">264</a></span>
<span class="normal"><a href="#__codelineno-4-265">265</a></span>
<span class="normal"><a href="#__codelineno-4-266">266</a></span>
<span class="normal"><a href="#__codelineno-4-267">267</a></span>
<span class="normal"><a href="#__codelineno-4-268">268</a></span>
<span class="normal"><a href="#__codelineno-4-269">269</a></span>
<span class="normal"><a href="#__codelineno-4-270">270</a></span>
<span class="normal"><a href="#__codelineno-4-271">271</a></span>
<span class="normal"><a href="#__codelineno-4-272">272</a></span>
<span class="normal"><a href="#__codelineno-4-273">273</a></span>
<span class="normal"><a href="#__codelineno-4-274">274</a></span>
<span class="normal"><a href="#__codelineno-4-275">275</a></span>
<span class="normal"><a href="#__codelineno-4-276">276</a></span>
<span class="normal"><a href="#__codelineno-4-277">277</a></span>
<span class="normal"><a href="#__codelineno-4-278">278</a></span>
<span class="normal"><a href="#__codelineno-4-279">279</a></span>
<span class="normal"><a href="#__codelineno-4-280">280</a></span>
<span class="normal"><a href="#__codelineno-4-281">281</a></span>
<span class="normal"><a href="#__codelineno-4-282">282</a></span>
<span class="normal"><a href="#__codelineno-4-283">283</a></span>
<span class="normal"><a href="#__codelineno-4-284">284</a></span>
<span class="normal"><a href="#__codelineno-4-285">285</a></span>
<span class="normal"><a href="#__codelineno-4-286">286</a></span>
<span class="normal"><a href="#__codelineno-4-287">287</a></span>
<span class="normal"><a href="#__codelineno-4-288">288</a></span>
<span class="normal"><a href="#__codelineno-4-289">289</a></span>
<span class="normal"><a href="#__codelineno-4-290">290</a></span>
<span class="normal"><a href="#__codelineno-4-291">291</a></span>
<span class="normal"><a href="#__codelineno-4-292">292</a></span>
<span class="normal"><a href="#__codelineno-4-293">293</a></span>
<span class="normal"><a href="#__codelineno-4-294">294</a></span>
<span class="normal"><a href="#__codelineno-4-295">295</a></span>
<span class="normal"><a href="#__codelineno-4-296">296</a></span>
<span class="normal"><a href="#__codelineno-4-297">297</a></span>
<span class="normal"><a href="#__codelineno-4-298">298</a></span>
<span class="normal"><a href="#__codelineno-4-299">299</a></span>
<span class="normal"><a href="#__codelineno-4-300">300</a></span>
<span class="normal"><a href="#__codelineno-4-301">301</a></span>
<span class="normal"><a href="#__codelineno-4-302">302</a></span>
<span class="normal"><a href="#__codelineno-4-303">303</a></span>
<span class="normal"><a href="#__codelineno-4-304">304</a></span>
<span class="normal"><a href="#__codelineno-4-305">305</a></span>
<span class="normal"><a href="#__codelineno-4-306">306</a></span>
<span class="normal"><a href="#__codelineno-4-307">307</a></span>
<span class="normal"><a href="#__codelineno-4-308">308</a></span>
<span class="normal"><a href="#__codelineno-4-309">309</a></span>
<span class="normal"><a href="#__codelineno-4-310">310</a></span>
<span class="normal"><a href="#__codelineno-4-311">311</a></span>
<span class="normal"><a href="#__codelineno-4-312">312</a></span>
<span class="normal"><a href="#__codelineno-4-313">313</a></span>
<span class="normal"><a href="#__codelineno-4-314">314</a></span>
<span class="normal"><a href="#__codelineno-4-315">315</a></span>
<span class="normal"><a href="#__codelineno-4-316">316</a></span>
<span class="normal"><a href="#__codelineno-4-317">317</a></span>
<span class="normal"><a href="#__codelineno-4-318">318</a></span>
<span class="normal"><a href="#__codelineno-4-319">319</a></span>
<span class="normal"><a href="#__codelineno-4-320">320</a></span>
<span class="normal"><a href="#__codelineno-4-321">321</a></span>
<span class="normal"><a href="#__codelineno-4-322">322</a></span>
<span class="normal"><a href="#__codelineno-4-323">323</a></span>
<span class="normal"><a href="#__codelineno-4-324">324</a></span>
<span class="normal"><a href="#__codelineno-4-325">325</a></span>
<span class="normal"><a href="#__codelineno-4-326">326</a></span>
<span class="normal"><a href="#__codelineno-4-327">327</a></span>
<span class="normal"><a href="#__codelineno-4-328">328</a></span>
<span class="normal"><a href="#__codelineno-4-329">329</a></span>
<span class="normal"><a href="#__codelineno-4-330">330</a></span>
<span class="normal"><a href="#__codelineno-4-331">331</a></span>
<span class="normal"><a href="#__codelineno-4-332">332</a></span>
<span class="normal"><a href="#__codelineno-4-333">333</a></span>
<span class="normal"><a href="#__codelineno-4-334">334</a></span>
<span class="normal"><a href="#__codelineno-4-335">335</a></span>
<span class="normal"><a href="#__codelineno-4-336">336</a></span>
<span class="normal"><a href="#__codelineno-4-337">337</a></span>
<span class="normal"><a href="#__codelineno-4-338">338</a></span>
<span class="normal"><a href="#__codelineno-4-339">339</a></span>
<span class="normal"><a href="#__codelineno-4-340">340</a></span>
<span class="normal"><a href="#__codelineno-4-341">341</a></span>
<span class="normal"><a href="#__codelineno-4-342">342</a></span>
<span class="normal"><a href="#__codelineno-4-343">343</a></span>
<span class="normal"><a href="#__codelineno-4-344">344</a></span>
<span class="normal"><a href="#__codelineno-4-345">345</a></span>
<span class="normal"><a href="#__codelineno-4-346">346</a></span>
<span class="normal"><a href="#__codelineno-4-347">347</a></span>
<span class="normal"><a href="#__codelineno-4-348">348</a></span>
<span class="normal"><a href="#__codelineno-4-349">349</a></span>
<span class="normal"><a href="#__codelineno-4-350">350</a></span>
<span class="normal"><a href="#__codelineno-4-351">351</a></span>
<span class="normal"><a href="#__codelineno-4-352">352</a></span>
<span class="normal"><a href="#__codelineno-4-353">353</a></span>
<span class="normal"><a href="#__codelineno-4-354">354</a></span>
<span class="normal"><a href="#__codelineno-4-355">355</a></span>
<span class="normal"><a href="#__codelineno-4-356">356</a></span>
<span class="normal"><a href="#__codelineno-4-357">357</a></span>
<span class="normal"><a href="#__codelineno-4-358">358</a></span>
<span class="normal"><a href="#__codelineno-4-359">359</a></span>
<span class="normal"><a href="#__codelineno-4-360">360</a></span>
<span class="normal"><a href="#__codelineno-4-361">361</a></span>
<span class="normal"><a href="#__codelineno-4-362">362</a></span>
<span class="normal"><a href="#__codelineno-4-363">363</a></span>
<span class="normal"><a href="#__codelineno-4-364">364</a></span>
<span class="normal"><a href="#__codelineno-4-365">365</a></span>
<span class="normal"><a href="#__codelineno-4-366">366</a></span>
<span class="normal"><a href="#__codelineno-4-367">367</a></span>
<span class="normal"><a href="#__codelineno-4-368">368</a></span>
<span class="normal"><a href="#__codelineno-4-369">369</a></span>
<span class="normal"><a href="#__codelineno-4-370">370</a></span>
<span class="normal"><a href="#__codelineno-4-371">371</a></span>
<span class="normal"><a href="#__codelineno-4-372">372</a></span>
<span class="normal"><a href="#__codelineno-4-373">373</a></span>
<span class="normal"><a href="#__codelineno-4-374">374</a></span>
<span class="normal"><a href="#__codelineno-4-375">375</a></span>
<span class="normal"><a href="#__codelineno-4-376">376</a></span>
<span class="normal"><a href="#__codelineno-4-377">377</a></span>
<span class="normal"><a href="#__codelineno-4-378">378</a></span>
<span class="normal"><a href="#__codelineno-4-379">379</a></span>
<span class="normal"><a href="#__codelineno-4-380">380</a></span>
<span class="normal"><a href="#__codelineno-4-381">381</a></span>
<span class="normal"><a href="#__codelineno-4-382">382</a></span>
<span class="normal"><a href="#__codelineno-4-383">383</a></span>
<span class="normal"><a href="#__codelineno-4-384">384</a></span>
<span class="normal"><a href="#__codelineno-4-385">385</a></span>
<span class="normal"><a href="#__codelineno-4-386">386</a></span>
<span class="normal"><a href="#__codelineno-4-387">387</a></span>
<span class="normal"><a href="#__codelineno-4-388">388</a></span>
<span class="normal"><a href="#__codelineno-4-389">389</a></span>
<span class="normal"><a href="#__codelineno-4-390">390</a></span>
<span class="normal"><a href="#__codelineno-4-391">391</a></span>
<span class="normal"><a href="#__codelineno-4-392">392</a></span>
<span class="normal"><a href="#__codelineno-4-393">393</a></span>
<span class="normal"><a href="#__codelineno-4-394">394</a></span>
<span class="normal"><a href="#__codelineno-4-395">395</a></span>
<span class="normal"><a href="#__codelineno-4-396">396</a></span>
<span class="normal"><a href="#__codelineno-4-397">397</a></span>
<span class="normal"><a href="#__codelineno-4-398">398</a></span>
<span class="normal"><a href="#__codelineno-4-399">399</a></span>
<span class="normal"><a href="#__codelineno-4-400">400</a></span>
<span class="normal"><a href="#__codelineno-4-401">401</a></span>
<span class="normal"><a href="#__codelineno-4-402">402</a></span>
<span class="normal"><a href="#__codelineno-4-403">403</a></span>
<span class="normal"><a href="#__codelineno-4-404">404</a></span>
<span class="normal"><a href="#__codelineno-4-405">405</a></span>
<span class="normal"><a href="#__codelineno-4-406">406</a></span>
<span class="normal"><a href="#__codelineno-4-407">407</a></span>
<span class="normal"><a href="#__codelineno-4-408">408</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtCore</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFileDialog</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QDockWidget</span><span class="p">,</span> <span class="n">QListWidget</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtGui</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">face_recognition</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">face_recognition_models</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="kn">import</span><span class="w"> </span><span class="nn">locale</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">LC_ALL</span><span class="p">,</span> <span class="s1">&#39;zh_CN.UTF-8&#39;</span><span class="p">)</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="k">def</span><span class="w"> </span><span class="nf">enhance_image_quality</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>    <span class="c1"># 增强对比度</span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a>    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.5</span>  <span class="c1"># 调整对比度的参数</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a>    <span class="n">beta</span> <span class="o">=</span> <span class="mi">30</span>    <span class="c1"># 调整亮度的参数</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a>    <span class="n">enhanced_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">convertScaleAbs</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">)</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a>    <span class="k">return</span> <span class="n">enhanced_image</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a><span class="c1"># 窗口主类</span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="k">class</span><span class="w"> </span><span class="nc">MainWindow</span><span class="p">(</span><span class="n">QTabWidget</span><span class="p">):</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a>    <span class="c1"># 基本配置不动，然后只动第三个界面</span>
<a id="__codelineno-4-28" name="__codelineno-4-28"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a>        <span class="c1"># 初始化设置</span>
<a id="__codelineno-4-30" name="__codelineno-4-30"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-4-31" name="__codelineno-4-31"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;实时人脸识别系统&#39;</span><span class="p">)</span>
<a id="__codelineno-4-32" name="__codelineno-4-32"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">1100</span><span class="p">,</span> <span class="mi">650</span><span class="p">)</span>
<a id="__codelineno-4-33" name="__codelineno-4-33"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="s2">&quot;UI_images/faxian.png&quot;</span><span class="p">))</span>
<a id="__codelineno-4-34" name="__codelineno-4-34"></a>        <span class="c1"># 要上传的图片路径</span>
<a id="__codelineno-4-35" name="__codelineno-4-35"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-4-36" name="__codelineno-4-36"></a>        <span class="c1"># 要检测的图片名称</span>
<a id="__codelineno-4-37" name="__codelineno-4-37"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_fname</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-4-38" name="__codelineno-4-38"></a>        <span class="c1"># 要检测的视频名称</span>
<a id="__codelineno-4-39" name="__codelineno-4-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-4-40" name="__codelineno-4-40"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-4-41" name="__codelineno-4-41"></a>        <span class="c1"># 初始化中止事件</span>
<a id="__codelineno-4-42" name="__codelineno-4-42"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
<a id="__codelineno-4-43" name="__codelineno-4-43"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-4-44" name="__codelineno-4-44"></a>        <span class="c1"># 初始化人脸向量</span>
<a id="__codelineno-4-45" name="__codelineno-4-45"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">known_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">known_encodings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initFaces</span><span class="p">()</span>
<a id="__codelineno-4-46" name="__codelineno-4-46"></a>        <span class="c1"># 加载lbp检测器</span>
<a id="__codelineno-4-47" name="__codelineno-4-47"></a>        <span class="c1"># 加载人脸识别模型</span>
<a id="__codelineno-4-48" name="__codelineno-4-48"></a>        <span class="c1"># 初始化界面</span>
<a id="__codelineno-4-49" name="__codelineno-4-49"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>
<a id="__codelineno-4-50" name="__codelineno-4-50"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-4-51" name="__codelineno-4-51"></a>
<a id="__codelineno-4-52" name="__codelineno-4-52"></a>
<a id="__codelineno-4-53" name="__codelineno-4-53"></a>
<a id="__codelineno-4-54" name="__codelineno-4-54"></a>
<a id="__codelineno-4-55" name="__codelineno-4-55"></a>    <span class="c1"># 初始化数据库的人脸</span>
<a id="__codelineno-4-56" name="__codelineno-4-56"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">initFaces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-57" name="__codelineno-4-57"></a>        <span class="c1"># 存储知道人名列表</span>
<a id="__codelineno-4-58" name="__codelineno-4-58"></a>        <span class="n">known_names</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-4-59" name="__codelineno-4-59"></a>        <span class="c1"># 存储知道的特征值</span>
<a id="__codelineno-4-60" name="__codelineno-4-60"></a>        <span class="n">known_encodings</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-4-61" name="__codelineno-4-61"></a>        <span class="c1"># 遍历存储人脸图片的文件夹</span>
<a id="__codelineno-4-62" name="__codelineno-4-62"></a>        <span class="n">db_folder</span> <span class="o">=</span> <span class="s2">&quot;images/db_faces&quot;</span>
<a id="__codelineno-4-63" name="__codelineno-4-63"></a>        <span class="n">face_imgs</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">db_folder</span><span class="p">)</span>
<a id="__codelineno-4-64" name="__codelineno-4-64"></a>        <span class="c1"># 加载更复杂的人脸识别模型</span>
<a id="__codelineno-4-65" name="__codelineno-4-65"></a>        <span class="n">face_rec_model</span> <span class="o">=</span> <span class="s2">&quot;cnn&quot;</span>  <span class="c1"># 使用深度学习模型，通常更准确</span>
<a id="__codelineno-4-66" name="__codelineno-4-66"></a>        <span class="c1"># 遍历图片，将人脸图片转化为向量</span>
<a id="__codelineno-4-67" name="__codelineno-4-67"></a>        <span class="k">for</span> <span class="n">face_img</span> <span class="ow">in</span> <span class="n">face_imgs</span><span class="p">:</span>
<a id="__codelineno-4-68" name="__codelineno-4-68"></a>            <span class="n">face_img_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">db_folder</span><span class="p">,</span> <span class="n">face_img</span><span class="p">)</span>
<a id="__codelineno-4-69" name="__codelineno-4-69"></a>            <span class="n">face_name</span> <span class="o">=</span> <span class="n">face_img</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-4-70" name="__codelineno-4-70"></a>            <span class="n">load_image</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">load_image_file</span><span class="p">(</span><span class="n">face_img_path</span><span class="p">)</span>  <span class="c1"># 加载图片</span>
<a id="__codelineno-4-71" name="__codelineno-4-71"></a>            <span class="n">image_face_encoding</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_encodings</span><span class="p">(</span><span class="n">load_image</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">face_rec_model</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># 获得128维特征值</span>
<a id="__codelineno-4-72" name="__codelineno-4-72"></a>            <span class="n">known_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">face_name</span><span class="p">)</span>  <span class="c1"># 添加到人名的列表</span>
<a id="__codelineno-4-73" name="__codelineno-4-73"></a>            <span class="n">known_encodings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image_face_encoding</span><span class="p">)</span>  <span class="c1"># 添加到向量的列表</span>
<a id="__codelineno-4-74" name="__codelineno-4-74"></a>        <span class="k">return</span> <span class="n">known_names</span><span class="p">,</span> <span class="n">known_encodings</span>
<a id="__codelineno-4-75" name="__codelineno-4-75"></a>
<a id="__codelineno-4-76" name="__codelineno-4-76"></a>    <span class="c1"># 在 up_img 函数中添加图像预处理步骤</span>
<a id="__codelineno-4-77" name="__codelineno-4-77"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">up_img</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-78" name="__codelineno-4-78"></a>        <span class="c1"># 打开文件选择框</span>
<a id="__codelineno-4-79" name="__codelineno-4-79"></a>        <span class="n">openfile_name</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;选择文件&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Image files(*.jpg , *.png)&#39;</span><span class="p">)</span>
<a id="__codelineno-4-80" name="__codelineno-4-80"></a>        <span class="c1"># 获取上传的文件名称</span>
<a id="__codelineno-4-81" name="__codelineno-4-81"></a>        <span class="n">img_name</span> <span class="o">=</span> <span class="n">openfile_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-4-82" name="__codelineno-4-82"></a>        <span class="k">if</span> <span class="n">img_name</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
<a id="__codelineno-4-83" name="__codelineno-4-83"></a>            <span class="k">pass</span>
<a id="__codelineno-4-84" name="__codelineno-4-84"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-85" name="__codelineno-4-85"></a>            <span class="c1"># 上传之后显示并做归一化处理</span>
<a id="__codelineno-4-86" name="__codelineno-4-86"></a>            <span class="n">src_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_name</span><span class="p">)</span>
<a id="__codelineno-4-87" name="__codelineno-4-87"></a>            <span class="n">src_img</span> <span class="o">=</span> <span class="n">enhance_image_quality</span><span class="p">(</span><span class="n">src_img</span><span class="p">)</span>  <span class="c1"># 增强图像质量</span>
<a id="__codelineno-4-88" name="__codelineno-4-88"></a>            <span class="n">src_img_height</span> <span class="o">=</span> <span class="n">src_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-4-89" name="__codelineno-4-89"></a>            <span class="n">src_img_width</span> <span class="o">=</span> <span class="n">src_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-4-90" name="__codelineno-4-90"></a>            <span class="n">target_img_height</span> <span class="o">=</span> <span class="mi">400</span>
<a id="__codelineno-4-91" name="__codelineno-4-91"></a>            <span class="n">ratio</span> <span class="o">=</span> <span class="n">target_img_height</span> <span class="o">/</span> <span class="n">src_img_height</span>
<a id="__codelineno-4-92" name="__codelineno-4-92"></a>            <span class="n">target_img_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">src_img_width</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>
<a id="__codelineno-4-93" name="__codelineno-4-93"></a>            <span class="c1"># 将图片统一处理到高为400的图片，方便在界面上显示</span>
<a id="__codelineno-4-94" name="__codelineno-4-94"></a>            <span class="n">target_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">src_img</span><span class="p">,</span> <span class="p">(</span><span class="n">target_img_width</span><span class="p">,</span> <span class="n">target_img_height</span><span class="p">))</span>
<a id="__codelineno-4-95" name="__codelineno-4-95"></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span><span class="p">,</span> <span class="n">target_img</span><span class="p">)</span>
<a id="__codelineno-4-96" name="__codelineno-4-96"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span><span class="p">))</span>
<a id="__codelineno-4-97" name="__codelineno-4-97"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span> <span class="o">=</span> <span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span>
<a id="__codelineno-4-98" name="__codelineno-4-98"></a>
<a id="__codelineno-4-99" name="__codelineno-4-99"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open_local</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-100" name="__codelineno-4-100"></a>        <span class="c1"># 选择录像文件进行读取</span>
<a id="__codelineno-4-101" name="__codelineno-4-101"></a>        <span class="n">mp4_filename</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-4-102" name="__codelineno-4-102"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">mp4_filename</span>
<a id="__codelineno-4-103" name="__codelineno-4-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-4-104" name="__codelineno-4-104"></a>
<a id="__codelineno-4-105" name="__codelineno-4-105"></a>        <span class="c1"># 设置摄像头分辨率</span>
<a id="__codelineno-4-106" name="__codelineno-4-106"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_WIDTH</span><span class="p">,</span> <span class="mi">640</span><span class="p">)</span>
<a id="__codelineno-4-107" name="__codelineno-4-107"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_HEIGHT</span><span class="p">,</span> <span class="mi">480</span><span class="p">)</span>
<a id="__codelineno-4-108" name="__codelineno-4-108"></a>
<a id="__codelineno-4-109" name="__codelineno-4-109"></a>        <span class="n">th</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_video</span><span class="p">)</span>
<a id="__codelineno-4-110" name="__codelineno-4-110"></a>        <span class="n">th</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-4-111" name="__codelineno-4-111"></a>
<a id="__codelineno-4-112" name="__codelineno-4-112"></a>
<a id="__codelineno-4-113" name="__codelineno-4-113"></a>    <span class="c1"># 初始化界面</span>
<a id="__codelineno-4-114" name="__codelineno-4-114"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-115" name="__codelineno-4-115"></a>        <span class="c1"># 设置字体</span>
<a id="__codelineno-4-116" name="__codelineno-4-116"></a>        <span class="n">font_v</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;楷体&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-4-117" name="__codelineno-4-117"></a>        <span class="n">generally_font</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;楷体&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<a id="__codelineno-4-118" name="__codelineno-4-118"></a>        <span class="c1"># 图片检测</span>
<a id="__codelineno-4-119" name="__codelineno-4-119"></a>        <span class="n">img_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<a id="__codelineno-4-120" name="__codelineno-4-120"></a>        <span class="n">img_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<a id="__codelineno-4-121" name="__codelineno-4-121"></a>        <span class="n">img_f_title</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;上传人脸图像&quot;</span><span class="p">)</span>  <span class="c1"># 设置标题</span>
<a id="__codelineno-4-122" name="__codelineno-4-122"></a>        <span class="n">img_f_title</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>  <span class="c1"># 设置标题位置为居中</span>
<a id="__codelineno-4-123" name="__codelineno-4-123"></a>        <span class="n">img_f_title</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;楷体&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>  <span class="c1"># 设置标题字体大小</span>
<a id="__codelineno-4-124" name="__codelineno-4-124"></a>        <span class="c1"># todo 要上传的人脸图像</span>
<a id="__codelineno-4-125" name="__codelineno-4-125"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>  <span class="c1"># 设置第一个界面上要显示的图片</span>
<a id="__codelineno-4-126" name="__codelineno-4-126"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;UI_images/zhuye.jpeg&quot;</span><span class="p">))</span>  <span class="c1"># 初始化要显示的图片</span>
<a id="__codelineno-4-127" name="__codelineno-4-127"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>  <span class="c1"># 设置图片居中</span>
<a id="__codelineno-4-128" name="__codelineno-4-128"></a>
<a id="__codelineno-4-129" name="__codelineno-4-129"></a>        <span class="c1"># 创建一个表单布局来包含提示文本和人名输入框</span>
<a id="__codelineno-4-130" name="__codelineno-4-130"></a>        <span class="n">form_layout</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
<a id="__codelineno-4-131" name="__codelineno-4-131"></a>        <span class="n">name_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;请输入姓名: &quot;</span><span class="p">)</span>  <span class="c1"># 添加提示文本</span>
<a id="__codelineno-4-132" name="__codelineno-4-132"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">face_name</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>  <span class="c1"># 设置当前图片对应的人名</span>
<a id="__codelineno-4-133" name="__codelineno-4-133"></a>        <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">name_label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_name</span><span class="p">)</span>  <span class="c1"># 将提示文本和输入框添加到表单布局</span>
<a id="__codelineno-4-134" name="__codelineno-4-134"></a>
<a id="__codelineno-4-135" name="__codelineno-4-135"></a>        <span class="c1"># 创建一个水平布局来包含&quot;上传图片&quot;按钮和&quot;开始上传&quot;按钮</span>
<a id="__codelineno-4-136" name="__codelineno-4-136"></a>        <span class="n">buttons_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
<a id="__codelineno-4-137" name="__codelineno-4-137"></a>        <span class="n">img_up_btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;上传图片&quot;</span><span class="p">)</span>  <span class="c1"># 设置上传图片的按钮</span>
<a id="__codelineno-4-138" name="__codelineno-4-138"></a>        <span class="n">img_det_btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;开始上传&quot;</span><span class="p">)</span>  <span class="c1"># 设置开始上传的按钮</span>
<a id="__codelineno-4-139" name="__codelineno-4-139"></a>        <span class="n">img_up_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_img</span><span class="p">)</span>  <span class="c1"># 联系到相关函数</span>
<a id="__codelineno-4-140" name="__codelineno-4-140"></a>        <span class="n">img_det_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_db_img</span><span class="p">)</span>  <span class="c1"># 连接到相关函数</span>
<a id="__codelineno-4-141" name="__codelineno-4-141"></a>
<a id="__codelineno-4-142" name="__codelineno-4-142"></a>        <span class="c1"># 设置组件的样式</span>
<a id="__codelineno-4-143" name="__codelineno-4-143"></a>        <span class="n">img_up_btn</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">generally_font</span><span class="p">)</span>
<a id="__codelineno-4-144" name="__codelineno-4-144"></a>        <span class="n">img_det_btn</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">generally_font</span><span class="p">)</span>
<a id="__codelineno-4-145" name="__codelineno-4-145"></a>        <span class="n">img_up_btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-4-146" name="__codelineno-4-146"></a>                                <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-4-147" name="__codelineno-4-147"></a>                                <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-4-148" name="__codelineno-4-148"></a>                                <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-4-149" name="__codelineno-4-149"></a>                                <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-4-150" name="__codelineno-4-150"></a>                                <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-4-151" name="__codelineno-4-151"></a>                                <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-4-152" name="__codelineno-4-152"></a>        <span class="n">img_det_btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-4-153" name="__codelineno-4-153"></a>                                <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-4-154" name="__codelineno-4-154"></a>                                <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-4-155" name="__codelineno-4-155"></a>                                <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-4-156" name="__codelineno-4-156"></a>                                <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-4-157" name="__codelineno-4-157"></a>                                <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-4-158" name="__codelineno-4-158"></a>                                <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-4-159" name="__codelineno-4-159"></a>
<a id="__codelineno-4-160" name="__codelineno-4-160"></a>        <span class="c1"># 将组件添加到布局上，然后设置主要的widget为当前的布局</span>
<a id="__codelineno-4-161" name="__codelineno-4-161"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">img_f_title</span><span class="p">)</span>
<a id="__codelineno-4-162" name="__codelineno-4-162"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="p">)</span>
<a id="__codelineno-4-163" name="__codelineno-4-163"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">form_layout</span><span class="p">)</span>  <span class="c1"># 添加表单布局到垂直布局</span>
<a id="__codelineno-4-164" name="__codelineno-4-164"></a>        <span class="n">buttons_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">img_up_btn</span><span class="p">)</span>  <span class="c1"># 添加按钮到水平布局</span>
<a id="__codelineno-4-165" name="__codelineno-4-165"></a>        <span class="n">buttons_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">img_det_btn</span><span class="p">)</span>  <span class="c1"># 添加按钮到水平布局</span>
<a id="__codelineno-4-166" name="__codelineno-4-166"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">buttons_layout</span><span class="p">)</span>  <span class="c1"># 添加水平布局到垂直布局</span>
<a id="__codelineno-4-167" name="__codelineno-4-167"></a>        <span class="n">img_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">img_layout</span><span class="p">)</span>
<a id="__codelineno-4-168" name="__codelineno-4-168"></a>
<a id="__codelineno-4-169" name="__codelineno-4-169"></a>
<a id="__codelineno-4-170" name="__codelineno-4-170"></a>
<a id="__codelineno-4-171" name="__codelineno-4-171"></a>
<a id="__codelineno-4-172" name="__codelineno-4-172"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-4-173" name="__codelineno-4-173"></a><span class="sd">        *** 4. 视频识别界面 ***</span>
<a id="__codelineno-4-174" name="__codelineno-4-174"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-4-175" name="__codelineno-4-175"></a>        <span class="n">video_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<a id="__codelineno-4-176" name="__codelineno-4-176"></a>        <span class="n">video_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<a id="__codelineno-4-177" name="__codelineno-4-177"></a>        <span class="c1"># 设置视频识别区的标题</span>
<a id="__codelineno-4-178" name="__codelineno-4-178"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;摄像头/视频识别区&quot;</span><span class="p">)</span>
<a id="__codelineno-4-179" name="__codelineno-4-179"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-4-180" name="__codelineno-4-180"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-4-181" name="__codelineno-4-181"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-4-182" name="__codelineno-4-182"></a>        <span class="c1"># 设置显示的界面</span>
<a id="__codelineno-4-183" name="__codelineno-4-183"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>
<a id="__codelineno-4-184" name="__codelineno-4-184"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
<a id="__codelineno-4-185" name="__codelineno-4-185"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;人脸检测摄像头&quot;</span><span class="p">)</span>
<a id="__codelineno-4-186" name="__codelineno-4-186"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-4-187" name="__codelineno-4-187"></a>        <span class="c1"># 设置打开摄像头的按钮和样式</span>
<a id="__codelineno-4-188" name="__codelineno-4-188"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-4-189" name="__codelineno-4-189"></a>                                          <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-4-190" name="__codelineno-4-190"></a>                                          <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-4-191" name="__codelineno-4-191"></a>                                          <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-4-192" name="__codelineno-4-192"></a>                                          <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-4-193" name="__codelineno-4-193"></a>                                          <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-4-194" name="__codelineno-4-194"></a>                                          <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-4-195" name="__codelineno-4-195"></a>        <span class="c1"># 设置选择文件的的按钮和样式</span>
<a id="__codelineno-4-196" name="__codelineno-4-196"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;开始识别（选择文件）&quot;</span><span class="p">)</span>
<a id="__codelineno-4-197" name="__codelineno-4-197"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-4-198" name="__codelineno-4-198"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-4-199" name="__codelineno-4-199"></a>                                    <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-4-200" name="__codelineno-4-200"></a>                                    <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-4-201" name="__codelineno-4-201"></a>                                    <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-4-202" name="__codelineno-4-202"></a>                                    <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-4-203" name="__codelineno-4-203"></a>                                    <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-4-204" name="__codelineno-4-204"></a>                                    <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-4-205" name="__codelineno-4-205"></a>        <span class="c1"># 设置结束演示的按钮和样式</span>
<a id="__codelineno-4-206" name="__codelineno-4-206"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;结束检测&quot;</span><span class="p">)</span>
<a id="__codelineno-4-207" name="__codelineno-4-207"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-4-208" name="__codelineno-4-208"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-4-209" name="__codelineno-4-209"></a>                                     <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-4-210" name="__codelineno-4-210"></a>                                     <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-4-211" name="__codelineno-4-211"></a>                                     <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-4-212" name="__codelineno-4-212"></a>                                     <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-4-213" name="__codelineno-4-213"></a>                                     <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-4-214" name="__codelineno-4-214"></a>                                     <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-4-215" name="__codelineno-4-215"></a>        <span class="c1"># 将组件添加到布局上</span>
<a id="__codelineno-4-216" name="__codelineno-4-216"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_local</span><span class="p">)</span>
<a id="__codelineno-4-217" name="__codelineno-4-217"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">)</span>
<a id="__codelineno-4-218" name="__codelineno-4-218"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
<a id="__codelineno-4-219" name="__codelineno-4-219"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-4-220" name="__codelineno-4-220"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="p">)</span>
<a id="__codelineno-4-221" name="__codelineno-4-221"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="p">)</span>
<a id="__codelineno-4-222" name="__codelineno-4-222"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-4-223" name="__codelineno-4-223"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="p">)</span>
<a id="__codelineno-4-224" name="__codelineno-4-224"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="p">)</span>
<a id="__codelineno-4-225" name="__codelineno-4-225"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="p">)</span>
<a id="__codelineno-4-226" name="__codelineno-4-226"></a>        <span class="n">video_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">video_layout</span><span class="p">)</span>
<a id="__codelineno-4-227" name="__codelineno-4-227"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-4-228" name="__codelineno-4-228"></a><span class="sd">        *** 5. 关于界面 ***</span>
<a id="__codelineno-4-229" name="__codelineno-4-229"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-4-230" name="__codelineno-4-230"></a>        <span class="n">about_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<a id="__codelineno-4-231" name="__codelineno-4-231"></a>        <span class="n">about_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<a id="__codelineno-4-232" name="__codelineno-4-232"></a>        <span class="n">about_title</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;欢迎使用人脸检测系统</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># todo 修改欢迎词语</span>
<a id="__codelineno-4-233" name="__codelineno-4-233"></a>        <span class="n">about_title</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;楷体&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>
<a id="__codelineno-4-234" name="__codelineno-4-234"></a>        <span class="n">about_title</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-4-235" name="__codelineno-4-235"></a>        <span class="n">about_img</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>
<a id="__codelineno-4-236" name="__codelineno-4-236"></a>        <span class="n">about_img</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s1">&#39;UI_images/san.png&#39;</span><span class="p">))</span>
<a id="__codelineno-4-237" name="__codelineno-4-237"></a>        <span class="n">about_img</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-4-238" name="__codelineno-4-238"></a>
<a id="__codelineno-4-239" name="__codelineno-4-239"></a>        <span class="c1"># label4.setText(&quot;&lt;a href=&#39;https://oi.wiki/wiki/学习率的调整&#39;&gt;如何调整学习率&lt;/a&gt;&quot;)</span>
<a id="__codelineno-4-240" name="__codelineno-4-240"></a>        <span class="n">label_super</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>  <span class="c1"># todo 更换作者信息</span>
<a id="__codelineno-4-241" name="__codelineno-4-241"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&lt;a href=&#39;https://wcowin.work/&#39;&gt;--&gt;联系我们&lt;/a&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-4-242" name="__codelineno-4-242"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;楷体&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<a id="__codelineno-4-243" name="__codelineno-4-243"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setOpenExternalLinks</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-4-244" name="__codelineno-4-244"></a>        <span class="c1"># label_super.setOpenExternalLinks(True)</span>
<a id="__codelineno-4-245" name="__codelineno-4-245"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignRight</span><span class="p">)</span>
<a id="__codelineno-4-246" name="__codelineno-4-246"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">about_title</span><span class="p">)</span>
<a id="__codelineno-4-247" name="__codelineno-4-247"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
<a id="__codelineno-4-248" name="__codelineno-4-248"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">about_img</span><span class="p">)</span>
<a id="__codelineno-4-249" name="__codelineno-4-249"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
<a id="__codelineno-4-250" name="__codelineno-4-250"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label_super</span><span class="p">)</span>
<a id="__codelineno-4-251" name="__codelineno-4-251"></a>        <span class="n">about_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">about_layout</span><span class="p">)</span>
<a id="__codelineno-4-252" name="__codelineno-4-252"></a>        <span class="c1"># 分别添加子页面</span>
<a id="__codelineno-4-253" name="__codelineno-4-253"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">img_widget</span><span class="p">,</span> <span class="s2">&quot;上传人脸&quot;</span><span class="p">)</span>
<a id="__codelineno-4-254" name="__codelineno-4-254"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">video_widget</span><span class="p">,</span> <span class="s1">&#39;视频检测&#39;</span><span class="p">)</span>
<a id="__codelineno-4-255" name="__codelineno-4-255"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">about_widget</span><span class="p">,</span> <span class="s1">&#39;关于&#39;</span><span class="p">)</span>
<a id="__codelineno-4-256" name="__codelineno-4-256"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/图片.png&#39;</span><span class="p">))</span>
<a id="__codelineno-4-257" name="__codelineno-4-257"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/图片.png&#39;</span><span class="p">))</span>
<a id="__codelineno-4-258" name="__codelineno-4-258"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/直播.png&#39;</span><span class="p">))</span>
<a id="__codelineno-4-259" name="__codelineno-4-259"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/logo_about.png&#39;</span><span class="p">))</span>
<a id="__codelineno-4-260" name="__codelineno-4-260"></a>
<a id="__codelineno-4-261" name="__codelineno-4-261"></a>    <span class="c1"># 第一个界面的函数</span>
<a id="__codelineno-4-262" name="__codelineno-4-262"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">up_img</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-263" name="__codelineno-4-263"></a>        <span class="c1"># 打开文件选择框</span>
<a id="__codelineno-4-264" name="__codelineno-4-264"></a>        <span class="n">openfile_name</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;选择文件&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Image files(*.jpg , *.png)&#39;</span><span class="p">)</span>
<a id="__codelineno-4-265" name="__codelineno-4-265"></a>        <span class="c1"># 获取上传的文件名称</span>
<a id="__codelineno-4-266" name="__codelineno-4-266"></a>        <span class="n">img_name</span> <span class="o">=</span> <span class="n">openfile_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-4-267" name="__codelineno-4-267"></a>        <span class="k">if</span> <span class="n">img_name</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
<a id="__codelineno-4-268" name="__codelineno-4-268"></a>            <span class="k">pass</span>
<a id="__codelineno-4-269" name="__codelineno-4-269"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-270" name="__codelineno-4-270"></a>            <span class="c1"># 上传之后显示并做归一化处理</span>
<a id="__codelineno-4-271" name="__codelineno-4-271"></a>            <span class="n">src_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_name</span><span class="p">)</span>
<a id="__codelineno-4-272" name="__codelineno-4-272"></a>            <span class="n">src_img_height</span> <span class="o">=</span> <span class="n">src_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-4-273" name="__codelineno-4-273"></a>            <span class="n">src_img_width</span> <span class="o">=</span> <span class="n">src_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-4-274" name="__codelineno-4-274"></a>            <span class="n">target_img_height</span> <span class="o">=</span> <span class="mi">400</span>
<a id="__codelineno-4-275" name="__codelineno-4-275"></a>            <span class="n">ratio</span> <span class="o">=</span> <span class="n">target_img_height</span> <span class="o">/</span> <span class="n">src_img_height</span>
<a id="__codelineno-4-276" name="__codelineno-4-276"></a>            <span class="n">target_img_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">src_img_width</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>
<a id="__codelineno-4-277" name="__codelineno-4-277"></a>            <span class="c1"># 将图片统一处理到高为400的图片，方便在界面上显示</span>
<a id="__codelineno-4-278" name="__codelineno-4-278"></a>            <span class="n">target_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">src_img</span><span class="p">,</span> <span class="p">(</span><span class="n">target_img_width</span><span class="p">,</span> <span class="n">target_img_height</span><span class="p">))</span>
<a id="__codelineno-4-279" name="__codelineno-4-279"></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span><span class="p">,</span> <span class="n">target_img</span><span class="p">)</span>
<a id="__codelineno-4-280" name="__codelineno-4-280"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span><span class="p">))</span>
<a id="__codelineno-4-281" name="__codelineno-4-281"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span> <span class="o">=</span> <span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span>
<a id="__codelineno-4-282" name="__codelineno-4-282"></a>
<a id="__codelineno-4-283" name="__codelineno-4-283"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">up_db_img</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-284" name="__codelineno-4-284"></a>        <span class="c1"># 首先判断该图像是否有一个人脸，多个人脸或者没有人脸都不行</span>
<a id="__codelineno-4-285" name="__codelineno-4-285"></a>        <span class="n">face_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_name</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
<a id="__codelineno-4-286" name="__codelineno-4-286"></a>        <span class="k">if</span> <span class="n">face_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
<a id="__codelineno-4-287" name="__codelineno-4-287"></a>            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;不能为空&quot;</span><span class="p">,</span> <span class="s2">&quot;请填写人脸姓名&quot;</span><span class="p">)</span>
<a id="__codelineno-4-288" name="__codelineno-4-288"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-289" name="__codelineno-4-289"></a>            <span class="n">load_image</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">load_image_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span><span class="p">)</span>  <span class="c1"># 加载图片</span>
<a id="__codelineno-4-290" name="__codelineno-4-290"></a>            <span class="n">image_face_encoding</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_encodings</span><span class="p">(</span><span class="n">load_image</span><span class="p">)</span>  <span class="c1"># 获得128维特征值</span>
<a id="__codelineno-4-291" name="__codelineno-4-291"></a>            <span class="n">encoding_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">image_face_encoding</span><span class="p">)</span>  <span class="c1"># 获取人脸得数量</span>
<a id="__codelineno-4-292" name="__codelineno-4-292"></a>            <span class="k">if</span> <span class="n">encoding_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 如果没有人脸，提示用户重新上传</span>
<a id="__codelineno-4-293" name="__codelineno-4-293"></a>                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;请重新上传&quot;</span><span class="p">,</span> <span class="s2">&quot;当前图片没有发现人脸&quot;</span><span class="p">)</span>
<a id="__codelineno-4-294" name="__codelineno-4-294"></a>            <span class="k">elif</span> <span class="n">encoding_length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># 如果人脸有多个，也提示用户重新上传</span>
<a id="__codelineno-4-295" name="__codelineno-4-295"></a>                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;请重新上传&quot;</span><span class="p">,</span> <span class="s2">&quot;当前图片发现多张人脸&quot;</span><span class="p">)</span>
<a id="__codelineno-4-296" name="__codelineno-4-296"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-297" name="__codelineno-4-297"></a>                <span class="n">face_encoding</span> <span class="o">=</span> <span class="n">image_face_encoding</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># 获取解析得到得人脸数量</span>
<a id="__codelineno-4-298" name="__codelineno-4-298"></a>                <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span><span class="p">)</span>  <span class="c1"># 将上传得图片保存在db目录下</span>
<a id="__codelineno-4-299" name="__codelineno-4-299"></a>                <span class="n">img_path</span> <span class="o">=</span> <span class="n">face_name</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span>
<a id="__codelineno-4-300" name="__codelineno-4-300"></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;images/db_faces/&quot;</span> <span class="o">+</span> <span class="n">img_path</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
<a id="__codelineno-4-301" name="__codelineno-4-301"></a>                <span class="c1"># 上传之后重新对字典进行处理</span>
<a id="__codelineno-4-302" name="__codelineno-4-302"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">known_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">face_name</span><span class="p">)</span>
<a id="__codelineno-4-303" name="__codelineno-4-303"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">known_encodings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">face_encoding</span><span class="p">)</span>
<a id="__codelineno-4-304" name="__codelineno-4-304"></a>                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;上传成功&quot;</span><span class="p">,</span> <span class="s2">&quot;数据已上传！&quot;</span><span class="p">)</span>
<a id="__codelineno-4-305" name="__codelineno-4-305"></a>
<a id="__codelineno-4-306" name="__codelineno-4-306"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-4-307" name="__codelineno-4-307"></a><span class="sd">    ### 3. 视频识别相关功能 ### </span>
<a id="__codelineno-4-308" name="__codelineno-4-308"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-4-309" name="__codelineno-4-309"></a>
<a id="__codelineno-4-310" name="__codelineno-4-310"></a>    <span class="c1"># 关闭事件 询问用户是否退出</span>
<a id="__codelineno-4-311" name="__codelineno-4-311"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">closeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<a id="__codelineno-4-312" name="__codelineno-4-312"></a>        <span class="n">reply</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-4-313" name="__codelineno-4-313"></a>                                     <span class="s1">&#39;退出&#39;</span><span class="p">,</span>
<a id="__codelineno-4-314" name="__codelineno-4-314"></a>                                     <span class="s2">&quot;是否要退出程序？&quot;</span><span class="p">,</span>
<a id="__codelineno-4-315" name="__codelineno-4-315"></a>                                     <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">,</span>
<a id="__codelineno-4-316" name="__codelineno-4-316"></a>                                     <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
<a id="__codelineno-4-317" name="__codelineno-4-317"></a>        <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
<a id="__codelineno-4-318" name="__codelineno-4-318"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-4-319" name="__codelineno-4-319"></a>            <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
<a id="__codelineno-4-320" name="__codelineno-4-320"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-321" name="__codelineno-4-321"></a>            <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
<a id="__codelineno-4-322" name="__codelineno-4-322"></a>
<a id="__codelineno-4-323" name="__codelineno-4-323"></a>    <span class="c1"># 读取录像文件</span>
<a id="__codelineno-4-324" name="__codelineno-4-324"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-325" name="__codelineno-4-325"></a>        <span class="c1"># 选择录像文件进行读取</span>
<a id="__codelineno-4-326" name="__codelineno-4-326"></a>        <span class="n">mp4_fileName</span><span class="p">,</span> <span class="n">fileType</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Choose file&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;*.mp4&#39;</span><span class="p">)</span>
<a id="__codelineno-4-327" name="__codelineno-4-327"></a>        <span class="k">if</span> <span class="n">mp4_fileName</span><span class="p">:</span>
<a id="__codelineno-4-328" name="__codelineno-4-328"></a>            <span class="c1"># 启动录像文件读取得线程并在画面上实时显示</span>
<a id="__codelineno-4-329" name="__codelineno-4-329"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">mp4_fileName</span>
<a id="__codelineno-4-330" name="__codelineno-4-330"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-4-331" name="__codelineno-4-331"></a>            <span class="n">th</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_video</span><span class="p">)</span>
<a id="__codelineno-4-332" name="__codelineno-4-332"></a>            <span class="n">th</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-4-333" name="__codelineno-4-333"></a>
<a id="__codelineno-4-334" name="__codelineno-4-334"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open_local</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-335" name="__codelineno-4-335"></a>        <span class="c1"># 选择录像文件进行读取</span>
<a id="__codelineno-4-336" name="__codelineno-4-336"></a>        <span class="n">mp4_filename</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-4-337" name="__codelineno-4-337"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">mp4_filename</span>
<a id="__codelineno-4-338" name="__codelineno-4-338"></a>        <span class="c1"># 读取摄像头进行实时得显示</span>
<a id="__codelineno-4-339" name="__codelineno-4-339"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-4-340" name="__codelineno-4-340"></a>        <span class="n">th</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_video</span><span class="p">)</span>
<a id="__codelineno-4-341" name="__codelineno-4-341"></a>        <span class="n">th</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-4-342" name="__codelineno-4-342"></a>
<a id="__codelineno-4-343" name="__codelineno-4-343"></a>    <span class="c1"># 退出进程</span>
<a id="__codelineno-4-344" name="__codelineno-4-344"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-345" name="__codelineno-4-345"></a>        <span class="c1"># 点击关闭按钮后重新初始化界面</span>
<a id="__codelineno-4-346" name="__codelineno-4-346"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<a id="__codelineno-4-347" name="__codelineno-4-347"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-4-348" name="__codelineno-4-348"></a>
<a id="__codelineno-4-349" name="__codelineno-4-349"></a>    <span class="c1"># todo 执行人脸识别主进程</span>
<a id="__codelineno-4-350" name="__codelineno-4-350"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_video</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-351" name="__codelineno-4-351"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-4-352" name="__codelineno-4-352"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-4-353" name="__codelineno-4-353"></a>        <span class="n">process_this_frame</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-4-354" name="__codelineno-4-354"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-4-355" name="__codelineno-4-355"></a>            <span class="n">ret</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a id="__codelineno-4-356" name="__codelineno-4-356"></a>            <span class="n">rgb_frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
<a id="__codelineno-4-357" name="__codelineno-4-357"></a>            <span class="k">if</span> <span class="n">process_this_frame</span><span class="p">:</span>
<a id="__codelineno-4-358" name="__codelineno-4-358"></a>                <span class="n">face_locations</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_locations</span><span class="p">(</span><span class="n">rgb_frame</span><span class="p">)</span>
<a id="__codelineno-4-359" name="__codelineno-4-359"></a>                <span class="n">face_encodings</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_encodings</span><span class="p">(</span><span class="n">rgb_frame</span><span class="p">,</span> <span class="n">face_locations</span><span class="p">)</span>
<a id="__codelineno-4-360" name="__codelineno-4-360"></a>                <span class="n">face_names</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-4-361" name="__codelineno-4-361"></a>                <span class="k">for</span> <span class="n">face_encoding</span> <span class="ow">in</span> <span class="n">face_encodings</span><span class="p">:</span>
<a id="__codelineno-4-362" name="__codelineno-4-362"></a>                    <span class="n">matches</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">compare_faces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">known_encodings</span><span class="p">,</span> <span class="n">face_encoding</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a id="__codelineno-4-363" name="__codelineno-4-363"></a>                    <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
<a id="__codelineno-4-364" name="__codelineno-4-364"></a>                        <span class="n">first_match_index</span> <span class="o">=</span> <span class="n">matches</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-4-365" name="__codelineno-4-365"></a>                        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">known_names</span><span class="p">[</span><span class="n">first_match_index</span><span class="p">]</span>
<a id="__codelineno-4-366" name="__codelineno-4-366"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-367" name="__codelineno-4-367"></a>                        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Unknown&quot;</span>
<a id="__codelineno-4-368" name="__codelineno-4-368"></a>                    <span class="n">face_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-4-369" name="__codelineno-4-369"></a>            <span class="n">process_this_frame</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">process_this_frame</span>
<a id="__codelineno-4-370" name="__codelineno-4-370"></a>            <span class="k">for</span> <span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">left</span><span class="p">),</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">face_locations</span><span class="p">,</span> <span class="n">face_names</span><span class="p">):</span>
<a id="__codelineno-4-371" name="__codelineno-4-371"></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">),</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># 修改边界框颜色为红色</span>
<a id="__codelineno-4-372" name="__codelineno-4-372"></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">-</span> <span class="mi">35</span><span class="p">),</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FILLED</span><span class="p">)</span>  <span class="c1"># 修改填充颜色为红色</span>
<a id="__codelineno-4-373" name="__codelineno-4-373"></a>                <span class="n">font</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_DUPLEX</span>
<a id="__codelineno-4-374" name="__codelineno-4-374"></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">left</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">-</span> <span class="mi">6</span><span class="p">),</span> <span class="n">font</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-4-375" name="__codelineno-4-375"></a>            <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>
<a id="__codelineno-4-376" name="__codelineno-4-376"></a>            <span class="n">frame_height</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-4-377" name="__codelineno-4-377"></a>            <span class="n">frame_width</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-4-378" name="__codelineno-4-378"></a>            <span class="n">frame_scale</span> <span class="o">=</span> <span class="mi">500</span> <span class="o">/</span> <span class="n">frame_height</span>
<a id="__codelineno-4-379" name="__codelineno-4-379"></a>            <span class="n">frame_resize</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">frame_width</span> <span class="o">*</span> <span class="n">frame_scale</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_height</span> <span class="o">*</span> <span class="n">frame_scale</span><span class="p">)))</span>
<a id="__codelineno-4-380" name="__codelineno-4-380"></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;images/tmp.jpg&quot;</span><span class="p">,</span> <span class="n">frame_resize</span><span class="p">)</span>
<a id="__codelineno-4-381" name="__codelineno-4-381"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;images/tmp.jpg&quot;</span><span class="p">))</span>
<a id="__codelineno-4-382" name="__codelineno-4-382"></a>            <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-4-383" name="__codelineno-4-383"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-4-384" name="__codelineno-4-384"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-4-385" name="__codelineno-4-385"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-4-386" name="__codelineno-4-386"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-4-387" name="__codelineno-4-387"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-4-388" name="__codelineno-4-388"></a>                <span class="k">break</span>
<a id="__codelineno-4-389" name="__codelineno-4-389"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-4-390" name="__codelineno-4-390"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-4-391" name="__codelineno-4-391"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-4-392" name="__codelineno-4-392"></a>
<a id="__codelineno-4-393" name="__codelineno-4-393"></a>    <span class="c1"># 初始化视频检测界面</span>
<a id="__codelineno-4-394" name="__codelineno-4-394"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_down</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-395" name="__codelineno-4-395"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
<a id="__codelineno-4-396" name="__codelineno-4-396"></a>        <span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
<a id="__codelineno-4-397" name="__codelineno-4-397"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;UI_images/dier.jpeg&quot;</span><span class="p">))</span>
<a id="__codelineno-4-398" name="__codelineno-4-398"></a>
<a id="__codelineno-4-399" name="__codelineno-4-399"></a>
<a id="__codelineno-4-400" name="__codelineno-4-400"></a><span class="c1"># https://www.lfd.uci.edu/~gohlke/pythonlibs/</span>
<a id="__codelineno-4-401" name="__codelineno-4-401"></a><span class="c1"># https://pypi.org/project/dlib/#files</span>
<a id="__codelineno-4-402" name="__codelineno-4-402"></a><span class="c1"># https://download.csdn.net/download/ECHOSON/75224362</span>
<a id="__codelineno-4-403" name="__codelineno-4-403"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-4-404" name="__codelineno-4-404"></a>    <span class="c1"># 加载页面</span>
<a id="__codelineno-4-405" name="__codelineno-4-405"></a>    <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<a id="__codelineno-4-406" name="__codelineno-4-406"></a>    <span class="n">mainWindow</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
<a id="__codelineno-4-407" name="__codelineno-4-407"></a>    <span class="n">mainWindow</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-4-408" name="__codelineno-4-408"></a>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
</code></pre></div></td></tr></table></div></p>
<h2 id="_4">效果<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p><img alt="image.png" src="https://s2.loli.net/2024/02/04/AcdiBjGqRu3zZnO.jpg" /></p>
<p><strong>准确度显著提高，多人照片识别也更快，UI交互也做了改进</strong>  </p>
<h2 id="ing">持续优化ing<a class="headerlink" href="#ing" title="Permanent link">&para;</a></h2>
<p>恰逢Pytho课程设计，于是我便拿出来作为小组设计作品，但是做了进一步完善  </p>
<p>团队(姚双、本作者、张平、刘银杰)优化后最终版本：<br />
<strong>识别精度大幅提升，支持多人脸识别，支持多种人脸识别模型，支持人脸图像预处理，支持使用更高级的人脸识别模型，支持增加人脸图像的数量和多样性，支持使用更高级的人脸识别模型，支持人脸图像预处理，支持人脸匹配，支持结果显示，支持用户交互，支持数据收集与预处理，支持人脸特征提取</strong>  </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">  1</a></span>
<span class="normal"><a href="#__codelineno-5-2">  2</a></span>
<span class="normal"><a href="#__codelineno-5-3">  3</a></span>
<span class="normal"><a href="#__codelineno-5-4">  4</a></span>
<span class="normal"><a href="#__codelineno-5-5">  5</a></span>
<span class="normal"><a href="#__codelineno-5-6">  6</a></span>
<span class="normal"><a href="#__codelineno-5-7">  7</a></span>
<span class="normal"><a href="#__codelineno-5-8">  8</a></span>
<span class="normal"><a href="#__codelineno-5-9">  9</a></span>
<span class="normal"><a href="#__codelineno-5-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-5-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-5-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-5-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-5-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-5-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-5-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-5-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-5-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-5-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-5-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-5-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-5-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-5-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-5-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-5-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-5-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-5-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-5-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-5-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-5-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-5-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-5-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-5-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-5-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-5-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-5-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-5-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-5-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-5-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-5-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-5-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-5-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-5-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-5-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-5-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-5-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-5-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-5-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-5-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-5-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-5-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-5-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-5-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-5-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-5-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-5-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-5-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-5-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-5-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-5-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-5-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-5-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-5-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-5-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-5-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-5-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-5-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-5-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-5-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-5-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-5-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-5-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-5-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-5-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-5-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-5-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-5-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-5-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-5-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-5-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-5-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-5-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-5-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-5-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-5-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-5-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-5-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-5-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-5-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-5-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-5-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-5-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-5-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-5-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-5-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-5-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-5-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-5-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-5-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-5-100">100</a></span>
<span class="normal"><a href="#__codelineno-5-101">101</a></span>
<span class="normal"><a href="#__codelineno-5-102">102</a></span>
<span class="normal"><a href="#__codelineno-5-103">103</a></span>
<span class="normal"><a href="#__codelineno-5-104">104</a></span>
<span class="normal"><a href="#__codelineno-5-105">105</a></span>
<span class="normal"><a href="#__codelineno-5-106">106</a></span>
<span class="normal"><a href="#__codelineno-5-107">107</a></span>
<span class="normal"><a href="#__codelineno-5-108">108</a></span>
<span class="normal"><a href="#__codelineno-5-109">109</a></span>
<span class="normal"><a href="#__codelineno-5-110">110</a></span>
<span class="normal"><a href="#__codelineno-5-111">111</a></span>
<span class="normal"><a href="#__codelineno-5-112">112</a></span>
<span class="normal"><a href="#__codelineno-5-113">113</a></span>
<span class="normal"><a href="#__codelineno-5-114">114</a></span>
<span class="normal"><a href="#__codelineno-5-115">115</a></span>
<span class="normal"><a href="#__codelineno-5-116">116</a></span>
<span class="normal"><a href="#__codelineno-5-117">117</a></span>
<span class="normal"><a href="#__codelineno-5-118">118</a></span>
<span class="normal"><a href="#__codelineno-5-119">119</a></span>
<span class="normal"><a href="#__codelineno-5-120">120</a></span>
<span class="normal"><a href="#__codelineno-5-121">121</a></span>
<span class="normal"><a href="#__codelineno-5-122">122</a></span>
<span class="normal"><a href="#__codelineno-5-123">123</a></span>
<span class="normal"><a href="#__codelineno-5-124">124</a></span>
<span class="normal"><a href="#__codelineno-5-125">125</a></span>
<span class="normal"><a href="#__codelineno-5-126">126</a></span>
<span class="normal"><a href="#__codelineno-5-127">127</a></span>
<span class="normal"><a href="#__codelineno-5-128">128</a></span>
<span class="normal"><a href="#__codelineno-5-129">129</a></span>
<span class="normal"><a href="#__codelineno-5-130">130</a></span>
<span class="normal"><a href="#__codelineno-5-131">131</a></span>
<span class="normal"><a href="#__codelineno-5-132">132</a></span>
<span class="normal"><a href="#__codelineno-5-133">133</a></span>
<span class="normal"><a href="#__codelineno-5-134">134</a></span>
<span class="normal"><a href="#__codelineno-5-135">135</a></span>
<span class="normal"><a href="#__codelineno-5-136">136</a></span>
<span class="normal"><a href="#__codelineno-5-137">137</a></span>
<span class="normal"><a href="#__codelineno-5-138">138</a></span>
<span class="normal"><a href="#__codelineno-5-139">139</a></span>
<span class="normal"><a href="#__codelineno-5-140">140</a></span>
<span class="normal"><a href="#__codelineno-5-141">141</a></span>
<span class="normal"><a href="#__codelineno-5-142">142</a></span>
<span class="normal"><a href="#__codelineno-5-143">143</a></span>
<span class="normal"><a href="#__codelineno-5-144">144</a></span>
<span class="normal"><a href="#__codelineno-5-145">145</a></span>
<span class="normal"><a href="#__codelineno-5-146">146</a></span>
<span class="normal"><a href="#__codelineno-5-147">147</a></span>
<span class="normal"><a href="#__codelineno-5-148">148</a></span>
<span class="normal"><a href="#__codelineno-5-149">149</a></span>
<span class="normal"><a href="#__codelineno-5-150">150</a></span>
<span class="normal"><a href="#__codelineno-5-151">151</a></span>
<span class="normal"><a href="#__codelineno-5-152">152</a></span>
<span class="normal"><a href="#__codelineno-5-153">153</a></span>
<span class="normal"><a href="#__codelineno-5-154">154</a></span>
<span class="normal"><a href="#__codelineno-5-155">155</a></span>
<span class="normal"><a href="#__codelineno-5-156">156</a></span>
<span class="normal"><a href="#__codelineno-5-157">157</a></span>
<span class="normal"><a href="#__codelineno-5-158">158</a></span>
<span class="normal"><a href="#__codelineno-5-159">159</a></span>
<span class="normal"><a href="#__codelineno-5-160">160</a></span>
<span class="normal"><a href="#__codelineno-5-161">161</a></span>
<span class="normal"><a href="#__codelineno-5-162">162</a></span>
<span class="normal"><a href="#__codelineno-5-163">163</a></span>
<span class="normal"><a href="#__codelineno-5-164">164</a></span>
<span class="normal"><a href="#__codelineno-5-165">165</a></span>
<span class="normal"><a href="#__codelineno-5-166">166</a></span>
<span class="normal"><a href="#__codelineno-5-167">167</a></span>
<span class="normal"><a href="#__codelineno-5-168">168</a></span>
<span class="normal"><a href="#__codelineno-5-169">169</a></span>
<span class="normal"><a href="#__codelineno-5-170">170</a></span>
<span class="normal"><a href="#__codelineno-5-171">171</a></span>
<span class="normal"><a href="#__codelineno-5-172">172</a></span>
<span class="normal"><a href="#__codelineno-5-173">173</a></span>
<span class="normal"><a href="#__codelineno-5-174">174</a></span>
<span class="normal"><a href="#__codelineno-5-175">175</a></span>
<span class="normal"><a href="#__codelineno-5-176">176</a></span>
<span class="normal"><a href="#__codelineno-5-177">177</a></span>
<span class="normal"><a href="#__codelineno-5-178">178</a></span>
<span class="normal"><a href="#__codelineno-5-179">179</a></span>
<span class="normal"><a href="#__codelineno-5-180">180</a></span>
<span class="normal"><a href="#__codelineno-5-181">181</a></span>
<span class="normal"><a href="#__codelineno-5-182">182</a></span>
<span class="normal"><a href="#__codelineno-5-183">183</a></span>
<span class="normal"><a href="#__codelineno-5-184">184</a></span>
<span class="normal"><a href="#__codelineno-5-185">185</a></span>
<span class="normal"><a href="#__codelineno-5-186">186</a></span>
<span class="normal"><a href="#__codelineno-5-187">187</a></span>
<span class="normal"><a href="#__codelineno-5-188">188</a></span>
<span class="normal"><a href="#__codelineno-5-189">189</a></span>
<span class="normal"><a href="#__codelineno-5-190">190</a></span>
<span class="normal"><a href="#__codelineno-5-191">191</a></span>
<span class="normal"><a href="#__codelineno-5-192">192</a></span>
<span class="normal"><a href="#__codelineno-5-193">193</a></span>
<span class="normal"><a href="#__codelineno-5-194">194</a></span>
<span class="normal"><a href="#__codelineno-5-195">195</a></span>
<span class="normal"><a href="#__codelineno-5-196">196</a></span>
<span class="normal"><a href="#__codelineno-5-197">197</a></span>
<span class="normal"><a href="#__codelineno-5-198">198</a></span>
<span class="normal"><a href="#__codelineno-5-199">199</a></span>
<span class="normal"><a href="#__codelineno-5-200">200</a></span>
<span class="normal"><a href="#__codelineno-5-201">201</a></span>
<span class="normal"><a href="#__codelineno-5-202">202</a></span>
<span class="normal"><a href="#__codelineno-5-203">203</a></span>
<span class="normal"><a href="#__codelineno-5-204">204</a></span>
<span class="normal"><a href="#__codelineno-5-205">205</a></span>
<span class="normal"><a href="#__codelineno-5-206">206</a></span>
<span class="normal"><a href="#__codelineno-5-207">207</a></span>
<span class="normal"><a href="#__codelineno-5-208">208</a></span>
<span class="normal"><a href="#__codelineno-5-209">209</a></span>
<span class="normal"><a href="#__codelineno-5-210">210</a></span>
<span class="normal"><a href="#__codelineno-5-211">211</a></span>
<span class="normal"><a href="#__codelineno-5-212">212</a></span>
<span class="normal"><a href="#__codelineno-5-213">213</a></span>
<span class="normal"><a href="#__codelineno-5-214">214</a></span>
<span class="normal"><a href="#__codelineno-5-215">215</a></span>
<span class="normal"><a href="#__codelineno-5-216">216</a></span>
<span class="normal"><a href="#__codelineno-5-217">217</a></span>
<span class="normal"><a href="#__codelineno-5-218">218</a></span>
<span class="normal"><a href="#__codelineno-5-219">219</a></span>
<span class="normal"><a href="#__codelineno-5-220">220</a></span>
<span class="normal"><a href="#__codelineno-5-221">221</a></span>
<span class="normal"><a href="#__codelineno-5-222">222</a></span>
<span class="normal"><a href="#__codelineno-5-223">223</a></span>
<span class="normal"><a href="#__codelineno-5-224">224</a></span>
<span class="normal"><a href="#__codelineno-5-225">225</a></span>
<span class="normal"><a href="#__codelineno-5-226">226</a></span>
<span class="normal"><a href="#__codelineno-5-227">227</a></span>
<span class="normal"><a href="#__codelineno-5-228">228</a></span>
<span class="normal"><a href="#__codelineno-5-229">229</a></span>
<span class="normal"><a href="#__codelineno-5-230">230</a></span>
<span class="normal"><a href="#__codelineno-5-231">231</a></span>
<span class="normal"><a href="#__codelineno-5-232">232</a></span>
<span class="normal"><a href="#__codelineno-5-233">233</a></span>
<span class="normal"><a href="#__codelineno-5-234">234</a></span>
<span class="normal"><a href="#__codelineno-5-235">235</a></span>
<span class="normal"><a href="#__codelineno-5-236">236</a></span>
<span class="normal"><a href="#__codelineno-5-237">237</a></span>
<span class="normal"><a href="#__codelineno-5-238">238</a></span>
<span class="normal"><a href="#__codelineno-5-239">239</a></span>
<span class="normal"><a href="#__codelineno-5-240">240</a></span>
<span class="normal"><a href="#__codelineno-5-241">241</a></span>
<span class="normal"><a href="#__codelineno-5-242">242</a></span>
<span class="normal"><a href="#__codelineno-5-243">243</a></span>
<span class="normal"><a href="#__codelineno-5-244">244</a></span>
<span class="normal"><a href="#__codelineno-5-245">245</a></span>
<span class="normal"><a href="#__codelineno-5-246">246</a></span>
<span class="normal"><a href="#__codelineno-5-247">247</a></span>
<span class="normal"><a href="#__codelineno-5-248">248</a></span>
<span class="normal"><a href="#__codelineno-5-249">249</a></span>
<span class="normal"><a href="#__codelineno-5-250">250</a></span>
<span class="normal"><a href="#__codelineno-5-251">251</a></span>
<span class="normal"><a href="#__codelineno-5-252">252</a></span>
<span class="normal"><a href="#__codelineno-5-253">253</a></span>
<span class="normal"><a href="#__codelineno-5-254">254</a></span>
<span class="normal"><a href="#__codelineno-5-255">255</a></span>
<span class="normal"><a href="#__codelineno-5-256">256</a></span>
<span class="normal"><a href="#__codelineno-5-257">257</a></span>
<span class="normal"><a href="#__codelineno-5-258">258</a></span>
<span class="normal"><a href="#__codelineno-5-259">259</a></span>
<span class="normal"><a href="#__codelineno-5-260">260</a></span>
<span class="normal"><a href="#__codelineno-5-261">261</a></span>
<span class="normal"><a href="#__codelineno-5-262">262</a></span>
<span class="normal"><a href="#__codelineno-5-263">263</a></span>
<span class="normal"><a href="#__codelineno-5-264">264</a></span>
<span class="normal"><a href="#__codelineno-5-265">265</a></span>
<span class="normal"><a href="#__codelineno-5-266">266</a></span>
<span class="normal"><a href="#__codelineno-5-267">267</a></span>
<span class="normal"><a href="#__codelineno-5-268">268</a></span>
<span class="normal"><a href="#__codelineno-5-269">269</a></span>
<span class="normal"><a href="#__codelineno-5-270">270</a></span>
<span class="normal"><a href="#__codelineno-5-271">271</a></span>
<span class="normal"><a href="#__codelineno-5-272">272</a></span>
<span class="normal"><a href="#__codelineno-5-273">273</a></span>
<span class="normal"><a href="#__codelineno-5-274">274</a></span>
<span class="normal"><a href="#__codelineno-5-275">275</a></span>
<span class="normal"><a href="#__codelineno-5-276">276</a></span>
<span class="normal"><a href="#__codelineno-5-277">277</a></span>
<span class="normal"><a href="#__codelineno-5-278">278</a></span>
<span class="normal"><a href="#__codelineno-5-279">279</a></span>
<span class="normal"><a href="#__codelineno-5-280">280</a></span>
<span class="normal"><a href="#__codelineno-5-281">281</a></span>
<span class="normal"><a href="#__codelineno-5-282">282</a></span>
<span class="normal"><a href="#__codelineno-5-283">283</a></span>
<span class="normal"><a href="#__codelineno-5-284">284</a></span>
<span class="normal"><a href="#__codelineno-5-285">285</a></span>
<span class="normal"><a href="#__codelineno-5-286">286</a></span>
<span class="normal"><a href="#__codelineno-5-287">287</a></span>
<span class="normal"><a href="#__codelineno-5-288">288</a></span>
<span class="normal"><a href="#__codelineno-5-289">289</a></span>
<span class="normal"><a href="#__codelineno-5-290">290</a></span>
<span class="normal"><a href="#__codelineno-5-291">291</a></span>
<span class="normal"><a href="#__codelineno-5-292">292</a></span>
<span class="normal"><a href="#__codelineno-5-293">293</a></span>
<span class="normal"><a href="#__codelineno-5-294">294</a></span>
<span class="normal"><a href="#__codelineno-5-295">295</a></span>
<span class="normal"><a href="#__codelineno-5-296">296</a></span>
<span class="normal"><a href="#__codelineno-5-297">297</a></span>
<span class="normal"><a href="#__codelineno-5-298">298</a></span>
<span class="normal"><a href="#__codelineno-5-299">299</a></span>
<span class="normal"><a href="#__codelineno-5-300">300</a></span>
<span class="normal"><a href="#__codelineno-5-301">301</a></span>
<span class="normal"><a href="#__codelineno-5-302">302</a></span>
<span class="normal"><a href="#__codelineno-5-303">303</a></span>
<span class="normal"><a href="#__codelineno-5-304">304</a></span>
<span class="normal"><a href="#__codelineno-5-305">305</a></span>
<span class="normal"><a href="#__codelineno-5-306">306</a></span>
<span class="normal"><a href="#__codelineno-5-307">307</a></span>
<span class="normal"><a href="#__codelineno-5-308">308</a></span>
<span class="normal"><a href="#__codelineno-5-309">309</a></span>
<span class="normal"><a href="#__codelineno-5-310">310</a></span>
<span class="normal"><a href="#__codelineno-5-311">311</a></span>
<span class="normal"><a href="#__codelineno-5-312">312</a></span>
<span class="normal"><a href="#__codelineno-5-313">313</a></span>
<span class="normal"><a href="#__codelineno-5-314">314</a></span>
<span class="normal"><a href="#__codelineno-5-315">315</a></span>
<span class="normal"><a href="#__codelineno-5-316">316</a></span>
<span class="normal"><a href="#__codelineno-5-317">317</a></span>
<span class="normal"><a href="#__codelineno-5-318">318</a></span>
<span class="normal"><a href="#__codelineno-5-319">319</a></span>
<span class="normal"><a href="#__codelineno-5-320">320</a></span>
<span class="normal"><a href="#__codelineno-5-321">321</a></span>
<span class="normal"><a href="#__codelineno-5-322">322</a></span>
<span class="normal"><a href="#__codelineno-5-323">323</a></span>
<span class="normal"><a href="#__codelineno-5-324">324</a></span>
<span class="normal"><a href="#__codelineno-5-325">325</a></span>
<span class="normal"><a href="#__codelineno-5-326">326</a></span>
<span class="normal"><a href="#__codelineno-5-327">327</a></span>
<span class="normal"><a href="#__codelineno-5-328">328</a></span>
<span class="normal"><a href="#__codelineno-5-329">329</a></span>
<span class="normal"><a href="#__codelineno-5-330">330</a></span>
<span class="normal"><a href="#__codelineno-5-331">331</a></span>
<span class="normal"><a href="#__codelineno-5-332">332</a></span>
<span class="normal"><a href="#__codelineno-5-333">333</a></span>
<span class="normal"><a href="#__codelineno-5-334">334</a></span>
<span class="normal"><a href="#__codelineno-5-335">335</a></span>
<span class="normal"><a href="#__codelineno-5-336">336</a></span>
<span class="normal"><a href="#__codelineno-5-337">337</a></span>
<span class="normal"><a href="#__codelineno-5-338">338</a></span>
<span class="normal"><a href="#__codelineno-5-339">339</a></span>
<span class="normal"><a href="#__codelineno-5-340">340</a></span>
<span class="normal"><a href="#__codelineno-5-341">341</a></span>
<span class="normal"><a href="#__codelineno-5-342">342</a></span>
<span class="normal"><a href="#__codelineno-5-343">343</a></span>
<span class="normal"><a href="#__codelineno-5-344">344</a></span>
<span class="normal"><a href="#__codelineno-5-345">345</a></span>
<span class="normal"><a href="#__codelineno-5-346">346</a></span>
<span class="normal"><a href="#__codelineno-5-347">347</a></span>
<span class="normal"><a href="#__codelineno-5-348">348</a></span>
<span class="normal"><a href="#__codelineno-5-349">349</a></span>
<span class="normal"><a href="#__codelineno-5-350">350</a></span>
<span class="normal"><a href="#__codelineno-5-351">351</a></span>
<span class="normal"><a href="#__codelineno-5-352">352</a></span>
<span class="normal"><a href="#__codelineno-5-353">353</a></span>
<span class="normal"><a href="#__codelineno-5-354">354</a></span>
<span class="normal"><a href="#__codelineno-5-355">355</a></span>
<span class="normal"><a href="#__codelineno-5-356">356</a></span>
<span class="normal"><a href="#__codelineno-5-357">357</a></span>
<span class="normal"><a href="#__codelineno-5-358">358</a></span>
<span class="normal"><a href="#__codelineno-5-359">359</a></span>
<span class="normal"><a href="#__codelineno-5-360">360</a></span>
<span class="normal"><a href="#__codelineno-5-361">361</a></span>
<span class="normal"><a href="#__codelineno-5-362">362</a></span>
<span class="normal"><a href="#__codelineno-5-363">363</a></span>
<span class="normal"><a href="#__codelineno-5-364">364</a></span>
<span class="normal"><a href="#__codelineno-5-365">365</a></span>
<span class="normal"><a href="#__codelineno-5-366">366</a></span>
<span class="normal"><a href="#__codelineno-5-367">367</a></span>
<span class="normal"><a href="#__codelineno-5-368">368</a></span>
<span class="normal"><a href="#__codelineno-5-369">369</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtCore</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFileDialog</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QDockWidget</span><span class="p">,</span> <span class="n">QListWidget</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtGui</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">face_recognition</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageFont</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="c1"># 窗口主类</span>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="k">class</span><span class="w"> </span><span class="nc">MainWindow</span><span class="p">(</span><span class="n">QTabWidget</span><span class="p">):</span>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a>    <span class="c1"># 基本配置不动，然后只动第三个界面</span>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a>        <span class="c1"># 初始化设置</span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;实时人脸识别系统&#39;</span><span class="p">)</span>
<a id="__codelineno-5-21" name="__codelineno-5-21"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">1100</span><span class="p">,</span> <span class="mi">650</span><span class="p">)</span>
<a id="__codelineno-5-22" name="__codelineno-5-22"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="s2">&quot;UI_images/faxian.png&quot;</span><span class="p">))</span>
<a id="__codelineno-5-23" name="__codelineno-5-23"></a>        <span class="c1"># 要上传的图片路径</span>
<a id="__codelineno-5-24" name="__codelineno-5-24"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-5-25" name="__codelineno-5-25"></a>        <span class="c1"># 要检测的图片名称</span>
<a id="__codelineno-5-26" name="__codelineno-5-26"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_fname</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-5-27" name="__codelineno-5-27"></a>        <span class="c1"># 要检测的视频名称</span>
<a id="__codelineno-5-28" name="__codelineno-5-28"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-5-29" name="__codelineno-5-29"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-5-30" name="__codelineno-5-30"></a>        <span class="c1"># 初始化中止事件</span>
<a id="__codelineno-5-31" name="__codelineno-5-31"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
<a id="__codelineno-5-32" name="__codelineno-5-32"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-5-33" name="__codelineno-5-33"></a>        <span class="c1"># 初始化人脸向量</span>
<a id="__codelineno-5-34" name="__codelineno-5-34"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">known_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">known_encodings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initFaces</span><span class="p">()</span>
<a id="__codelineno-5-35" name="__codelineno-5-35"></a>        <span class="c1"># 加载lbp检测器</span>
<a id="__codelineno-5-36" name="__codelineno-5-36"></a>        <span class="c1"># 加载人脸识别模型</span>
<a id="__codelineno-5-37" name="__codelineno-5-37"></a>        <span class="c1"># 初始化界面</span>
<a id="__codelineno-5-38" name="__codelineno-5-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>
<a id="__codelineno-5-39" name="__codelineno-5-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-5-40" name="__codelineno-5-40"></a>
<a id="__codelineno-5-41" name="__codelineno-5-41"></a>    <span class="c1"># 初始化数据库的人脸</span>
<a id="__codelineno-5-42" name="__codelineno-5-42"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">initFaces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-43" name="__codelineno-5-43"></a>        <span class="c1"># 存储知道人名列表</span>
<a id="__codelineno-5-44" name="__codelineno-5-44"></a>        <span class="n">known_names</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-5-45" name="__codelineno-5-45"></a>        <span class="c1"># 存储知道的特征值</span>
<a id="__codelineno-5-46" name="__codelineno-5-46"></a>        <span class="n">known_encodings</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-5-47" name="__codelineno-5-47"></a>        <span class="c1"># 遍历存储人脸图片的文件夹</span>
<a id="__codelineno-5-48" name="__codelineno-5-48"></a>        <span class="n">db_folder</span> <span class="o">=</span> <span class="s2">&quot;images/db_faces&quot;</span>
<a id="__codelineno-5-49" name="__codelineno-5-49"></a>        <span class="n">face_imgs</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">db_folder</span><span class="p">)</span>
<a id="__codelineno-5-50" name="__codelineno-5-50"></a>        <span class="c1"># 遍历图片，将人脸图片转化为向量</span>
<a id="__codelineno-5-51" name="__codelineno-5-51"></a>        <span class="k">for</span> <span class="n">face_img</span> <span class="ow">in</span> <span class="n">face_imgs</span><span class="p">:</span>
<a id="__codelineno-5-52" name="__codelineno-5-52"></a>            <span class="n">face_img_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">db_folder</span><span class="p">,</span> <span class="n">face_img</span><span class="p">)</span>
<a id="__codelineno-5-53" name="__codelineno-5-53"></a>            <span class="n">face_name</span> <span class="o">=</span> <span class="n">face_img</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-5-54" name="__codelineno-5-54"></a>            <span class="n">load_image</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">load_image_file</span><span class="p">(</span><span class="n">face_img_path</span><span class="p">)</span>  <span class="c1"># 加载图片</span>
<a id="__codelineno-5-55" name="__codelineno-5-55"></a>            <span class="n">image_face_encoding</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_encodings</span><span class="p">(</span><span class="n">load_image</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># 获得128维特征值</span>
<a id="__codelineno-5-56" name="__codelineno-5-56"></a>            <span class="n">known_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">face_name</span><span class="p">)</span>  <span class="c1"># 添加到人名的列表</span>
<a id="__codelineno-5-57" name="__codelineno-5-57"></a>            <span class="n">known_encodings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image_face_encoding</span><span class="p">)</span>  <span class="c1"># 添加到向量的列表</span>
<a id="__codelineno-5-58" name="__codelineno-5-58"></a>        <span class="k">return</span> <span class="n">known_names</span><span class="p">,</span> <span class="n">known_encodings</span>
<a id="__codelineno-5-59" name="__codelineno-5-59"></a>
<a id="__codelineno-5-60" name="__codelineno-5-60"></a>    <span class="c1"># 初始化界面</span>
<a id="__codelineno-5-61" name="__codelineno-5-61"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-62" name="__codelineno-5-62"></a>        <span class="c1"># 设置字体</span>
<a id="__codelineno-5-63" name="__codelineno-5-63"></a>        <span class="n">font_v</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;楷体&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-5-64" name="__codelineno-5-64"></a>        <span class="n">generally_font</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;楷体&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<a id="__codelineno-5-65" name="__codelineno-5-65"></a>        <span class="c1"># 图片检测</span>
<a id="__codelineno-5-66" name="__codelineno-5-66"></a>        <span class="n">img_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<a id="__codelineno-5-67" name="__codelineno-5-67"></a>        <span class="n">img_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<a id="__codelineno-5-68" name="__codelineno-5-68"></a>        <span class="n">img_f_title</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;上传人脸图像&quot;</span><span class="p">)</span>  <span class="c1"># 设置标题</span>
<a id="__codelineno-5-69" name="__codelineno-5-69"></a>        <span class="n">img_f_title</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>  <span class="c1"># 设置标题位置为居中</span>
<a id="__codelineno-5-70" name="__codelineno-5-70"></a>        <span class="n">img_f_title</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;楷体&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>  <span class="c1"># 设置标题字体大小</span>
<a id="__codelineno-5-71" name="__codelineno-5-71"></a>        <span class="c1"># todo 要上传的人脸图像</span>
<a id="__codelineno-5-72" name="__codelineno-5-72"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>  <span class="c1"># 设置第一个界面上要显示的图片</span>
<a id="__codelineno-5-73" name="__codelineno-5-73"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;UI_images/zhuye.jpeg&quot;</span><span class="p">))</span>  <span class="c1"># 初始化要显示的图片</span>
<a id="__codelineno-5-74" name="__codelineno-5-74"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>  <span class="c1"># 设置图片居中</span>
<a id="__codelineno-5-75" name="__codelineno-5-75"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">face_name</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>  <span class="c1"># 设置当前图片对应的人名</span>
<a id="__codelineno-5-76" name="__codelineno-5-76"></a>        <span class="n">img_up_btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;上传图片&quot;</span><span class="p">)</span>  <span class="c1"># 设置上传图片的按钮</span>
<a id="__codelineno-5-77" name="__codelineno-5-77"></a>        <span class="n">img_det_btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;开始上传&quot;</span><span class="p">)</span>  <span class="c1"># 设置开始上传的按钮</span>
<a id="__codelineno-5-78" name="__codelineno-5-78"></a>        <span class="n">img_up_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_img</span><span class="p">)</span>  <span class="c1"># 联系到相关函数</span>
<a id="__codelineno-5-79" name="__codelineno-5-79"></a>        <span class="n">img_det_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_db_img</span><span class="p">)</span>  <span class="c1"># 连接到相关函数</span>
<a id="__codelineno-5-80" name="__codelineno-5-80"></a>        <span class="c1"># 设置组件的样式</span>
<a id="__codelineno-5-81" name="__codelineno-5-81"></a>        <span class="n">img_up_btn</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">generally_font</span><span class="p">)</span>
<a id="__codelineno-5-82" name="__codelineno-5-82"></a>        <span class="n">img_det_btn</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">generally_font</span><span class="p">)</span>
<a id="__codelineno-5-83" name="__codelineno-5-83"></a>        <span class="n">img_up_btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-5-84" name="__codelineno-5-84"></a>                                 <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-5-85" name="__codelineno-5-85"></a>                                 <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-5-86" name="__codelineno-5-86"></a>                                 <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-5-87" name="__codelineno-5-87"></a>                                 <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-5-88" name="__codelineno-5-88"></a>                                 <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-5-89" name="__codelineno-5-89"></a>                                 <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-5-90" name="__codelineno-5-90"></a>        <span class="n">img_det_btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-5-91" name="__codelineno-5-91"></a>                                  <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-5-92" name="__codelineno-5-92"></a>                                  <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-5-93" name="__codelineno-5-93"></a>                                  <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-5-94" name="__codelineno-5-94"></a>                                  <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-5-95" name="__codelineno-5-95"></a>                                  <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-5-96" name="__codelineno-5-96"></a>                                  <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-5-97" name="__codelineno-5-97"></a>        <span class="c1"># 将组件添加到布局上，然后设置主要的widget为当前的布局</span>
<a id="__codelineno-5-98" name="__codelineno-5-98"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">img_f_title</span><span class="p">)</span>
<a id="__codelineno-5-99" name="__codelineno-5-99"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="p">)</span>
<a id="__codelineno-5-100" name="__codelineno-5-100"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">face_name</span><span class="p">)</span>
<a id="__codelineno-5-101" name="__codelineno-5-101"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">img_up_btn</span><span class="p">)</span>
<a id="__codelineno-5-102" name="__codelineno-5-102"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">img_det_btn</span><span class="p">)</span>
<a id="__codelineno-5-103" name="__codelineno-5-103"></a>        <span class="n">img_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">img_layout</span><span class="p">)</span>
<a id="__codelineno-5-104" name="__codelineno-5-104"></a>
<a id="__codelineno-5-105" name="__codelineno-5-105"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-5-106" name="__codelineno-5-106"></a><span class="sd">        *** 4. 视频识别界面 ***</span>
<a id="__codelineno-5-107" name="__codelineno-5-107"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-5-108" name="__codelineno-5-108"></a>        <span class="n">video_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<a id="__codelineno-5-109" name="__codelineno-5-109"></a>        <span class="n">video_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<a id="__codelineno-5-110" name="__codelineno-5-110"></a>        <span class="c1"># 设置视频识别区的标题</span>
<a id="__codelineno-5-111" name="__codelineno-5-111"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;视频识别区&quot;</span><span class="p">)</span>
<a id="__codelineno-5-112" name="__codelineno-5-112"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-5-113" name="__codelineno-5-113"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-5-114" name="__codelineno-5-114"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-5-115" name="__codelineno-5-115"></a>        <span class="c1"># 设置显示的界面</span>
<a id="__codelineno-5-116" name="__codelineno-5-116"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>
<a id="__codelineno-5-117" name="__codelineno-5-117"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
<a id="__codelineno-5-118" name="__codelineno-5-118"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;检测摄像头&quot;</span><span class="p">)</span>
<a id="__codelineno-5-119" name="__codelineno-5-119"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-5-120" name="__codelineno-5-120"></a>        <span class="c1"># 设置打开摄像头的按钮和样式</span>
<a id="__codelineno-5-121" name="__codelineno-5-121"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-5-122" name="__codelineno-5-122"></a>                                          <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-5-123" name="__codelineno-5-123"></a>                                          <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-5-124" name="__codelineno-5-124"></a>                                          <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-5-125" name="__codelineno-5-125"></a>                                          <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-5-126" name="__codelineno-5-126"></a>                                          <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-5-127" name="__codelineno-5-127"></a>                                          <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-5-128" name="__codelineno-5-128"></a>        <span class="c1"># 设置选择文件的的按钮和样式</span>
<a id="__codelineno-5-129" name="__codelineno-5-129"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;开始识别（选择文件）&quot;</span><span class="p">)</span>
<a id="__codelineno-5-130" name="__codelineno-5-130"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-5-131" name="__codelineno-5-131"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-5-132" name="__codelineno-5-132"></a>                                    <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-5-133" name="__codelineno-5-133"></a>                                    <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-5-134" name="__codelineno-5-134"></a>                                    <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-5-135" name="__codelineno-5-135"></a>                                    <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-5-136" name="__codelineno-5-136"></a>                                    <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-5-137" name="__codelineno-5-137"></a>                                    <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-5-138" name="__codelineno-5-138"></a>        <span class="c1"># 设置结束演示的按钮和样式</span>
<a id="__codelineno-5-139" name="__codelineno-5-139"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;结束检测&quot;</span><span class="p">)</span>
<a id="__codelineno-5-140" name="__codelineno-5-140"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-5-141" name="__codelineno-5-141"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-5-142" name="__codelineno-5-142"></a>                                     <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-5-143" name="__codelineno-5-143"></a>                                     <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-5-144" name="__codelineno-5-144"></a>                                     <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-5-145" name="__codelineno-5-145"></a>                                     <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-5-146" name="__codelineno-5-146"></a>                                     <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-5-147" name="__codelineno-5-147"></a>                                     <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-5-148" name="__codelineno-5-148"></a>        <span class="c1"># 将组件添加到布局上</span>
<a id="__codelineno-5-149" name="__codelineno-5-149"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_local</span><span class="p">)</span>
<a id="__codelineno-5-150" name="__codelineno-5-150"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">)</span>
<a id="__codelineno-5-151" name="__codelineno-5-151"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
<a id="__codelineno-5-152" name="__codelineno-5-152"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-5-153" name="__codelineno-5-153"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="p">)</span>
<a id="__codelineno-5-154" name="__codelineno-5-154"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="p">)</span>
<a id="__codelineno-5-155" name="__codelineno-5-155"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-5-156" name="__codelineno-5-156"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="p">)</span>
<a id="__codelineno-5-157" name="__codelineno-5-157"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="p">)</span>
<a id="__codelineno-5-158" name="__codelineno-5-158"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="p">)</span>
<a id="__codelineno-5-159" name="__codelineno-5-159"></a>        <span class="n">video_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">video_layout</span><span class="p">)</span>
<a id="__codelineno-5-160" name="__codelineno-5-160"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-5-161" name="__codelineno-5-161"></a><span class="sd">        *** 5. 关于界面 ***</span>
<a id="__codelineno-5-162" name="__codelineno-5-162"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-5-163" name="__codelineno-5-163"></a>        <span class="n">about_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<a id="__codelineno-5-164" name="__codelineno-5-164"></a>        <span class="n">about_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<a id="__codelineno-5-165" name="__codelineno-5-165"></a>        <span class="n">about_title</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;欢迎使用人脸检测系统</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># todo 修改欢迎词语</span>
<a id="__codelineno-5-166" name="__codelineno-5-166"></a>        <span class="n">about_title</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;楷体&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>
<a id="__codelineno-5-167" name="__codelineno-5-167"></a>        <span class="n">about_title</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-5-168" name="__codelineno-5-168"></a>        <span class="n">about_img</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>
<a id="__codelineno-5-169" name="__codelineno-5-169"></a>        <span class="n">about_img</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s1">&#39;UI_images/san.png&#39;</span><span class="p">))</span>
<a id="__codelineno-5-170" name="__codelineno-5-170"></a>        <span class="n">about_img</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-5-171" name="__codelineno-5-171"></a>
<a id="__codelineno-5-172" name="__codelineno-5-172"></a>        <span class="n">label_super</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>  <span class="c1"># todo 更换作者信息</span>
<a id="__codelineno-5-173" name="__codelineno-5-173"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&lt;a href=&#39;https://wcowin.work/&#39;&gt;--&gt;联系我&lt;/a&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-5-174" name="__codelineno-5-174"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;楷体&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<a id="__codelineno-5-175" name="__codelineno-5-175"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setOpenExternalLinks</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-5-176" name="__codelineno-5-176"></a>        <span class="c1"># label_super.setOpenExternalLinks(True)</span>
<a id="__codelineno-5-177" name="__codelineno-5-177"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignRight</span><span class="p">)</span>
<a id="__codelineno-5-178" name="__codelineno-5-178"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">about_title</span><span class="p">)</span>
<a id="__codelineno-5-179" name="__codelineno-5-179"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
<a id="__codelineno-5-180" name="__codelineno-5-180"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">about_img</span><span class="p">)</span>
<a id="__codelineno-5-181" name="__codelineno-5-181"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
<a id="__codelineno-5-182" name="__codelineno-5-182"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label_super</span><span class="p">)</span>
<a id="__codelineno-5-183" name="__codelineno-5-183"></a>        <span class="n">about_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">about_layout</span><span class="p">)</span>
<a id="__codelineno-5-184" name="__codelineno-5-184"></a>        <span class="c1"># 分别添加子页面</span>
<a id="__codelineno-5-185" name="__codelineno-5-185"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">img_widget</span><span class="p">,</span> <span class="s2">&quot;上传人脸&quot;</span><span class="p">)</span>
<a id="__codelineno-5-186" name="__codelineno-5-186"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">video_widget</span><span class="p">,</span> <span class="s1">&#39;视频检测&#39;</span><span class="p">)</span>
<a id="__codelineno-5-187" name="__codelineno-5-187"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">about_widget</span><span class="p">,</span> <span class="s1">&#39;关于&#39;</span><span class="p">)</span>
<a id="__codelineno-5-188" name="__codelineno-5-188"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/图片.png&#39;</span><span class="p">))</span>
<a id="__codelineno-5-189" name="__codelineno-5-189"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/图片.png&#39;</span><span class="p">))</span>
<a id="__codelineno-5-190" name="__codelineno-5-190"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/直播.png&#39;</span><span class="p">))</span>
<a id="__codelineno-5-191" name="__codelineno-5-191"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/logo_about.png&#39;</span><span class="p">))</span>
<a id="__codelineno-5-192" name="__codelineno-5-192"></a>
<a id="__codelineno-5-193" name="__codelineno-5-193"></a>    <span class="c1"># 第一个界面的函数</span>
<a id="__codelineno-5-194" name="__codelineno-5-194"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">up_img</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-195" name="__codelineno-5-195"></a>        <span class="c1"># 打开文件选择框</span>
<a id="__codelineno-5-196" name="__codelineno-5-196"></a>        <span class="n">openfile_name</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;选择文件&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Image files(*.jpg , *.png)&#39;</span><span class="p">)</span>
<a id="__codelineno-5-197" name="__codelineno-5-197"></a>        <span class="c1"># 获取上传的文件名称</span>
<a id="__codelineno-5-198" name="__codelineno-5-198"></a>        <span class="n">img_name</span> <span class="o">=</span> <span class="n">openfile_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-5-199" name="__codelineno-5-199"></a>        <span class="k">if</span> <span class="n">img_name</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
<a id="__codelineno-5-200" name="__codelineno-5-200"></a>            <span class="k">pass</span>
<a id="__codelineno-5-201" name="__codelineno-5-201"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-5-202" name="__codelineno-5-202"></a>            <span class="c1"># 上传之后显示并做归一化处理</span>
<a id="__codelineno-5-203" name="__codelineno-5-203"></a>            <span class="n">src_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_name</span><span class="p">)</span>
<a id="__codelineno-5-204" name="__codelineno-5-204"></a>            <span class="n">src_img_height</span> <span class="o">=</span> <span class="n">src_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-5-205" name="__codelineno-5-205"></a>            <span class="n">src_img_width</span> <span class="o">=</span> <span class="n">src_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-5-206" name="__codelineno-5-206"></a>            <span class="n">target_img_height</span> <span class="o">=</span> <span class="mi">400</span>
<a id="__codelineno-5-207" name="__codelineno-5-207"></a>            <span class="n">ratio</span> <span class="o">=</span> <span class="n">target_img_height</span> <span class="o">/</span> <span class="n">src_img_height</span>
<a id="__codelineno-5-208" name="__codelineno-5-208"></a>            <span class="n">target_img_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">src_img_width</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>
<a id="__codelineno-5-209" name="__codelineno-5-209"></a>            <span class="c1"># 将图片统一处理到高为400的图片，方便在界面上显示</span>
<a id="__codelineno-5-210" name="__codelineno-5-210"></a>            <span class="n">target_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">src_img</span><span class="p">,</span> <span class="p">(</span><span class="n">target_img_width</span><span class="p">,</span> <span class="n">target_img_height</span><span class="p">))</span>
<a id="__codelineno-5-211" name="__codelineno-5-211"></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span><span class="p">,</span> <span class="n">target_img</span><span class="p">)</span>
<a id="__codelineno-5-212" name="__codelineno-5-212"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span><span class="p">))</span>
<a id="__codelineno-5-213" name="__codelineno-5-213"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span> <span class="o">=</span> <span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span>
<a id="__codelineno-5-214" name="__codelineno-5-214"></a>
<a id="__codelineno-5-215" name="__codelineno-5-215"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">up_db_img</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-216" name="__codelineno-5-216"></a>        <span class="n">face_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_name</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
<a id="__codelineno-5-217" name="__codelineno-5-217"></a>        <span class="c1"># Convert the face name to a utf-8 encoded string</span>
<a id="__codelineno-5-218" name="__codelineno-5-218"></a>        <span class="n">face_name</span> <span class="o">=</span> <span class="n">face_name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-5-219" name="__codelineno-5-219"></a>
<a id="__codelineno-5-220" name="__codelineno-5-220"></a>        <span class="k">if</span> <span class="n">face_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
<a id="__codelineno-5-221" name="__codelineno-5-221"></a>            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;不能为空&quot;</span><span class="p">,</span> <span class="s2">&quot;请填写人脸姓名&quot;</span><span class="p">)</span>
<a id="__codelineno-5-222" name="__codelineno-5-222"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-5-223" name="__codelineno-5-223"></a>            <span class="n">load_image</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">load_image_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span><span class="p">)</span>
<a id="__codelineno-5-224" name="__codelineno-5-224"></a>            <span class="n">image_face_encoding</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_encodings</span><span class="p">(</span><span class="n">load_image</span><span class="p">)</span>
<a id="__codelineno-5-225" name="__codelineno-5-225"></a>            <span class="n">encoding_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">image_face_encoding</span><span class="p">)</span>
<a id="__codelineno-5-226" name="__codelineno-5-226"></a>            <span class="k">if</span> <span class="n">encoding_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-5-227" name="__codelineno-5-227"></a>                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;请重新上传&quot;</span><span class="p">,</span> <span class="s2">&quot;当前图片没有发现人脸&quot;</span><span class="p">)</span>
<a id="__codelineno-5-228" name="__codelineno-5-228"></a>            <span class="k">elif</span> <span class="n">encoding_length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-5-229" name="__codelineno-5-229"></a>                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;请重新上传&quot;</span><span class="p">,</span> <span class="s2">&quot;当前图片发现多张人脸&quot;</span><span class="p">)</span>
<a id="__codelineno-5-230" name="__codelineno-5-230"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-5-231" name="__codelineno-5-231"></a>                <span class="n">face_encoding</span> <span class="o">=</span> <span class="n">image_face_encoding</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-5-232" name="__codelineno-5-232"></a>                <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span><span class="p">)</span>
<a id="__codelineno-5-233" name="__codelineno-5-233"></a>                <span class="n">img_path</span> <span class="o">=</span> <span class="n">face_name</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span>
<a id="__codelineno-5-234" name="__codelineno-5-234"></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;images/db_faces/&quot;</span> <span class="o">+</span> <span class="n">img_path</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
<a id="__codelineno-5-235" name="__codelineno-5-235"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">known_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">face_name</span><span class="p">)</span>
<a id="__codelineno-5-236" name="__codelineno-5-236"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">known_encodings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">face_encoding</span><span class="p">)</span>
<a id="__codelineno-5-237" name="__codelineno-5-237"></a>                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;上传成功&quot;</span><span class="p">,</span> <span class="s2">&quot;数据已上传！&quot;</span><span class="p">)</span>
<a id="__codelineno-5-238" name="__codelineno-5-238"></a>
<a id="__codelineno-5-239" name="__codelineno-5-239"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-5-240" name="__codelineno-5-240"></a><span class="sd">    ### 3. 视频识别相关功能 ### </span>
<a id="__codelineno-5-241" name="__codelineno-5-241"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-5-242" name="__codelineno-5-242"></a>
<a id="__codelineno-5-243" name="__codelineno-5-243"></a>    <span class="c1"># 关闭事件 询问用户是否退出</span>
<a id="__codelineno-5-244" name="__codelineno-5-244"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">closeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<a id="__codelineno-5-245" name="__codelineno-5-245"></a>        <span class="n">reply</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-5-246" name="__codelineno-5-246"></a>                                     <span class="s1">&#39;退出&#39;</span><span class="p">,</span>
<a id="__codelineno-5-247" name="__codelineno-5-247"></a>                                     <span class="s2">&quot;是否要退出程序？&quot;</span><span class="p">,</span>
<a id="__codelineno-5-248" name="__codelineno-5-248"></a>                                     <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">,</span>
<a id="__codelineno-5-249" name="__codelineno-5-249"></a>                                     <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
<a id="__codelineno-5-250" name="__codelineno-5-250"></a>        <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
<a id="__codelineno-5-251" name="__codelineno-5-251"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-5-252" name="__codelineno-5-252"></a>            <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
<a id="__codelineno-5-253" name="__codelineno-5-253"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-5-254" name="__codelineno-5-254"></a>            <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
<a id="__codelineno-5-255" name="__codelineno-5-255"></a>
<a id="__codelineno-5-256" name="__codelineno-5-256"></a>    <span class="c1"># 读取录像文件</span>
<a id="__codelineno-5-257" name="__codelineno-5-257"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-258" name="__codelineno-5-258"></a>        <span class="c1"># 选择录像文件进行读取</span>
<a id="__codelineno-5-259" name="__codelineno-5-259"></a>        <span class="n">mp4_fileName</span><span class="p">,</span> <span class="n">fileType</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Choose file&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;*.mp4&#39;</span><span class="p">)</span>
<a id="__codelineno-5-260" name="__codelineno-5-260"></a>        <span class="k">if</span> <span class="n">mp4_fileName</span><span class="p">:</span>
<a id="__codelineno-5-261" name="__codelineno-5-261"></a>            <span class="c1"># 启动录像文件读取得线程并在画面上实时显示</span>
<a id="__codelineno-5-262" name="__codelineno-5-262"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">mp4_fileName</span>
<a id="__codelineno-5-263" name="__codelineno-5-263"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-5-264" name="__codelineno-5-264"></a>            <span class="n">th</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_video</span><span class="p">)</span>
<a id="__codelineno-5-265" name="__codelineno-5-265"></a>            <span class="n">th</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-5-266" name="__codelineno-5-266"></a>
<a id="__codelineno-5-267" name="__codelineno-5-267"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open_local</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-268" name="__codelineno-5-268"></a>        <span class="c1"># 选择录像文件进行读取</span>
<a id="__codelineno-5-269" name="__codelineno-5-269"></a>        <span class="n">mp4_filename</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-5-270" name="__codelineno-5-270"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">mp4_filename</span>
<a id="__codelineno-5-271" name="__codelineno-5-271"></a>        <span class="c1"># 读取摄像头进行实时得显示</span>
<a id="__codelineno-5-272" name="__codelineno-5-272"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-5-273" name="__codelineno-5-273"></a>        <span class="n">th</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_video</span><span class="p">)</span>
<a id="__codelineno-5-274" name="__codelineno-5-274"></a>        <span class="n">th</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-5-275" name="__codelineno-5-275"></a>
<a id="__codelineno-5-276" name="__codelineno-5-276"></a>    <span class="c1"># 退出进程</span>
<a id="__codelineno-5-277" name="__codelineno-5-277"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-278" name="__codelineno-5-278"></a>        <span class="c1"># 点击关闭按钮后重新初始化界面</span>
<a id="__codelineno-5-279" name="__codelineno-5-279"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<a id="__codelineno-5-280" name="__codelineno-5-280"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-5-281" name="__codelineno-5-281"></a>
<a id="__codelineno-5-282" name="__codelineno-5-282"></a>    <span class="c1">#转换中文显示</span>
<a id="__codelineno-5-283" name="__codelineno-5-283"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nameText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">textColor</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">textSize</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
<a id="__codelineno-5-284" name="__codelineno-5-284"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>  <span class="c1"># 判断是否OpenCV图片类型</span>
<a id="__codelineno-5-285" name="__codelineno-5-285"></a>            <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<a id="__codelineno-5-286" name="__codelineno-5-286"></a>        <span class="c1"># 创建一个可以在给定图像上绘图的对象</span>
<a id="__codelineno-5-287" name="__codelineno-5-287"></a>        <span class="n">face_draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<a id="__codelineno-5-288" name="__codelineno-5-288"></a>        <span class="c1"># 显示字体的格式</span>
<a id="__codelineno-5-289" name="__codelineno-5-289"></a>        <span class="n">name_font</span><span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;simsun.ttc&quot;</span><span class="p">,</span> <span class="n">textSize</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<a id="__codelineno-5-290" name="__codelineno-5-290"></a>        <span class="c1"># 绘制人脸名称文本</span>
<a id="__codelineno-5-291" name="__codelineno-5-291"></a>        <span class="n">face_draw</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">textColor</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">name_font</span><span class="p">)</span>
<a id="__codelineno-5-292" name="__codelineno-5-292"></a>        <span class="c1"># 转换回OpenCV格式</span>
<a id="__codelineno-5-293" name="__codelineno-5-293"></a>        <span class="k">return</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2BGR</span><span class="p">)</span>
<a id="__codelineno-5-294" name="__codelineno-5-294"></a>
<a id="__codelineno-5-295" name="__codelineno-5-295"></a>    <span class="c1"># todo 执行人脸识别主进程</span>
<a id="__codelineno-5-296" name="__codelineno-5-296"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_video</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-297" name="__codelineno-5-297"></a>        <span class="c1"># 首先把打开按钮关闭</span>
<a id="__codelineno-5-298" name="__codelineno-5-298"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-5-299" name="__codelineno-5-299"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-5-300" name="__codelineno-5-300"></a>        <span class="n">process_this_frame</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-5-301" name="__codelineno-5-301"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-5-302" name="__codelineno-5-302"></a>            <span class="n">ret</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># 读取摄像头</span>
<a id="__codelineno-5-303" name="__codelineno-5-303"></a>            <span class="c1"># opencv的图像是BGR格式的，而我们需要是的RGB格式的，因此需要进行一个转换。</span>
<a id="__codelineno-5-304" name="__codelineno-5-304"></a>            <span class="n">rgb_frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>  <span class="c1"># 将图像转化为rgb颜色通道</span>
<a id="__codelineno-5-305" name="__codelineno-5-305"></a>            <span class="c1"># gray_frame = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)</span>
<a id="__codelineno-5-306" name="__codelineno-5-306"></a>            <span class="c1"># 检查人脸 按照1.1倍放到 周围最小像素为5</span>
<a id="__codelineno-5-307" name="__codelineno-5-307"></a>            <span class="c1"># face_zone = self.face_detect.detectMultiScale(gray_frame, scaleFactor=2, minNeighbors=2)  # maxSize = (55,55)</span>
<a id="__codelineno-5-308" name="__codelineno-5-308"></a>            <span class="k">if</span> <span class="n">process_this_frame</span><span class="p">:</span>
<a id="__codelineno-5-309" name="__codelineno-5-309"></a>                <span class="n">face_locations</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_locations</span><span class="p">(</span><span class="n">rgb_frame</span><span class="p">)</span>  <span class="c1"># 获得所有人脸位置</span>
<a id="__codelineno-5-310" name="__codelineno-5-310"></a>                <span class="n">face_encodings</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_encodings</span><span class="p">(</span><span class="n">rgb_frame</span><span class="p">,</span> <span class="n">face_locations</span><span class="p">)</span>  <span class="c1"># 获得人脸特征值</span>
<a id="__codelineno-5-311" name="__codelineno-5-311"></a>                <span class="n">face_names</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># 存储出现在画面中人脸的名字</span>
<a id="__codelineno-5-312" name="__codelineno-5-312"></a>                <span class="k">for</span> <span class="n">face_encoding</span> <span class="ow">in</span> <span class="n">face_encodings</span><span class="p">:</span>  <span class="c1"># 和数据库人脸进行对比</span>
<a id="__codelineno-5-313" name="__codelineno-5-313"></a>                    <span class="c1"># 如果当前人脸和数据库的人脸的相似度超过0.6，则认为人脸匹配</span>
<a id="__codelineno-5-314" name="__codelineno-5-314"></a>                    <span class="n">matches</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">compare_faces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">known_encodings</span><span class="p">,</span> <span class="n">face_encoding</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<a id="__codelineno-5-315" name="__codelineno-5-315"></a>                    <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
<a id="__codelineno-5-316" name="__codelineno-5-316"></a>                        <span class="n">first_match_index</span> <span class="o">=</span> <span class="n">matches</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-5-317" name="__codelineno-5-317"></a>                        <span class="c1"># 返回相似度最高的作为当前人脸的名称</span>
<a id="__codelineno-5-318" name="__codelineno-5-318"></a>                        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">known_names</span><span class="p">[</span><span class="n">first_match_index</span><span class="p">]</span>
<a id="__codelineno-5-319" name="__codelineno-5-319"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-5-320" name="__codelineno-5-320"></a>                        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;未知人脸&quot;</span>
<a id="__codelineno-5-321" name="__codelineno-5-321"></a>                    <span class="n">face_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-5-322" name="__codelineno-5-322"></a>            <span class="n">process_this_frame</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">process_this_frame</span>
<a id="__codelineno-5-323" name="__codelineno-5-323"></a>            <span class="c1"># 将捕捉到的人脸显示出来</span>
<a id="__codelineno-5-324" name="__codelineno-5-324"></a>            <span class="k">for</span> <span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">left</span><span class="p">),</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">face_locations</span><span class="p">,</span> <span class="n">face_names</span><span class="p">):</span>
<a id="__codelineno-5-325" name="__codelineno-5-325"></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">),</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">),</span> <span class="p">(</span><span class="mi">113</span><span class="p">,</span><span class="mi">152</span><span class="p">,</span><span class="mi">248</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># 画人脸矩形框</span>
<a id="__codelineno-5-326" name="__codelineno-5-326"></a>                <span class="k">if</span> <span class="n">name</span><span class="o">!=</span><span class="s1">&#39;未知人脸&#39;</span><span class="p">:</span>
<a id="__codelineno-5-327" name="__codelineno-5-327"></a>                    <span class="n">name_list</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-5-328" name="__codelineno-5-328"></a>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_list</span><span class="p">)):</span>
<a id="__codelineno-5-329" name="__codelineno-5-329"></a>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-5-330" name="__codelineno-5-330"></a>                            <span class="n">name_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;*&quot;</span>
<a id="__codelineno-5-331" name="__codelineno-5-331"></a>                        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span> <span class="p">:</span>
<a id="__codelineno-5-332" name="__codelineno-5-332"></a>                            <span class="n">name_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;*&quot;</span>
<a id="__codelineno-5-333" name="__codelineno-5-333"></a>                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span>
<a id="__codelineno-5-334" name="__codelineno-5-334"></a>                <span class="n">frame</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nameText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">name</span><span class="p">,(</span><span class="n">left</span><span class="o">+</span><span class="mi">55</span><span class="p">,</span> <span class="n">bottom</span><span class="o">+</span><span class="mi">15</span><span class="p">),(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">30</span><span class="p">)</span>
<a id="__codelineno-5-335" name="__codelineno-5-335"></a>
<a id="__codelineno-5-336" name="__codelineno-5-336"></a>
<a id="__codelineno-5-337" name="__codelineno-5-337"></a>            <span class="c1"># 保存图片并进行实时的显示</span>
<a id="__codelineno-5-338" name="__codelineno-5-338"></a>            <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>
<a id="__codelineno-5-339" name="__codelineno-5-339"></a>            <span class="n">frame_height</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-5-340" name="__codelineno-5-340"></a>            <span class="n">frame_width</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-5-341" name="__codelineno-5-341"></a>            <span class="n">frame_scale</span> <span class="o">=</span> <span class="mi">500</span> <span class="o">/</span> <span class="n">frame_height</span>
<a id="__codelineno-5-342" name="__codelineno-5-342"></a>            <span class="n">frame_resize</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">frame_width</span> <span class="o">*</span> <span class="n">frame_scale</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_height</span> <span class="o">*</span> <span class="n">frame_scale</span><span class="p">)))</span>
<a id="__codelineno-5-343" name="__codelineno-5-343"></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;images/tmp.jpg&quot;</span><span class="p">,</span> <span class="n">frame_resize</span><span class="p">)</span>
<a id="__codelineno-5-344" name="__codelineno-5-344"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;images/tmp.jpg&quot;</span><span class="p">))</span>
<a id="__codelineno-5-345" name="__codelineno-5-345"></a>            <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-5-346" name="__codelineno-5-346"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-5-347" name="__codelineno-5-347"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-5-348" name="__codelineno-5-348"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-5-349" name="__codelineno-5-349"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-5-350" name="__codelineno-5-350"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-5-351" name="__codelineno-5-351"></a>                <span class="k">break</span>
<a id="__codelineno-5-352" name="__codelineno-5-352"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-5-353" name="__codelineno-5-353"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-5-354" name="__codelineno-5-354"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-5-355" name="__codelineno-5-355"></a>
<a id="__codelineno-5-356" name="__codelineno-5-356"></a>    <span class="c1"># 初始化视频检测界面</span>
<a id="__codelineno-5-357" name="__codelineno-5-357"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_down</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-358" name="__codelineno-5-358"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
<a id="__codelineno-5-359" name="__codelineno-5-359"></a>        <span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
<a id="__codelineno-5-360" name="__codelineno-5-360"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;UI_images/ae862.jpg&quot;</span><span class="p">))</span>
<a id="__codelineno-5-361" name="__codelineno-5-361"></a>
<a id="__codelineno-5-362" name="__codelineno-5-362"></a>
<a id="__codelineno-5-363" name="__codelineno-5-363"></a>
<a id="__codelineno-5-364" name="__codelineno-5-364"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-5-365" name="__codelineno-5-365"></a>    <span class="c1"># 加载页面</span>
<a id="__codelineno-5-366" name="__codelineno-5-366"></a>    <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<a id="__codelineno-5-367" name="__codelineno-5-367"></a>    <span class="n">mainWindow</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
<a id="__codelineno-5-368" name="__codelineno-5-368"></a>    <span class="n">mainWindow</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-5-369" name="__codelineno-5-369"></a>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<h2 id="_5">参考文献<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<p>[1] 龙慧,朱孟春,邓娅倩等.基于 OpenCV 的智能校园人脸门禁系统的设计与实现[J].工业控制 计算机,2023,36(09):73-75.<br />
[2] 冯婧,顾梅花.基于 OpenCV 的人脸识别算法研究与实现[J].电脑知识与技 术,2020,16(14):3-5.DOI:10.14004/j.cnki.ckt.2020.1473<br />
[3] 廖周宇,王钰婷,陈科良.基于 OpenCV 的人脸识别算法[J].电子技术与软件工 程,2020,(09):133-136.<br />
[4] 李颖聪,陈贝文,廖晓芳等.基于 OpenCV 的人脸识别系统设计与实现[J].电脑知识与技 术,2022,18(18):53-55.DOI:10.14004/j.cnki.ckt.2022.1155<br />
[5] 张绿云,韦肖雨,李琳.基于Python与OpenCV的人脸识别系统设计与实现[J].电脑知识与技 术,2022,18(10):87-88.DOI:10.14004/j.cnki.ckt.2022.0783<br />
[6] 黄安祺, &amp; 陈争奇. (2017). 基于 OpenCV 的人脸识别技术研究. 电子技术与软件工程, 16(13), 36-37.<br />
[7] 郑亚军, &amp; 王丽娟. (2019). 基于 OpenCV 的人脸识别技术研究与实现. 电子技术与软件工 程, 18(5), 46-48.<br />
[8] 王志敏, &amp; 刘杰. (2019). 基于 OpenCV 的人脸识别算法研究与实现. 现代计算机, (11), 26-28.<br />
[9] 张海波, &amp; 王振华. (2019). 基于 OpenCV 的人脸识别算法研究与实现. 计算机与数字工程, (6), 169-170.<br />
[10] 赵宇航, &amp; 张晓艳. (2018). 基于 OpenCV 的人脸识别算法研究与实现. 现代计算机, (12), 16-18.  </p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="最后更新">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="2025年2月7日 07:03:17 UTC">2025-02-07</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="创建日期">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="2023年9月22日 17:47:24 UTC">2023-09-22</span>
  </span>

    
    
    
      
  <span class="md-source-file__fact">
    
      
  <span class="md-icon" title="贡献者">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </span>
  <span>GitHub</span>

    
    <nav>
      
        <a href="https://github.com/Wcowin" class="md-author" title="@Wcowin">
          
          <img src="https://avatars.githubusercontent.com/u/99159173?v=4&size=72" alt="Wcowin">
        </a>
      
      
      
    </nav>
  </span>

    
  </aside>

<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine feedback configuration -->

  


<!-- Determine whether to show feedback -->


<!-- Was this page helpful? -->

  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        此页面有帮助吗？
      </legend>
      <div class="md-feedback__inner">

        <!-- Feedback ratings -->
        <div class="md-feedback__list">
          
            <button
              class="md-feedback__icon md-icon"
              type="submit"
              title="This page was helpful"
              data-md-value="1"
            >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg>
            </button>
          
            <button
              class="md-feedback__icon md-icon"
              type="submit"
              title="This page could be improved"
              data-md-value="0"
            >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg>
            </button>
          
        </div>

        <!-- Feedback rating notes (shown after submission) -->
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              

              <!-- Determine title -->
              
                
              

              <!-- Replace {url} and {title} placeholders in note -->
              谢谢你的反馈！
            </div>
          
            <div data-md-value="0" hidden>
              

              <!-- Determine title -->
              
                
              

              <!-- Replace {url} and {title} placeholders in note -->
              Thanks for your feedback! Help us improve this page by using our <a href="https://marketingplatform.google.com/about/analytics/" target="_blank" rel="noopener">feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <!-- Footer -->
<footer class="md-footer">
  <!-- Link to previous and/or next page - 移到最上面 -->
    
  <nav
    class="md-footer__inner md-grid"
    aria-label="页脚"
    
  >
    <!-- Link to previous page -->
     
    <a
      href="../muplayer/"
      class="md-footer__link md-footer__link--prev"
      aria-label="上一页: 简单的 JavaScript 音乐播放器"
    >
      <div class="md-footer__button md-icon">
         <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
      </div>
      <div class="md-footer__title">
        <span class="md-footer__direction"> 上一页 </span>
        <div class="md-ellipsis">简单的 JavaScript 音乐播放器</div>
      </div>
    </a>
    

    <!-- Link to next page -->
     
    <a
      href="../email/"
      class="md-footer__link md-footer__link--next"
      aria-label="下一页: 用AirScript脚本给女/男朋友发送每日早安邮件(极简版本)"
    >
      <div class="md-footer__title">
        <span class="md-footer__direction"> 下一页 </span>
        <div class="md-ellipsis">用AirScript脚本给女/男朋友发送每日早安邮件(极简版本)</div>
      </div>
      <div class="md-footer__button md-icon">
         <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
      </div>
    </a>
    
  </nav>
   

  <!-- Further information -->
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="footer-wrapper">
        <!-- 访问统计区域 -->
        <div class="footer-content">
          <div class="footer-visit-count">
            <div class="footer-item">
              <!-- <span class="footer-icon">👀</span> -->
              <span>本站访问量：</span>
              <span id="finicount_views" class="footer-highlight"></span>
            </div>

            <div class="footer-item">
              <!-- <span class="footer-icon">📝</span> -->
              <a
                href="https://icp.gov.moe/?keyword=20230640"
                target="_blank"
                rel="noopener noreferrer"
                class="icp-link"
                >萌ICP备20230640号</a>
            </div>

            <div class="footer-item runtime-info">
              <!-- <span class="footer-icon">⏱️</span> -->
              <span>本站已经运行</span>
              <span id="box1" class="footer-highlight"></span>
            </div>
          </div>
        </div>

        <!-- 移动端简洁布局 (仿 footercopy.html) -->
        <div class="footer-visit-count-mobile">
          <span>本站访问量：</span>
          <span id="finicount_views_mobile" class="footer-highlight"></span>
          |
          <a
            href="https://icp.gov.moe/?keyword=20230640"
            target="_blank"
            rel="noopener noreferrer"
            class="icp-link"
          >萌ICP备20230640号</a>
          <!-- |&nbsp; -->
          <span class="runtime-info">
            <span>本站已经运行</span>
            <span id="box1_mobile"></span>
          </span>
        </div>

        <!-- 版权信息和社交媒体水平布局 -->
        <div class="footer-bottom-section">
          <div class="md-footer-copyright">
            <p>Copyright © 2022-2025 Wcowin</p>
            <p>Made with <a href="https://squidfunk.github.io/mkdocs-material/" style="color: #518FC1; text-decoration: none;">Material for MkDocs</a></p>
          </div>

          
            <div class="footer-social">
              <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://pic1.zhimg.com/80/v2-8ad8e415b3eb139134b0373ff95c6846_1440w.webp" target="_blank" rel="noopener" title="pic1.zhimg.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://t.me/Wcowin" target="_blank" rel="noopener" title="t.me" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8m114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.45 10.45 0 0 1 3.53 6.716 43.8 43.8 0 0 1 .417 9.769"/></svg>
    </a>
  
    
    
    
    
    <a href="https://twitter.com/wcowin_" target="_blank" rel="noopener" title="Twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/Wcowin" target="_blank" rel="noopener" title="Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://space.bilibili.com/1407028951/lists/4566631?type=series" target="_blank" rel="noopener" title="space.bilibili.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92.02c-26.45-.8-48.21-9.8-65.28-27.2C9.682 419.4.767 396.5 0 368.2V169.8c.767-26 9.682-47.6 26.74-65.7C43.81 87.75 65.57 78.77 92.02 78h29.38L96.05 52.19c-5.75-5.73-8.63-13-8.63-21.79 0-8.8 2.88-16.06 8.63-21.797C101.8 2.868 109.1 0 117.9 0q13.2 0 21.9 8.603L213.1 78h88l74.5-69.397C381.7 2.868 389.2 0 398 0q13.2 0 21.9 8.603c5.7 5.737 8.6 12.997 8.6 21.797 0 8.79-2.9 16.06-8.6 21.79L394.6 78h29.3c26.4.77 48 9.75 64.7 26.1m-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96.05c-9.59.4-17.45 3.7-23.58 9.8-6.14 6.1-9.4 13.9-9.78 23.5v194.4c0 9.2 3.26 17 9.78 23.5s14.38 9.8 23.58 9.8H416.4c9.2 0 17-3.3 23.3-9.8s9.7-14.3 10.1-23.5zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5s-17.5-3.2-23.6-9.5-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2s13.2-9.6 23.3-10c9.2.4 17 3.7 23.3 10m191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2s-14 9.5-23.6 9.5-17.4-3.2-23.6-9.5c-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2s14.1-9.6 23.3-10c9.2.4 17 3.7 23.3 10"/></svg>
    </a>
  
    
    
    
    
    <a href="https://blog.csdn.net/m0_63203517?spm=1000.2115.3001.5343" target="_blank" rel="noopener" title="CSDN" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 0C28.7 0 0 28.7 0 64v384c0 35.3 28.7 64 64 64h256c35.3 0 64-28.7 64-64V160H256c-17.7 0-32-14.3-32-32V0zm192 0v128h128zM153 289l-31 31 31 31c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0L71 337c-9.4-9.4-9.4-24.6 0-33.9l48-48c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9zm112-34 48 48c9.4 9.4 9.4 24.6 0 33.9l-48 48c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l31-31-31-31c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<wangkewen821@gmail.com>" target="_blank" rel="noopener" title="Email" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 112c-8.8 0-16 7.2-16 16v22.1l172.5 141.6c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16zM48 212.2V384c0 8.8 7.2 16 16 16h384c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0zM0 128c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64z"/></svg>
    </a>
  
</div>
            </div>
          
        </div>
      </div>

      <script>
        (function() {
          // 避免变量冲突，将所有代码包装在立即执行函数中

          function timingTime() {
            const start = "2022-10-20T00:00:00";
            const startTime = new Date(start).getTime();
            const now = Date.now();
            let diff = Math.floor((now - startTime) / 1000);
            const days = Math.floor(diff / 86400);
            diff %= 86400;
            const hours = Math.floor(diff / 3600);
            diff %= 3600;
            const minutes = Math.floor(diff / 60);
            const seconds = diff % 60;
            return `${days}天${hours}时${minutes}分${seconds}秒`;
          }

          // 简化的计时器更新函数
          function updateTime() {
            const el = document.getElementById("box1");
            const elMobile = document.getElementById("box1_mobile");
            const time = timingTime();

            if (el) el.textContent = time;
            if (elMobile) elMobile.textContent = time;
          }

          // 加载访问量计数器
          async function loadVisitCounter() {
            try {
              const script = document.createElement('script');
              script.src = '//finicounter.eu.org/finicounter.js';
              script.async = true;
              script.onerror = function() {
                console.log('访问量计数器加载失败，使用备用显示');
                const desktop = document.getElementById("finicount_views");
                const mobile = document.getElementById("finicount_views_mobile");
                if (desktop) desktop.textContent = '统计中...';
                if (mobile) mobile.textContent = '统计中...';
              };
              document.head.appendChild(script);
            } catch (e) {
              console.log('访问量计数器初始化失败:', e);
            }
          }

          // 同步访问量显示
          function syncVisitCount() {
            const desktop = document.getElementById("finicount_views");
            const mobile = document.getElementById("finicount_views_mobile");
            if (desktop && mobile && desktop.textContent && desktop.textContent !== '加载中...') {
              mobile.textContent = desktop.textContent;
            }
          }

          // 监听访问量更新
          function setupVisitCountObserver() {
            try {
              const observer = new MutationObserver(syncVisitCount);
              const visitCountTarget = document.getElementById("finicount_views");
              if (visitCountTarget) {
                observer.observe(visitCountTarget, { childList: true, subtree: true });
              }
            } catch (e) {
              console.log('访问量监听器设置失败:', e);
            }
          }

          // 初始化所有功能
          function init() {
            // 启动计时器
            updateTime();
            setInterval(updateTime, 1000);

            // 加载访问量计数器
            loadVisitCounter();

            // 设置访问量同步
            setupVisitCountObserver();

            // 调试信息
            console.log('页脚功能已启动');
            console.log('当前时间:', timingTime());
          }

          // 确保DOM加载完成后再初始化
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
          } else {
            init();
          }

        })();
      </script>

      <style>
        /* 页脚背景配色方案 - 可根据喜好选择 */

        /* 方案1: 现代深蓝灰色调 (当前使用) */
        .md-footer {
          background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        }

        .md-footer-meta {
          background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }

        /* 方案2: 优雅紫色调 (取消注释使用)
        .md-footer {
          background: linear-gradient(135deg, #2d1b69 0%, #4c1d95 100%);
        }

        .md-footer-meta {
          background: linear-gradient(135deg, #1e1b4b 0%, #2d1b69 100%);
        }
        */

        /* 方案3: 温暖深绿色调 (取消注释使用)
        .md-footer {
          background: linear-gradient(135deg, #14532d 0%, #166534 100%);
        }

        .md-footer-meta {
          background: linear-gradient(135deg, #052e16 0%, #14532d 100%);
        }
        */

        /* 方案4: 经典深灰色调 (取消注释使用)
        .md-footer {
          background: linear-gradient(135deg, #374151 0%, #4b5563 100%);
        }

        .md-footer-meta {
          background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
        }
        */

        /* 整体页脚容器 */
        .footer-wrapper {
          width: 100%;
          padding: 0.2rem 0;
          text-align: center;
        }

        /* 版权信息和社交媒体水平布局 */
        .footer-bottom-section {
          max-width: 900px;
          margin: 0.4rem auto 0;
          padding: 0.4rem 1rem;
          border-top: 1px solid rgba(255, 255, 255, 0.15);
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        /* 版权信息 */
        .md-footer-copyright {
          text-align: left;
          font-size: 0.75rem;
          opacity: 0.8;
          line-height: 1.2;
        }

        /* 社交媒体图标 */
        .footer-social {
          display: -webkit-flex;
          display: flex;
          gap: 0.3rem;
          -webkit-align-items: center;
          align-items: center;
        }

        /* Safari兼容性修复 */
        .footer-social .md-social__link svg {
          -webkit-transform: translateZ(0);
          transform: translateZ(0);
          backface-visibility: hidden;
          -webkit-backface-visibility: hidden;
          opacity: 1 !important;
          visibility: visible !important;
          pointer-events: auto;
        }

        /* 强制Safari显示SVG图标 */
        .footer-social .md-social__link {
          opacity: 1 !important;
          visibility: visible !important;
        }
        
        /* 内容区域样式 */
        .footer-content {
          max-width: 900px;
          margin: 0 auto;
          padding: 0.4rem 0 0;
        }

        .footer-visit-count {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.3rem;
          font-size: 0.75rem;
          color: var(--md-footer-fg-color--light);
        }

        .footer-item {
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 0.4rem 0.8rem;
          border-radius: 16px;
          background: rgba(255, 255, 255, 0.1);
          border: 1px solid rgba(255, 255, 255, 0.15);
          backdrop-filter: blur(10px);
          min-width: 160px;
          font-size: 0.8rem;
          transition: all 0.2s ease;
        }

        .footer-item:hover {
          background: rgba(255, 255, 255, 0.15);
          border-color: rgba(81, 143, 193, 0.4);
          transform: translateY(-1px);
        }
        
        .footer-icon {
          margin-right: 0.5rem;
          font-size: 1rem;
        }
        
        .footer-highlight {
          color: #518FC1;
          font-weight: 600;
          margin-left: 0.3rem;
        }

        .icp-link {
          color: inherit;
          text-decoration: none;
        }

        .icp-link:hover {
          color: #518FC1;
        }
        
        /* 社交媒体图标样式 - 仅桌面端 */
        @media (min-width: 76.1875em) {
          .footer-social .md-social__link {
            padding: 0.3rem;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            width: 2rem;
            height: 2rem;
            display: -webkit-inline-flex;
            display: inline-flex;
            -webkit-align-items: center;
            align-items: center;
            -webkit-justify-content: center;
            justify-content: center;
            -webkit-transition: all 0.2s ease;
            transition: all 0.2s ease;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
          }

          .footer-social .md-social__link svg {
            width: 1.2rem;
            height: 1.2rem;
            fill: currentColor;
            -webkit-flex-shrink: 0;
            flex-shrink: 0;
          }

          .footer-social .md-social__link:hover {
            background: rgba(81, 143, 193, 0.2);
            border-color: rgba(81, 143, 193, 0.4);
          }
        }

        /* 移动端社交媒体图标样式 - 恢复默认样式 */
        @media (max-width: 76.1875em) {
          .footer-social .md-social__link {
            padding: 0.4rem;
            background: transparent;
            border: none;
            width: auto;
            height: auto;
            display: inline-block;
            border-radius: 0;
            -webkit-transition: color 0.2s ease;
            transition: color 0.2s ease;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
          }

          .footer-social .md-social__link:hover {
            background: transparent;
            border: none;
            color: var(--md-accent-fg-color);
          }

          .footer-social .md-social__link svg {
            width: 1.6rem;
            height: 1.6rem;
            fill: currentColor;
            -webkit-flex-shrink: 0;
            flex-shrink: 0;
            display: block;
          }
        }
        
        /* 导航链接样式 */
        .md-footer__link {
          transition: opacity 0.2s ease;
        }
        
        .md-footer__link:hover {
          opacity: 1;
        }

        /* 移动端响应式 - 使用 footercopy.html 样式 */
        @media (max-width: 76.1875em) {
          /* 隐藏桌面端的卡片式布局 */
          .footer-visit-count {
            display: none;
          }

          .footer-bottom-section {
            flex-direction: column;
            gap: 0.6rem;
            text-align: center;
          }

          .md-footer-copyright {
            text-align: center;
            font-size: 0.75rem;
          }

          .footer-social .md-social__link {
            width: 1.8rem;
            height: 1.8rem;
          }

          /* 显示移动端的简洁布局 */
          .footer-visit-count-mobile {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 0.4em 0.8em;
            padding: 0.2em 0;
            font-size: 0.75rem;
            color: var(--md-footer-fg-color--light);
            text-align: center;
          }

          .footer-visit-count-mobile > * {
            white-space: nowrap;
          }

          .footer-visit-count-mobile .icp-link {
            color: var(--md-footer-fg-color--light);
            text-decoration: none;
          }

          .footer-visit-count-mobile .icp-link:hover {
            color: #518FC1;
            text-decoration: underline;
          }

          /* .runtime-info {
            display: none; 移动端隐藏运行时间
          } */
        }

        /* 桌面端隐藏移动端布局 */
        @media (min-width: 76.1875em) {
          .footer-visit-count-mobile {
            display: none;
          }
        }

        @media (min-width: 768px) {
          .footer-visit-count {
            flex-direction: row;
            justify-content: center;
            gap: 2rem;
          }
        }

        /* 深色模式适配 */
        [data-md-color-scheme="slate"] .md-footer {
          background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }

        [data-md-color-scheme="slate"] .md-footer-meta {
          background: linear-gradient(135deg, #020617 0%, #0f172a 100%);
        }

        [data-md-color-scheme="slate"] .footer-item {
          background: rgba(255, 255, 255, 0.08);
          border-color: rgba(255, 255, 255, 0.12);
        }

        [data-md-color-scheme="slate"] .footer-item:hover {
          background: rgba(255, 255, 255, 0.12);
          border-color: rgba(81, 143, 193, 0.3);
        }

        [data-md-color-scheme="slate"] .footer-social .md-social__link {
          background: rgba(255, 255, 255, 0.08);
          border-color: rgba(255, 255, 255, 0.12);
        }
      </style>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "navigation.instant", "navigation.prune", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "search.share", "toc.follow", "navigation.expand", "navigation.indexes", "content.tabs.link", "content.tooltips", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="../../../javascripts/extra2.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/javascripts/extra.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/javascripts/view.js"></script>
      
        <script src="../../../assets/document_dates/tippy/popper.min.js"></script>
      
        <script src="../../../assets/document_dates/tippy/tippy.umd.min.js"></script>
      
        <script src="../../../assets/document_dates/core/core.js"></script>
      
        <script src="../../../assets/document_dates/user.config.js"></script>
      
    
  </body>
</html>