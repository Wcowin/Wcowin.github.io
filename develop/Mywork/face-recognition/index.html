
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="çŸ¥è¶³ä¸”ä¸Šè¿›ï¼Œæ¸©æŸ”ä¸”åšå®š">
      
      
        <meta name="author" content="ç‹ç§‘æ–‡(Wcowin)">
      
      
        <link rel="canonical" href="http://wcowin.work/develop/Mywork/face-recognition/">
      
      
        <link rel="prev" href="../muplayer/">
      
      
        <link rel="next" href="../email/">
      
      
      <link rel="icon" href="https://i.stardots.io/wcowin/1750090373988.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>äººè„¸è¯†åˆ«ç³»ç»Ÿ - Wcowin's Blog</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra2.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/link.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/customize.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/ziti.css">
    
      <link rel="stylesheet" href="https://fontsapi.zeoseven.com/292/main/result.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-29HZMNR0KG"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-29HZMNR0KG",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-29HZMNR0KG",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          è·³è½¬è‡³
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰">
    <a href="../../.." title="Wcowin&#39;s Blog" class="md-header__button md-logo" aria-label="Wcowin's Blog" data-md-component="logo">
      
  <img src="https://pica.zhimg.com/80/v2-74ecd899c7c4cc0258930eaff239a21b_1440w.webp" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Wcowin's Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              äººè„¸è¯†åˆ«ç³»ç»Ÿ
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="å…³é—­è‡ªåŠ¨æ¨¡å¼"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="å…³é—­è‡ªåŠ¨æ¨¡å¼" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="åˆ‡æ¢è‡³å¤œé—´æ¨¡å¼"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="åˆ‡æ¢è‡³å¤œé—´æ¨¡å¼" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="åˆ‡æ¢è‡³æ—¥é—´æ¨¡å¼"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="åˆ‡æ¢è‡³æ—¥é—´æ¨¡å¼" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="é€‰æ‹©å½“å‰è¯­è¨€">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M160 0c17.7 0 32 14.3 32 32v32h128c17.7 0 32 14.3 32 32s-14.3 32-32 32h-9.6l-8.4 23.1c-16.4 45.2-41.1 86.5-72.2 122 14.2 8.8 29 16.6 44.4 23.5l50.4 22.4 62.2-140c5.1-11.6 16.6-19 29.2-19s24.1 7.4 29.2 19l128 288c7.2 16.2-.1 35.1-16.2 42.2s-35.1-.1-42.2-16.2l-20-45H337.3l-20 45c-7.2 16.2-26.1 23.4-42.2 16.2s-23.4-26.1-16.2-42.2l39.8-89.5-50.4-22.4c-23-10.2-45-22.4-65.8-36.4-21.3 17.2-44.6 32.2-69.5 44.7l-34.7 17.2c-15.8 7.9-35 1.5-42.9-14.3s-1.5-35 14.3-42.9l34.5-17.3c16.3-8.2 31.8-17.7 46.4-28.3-13.8-12.7-26.8-26.4-38.9-40.9l-10.1-12.2c-11.3-13.6-9.5-33.8 4.1-45.1s33.8-9.5 45.1 4.1l10.2 12.2c11.5 13.9 24.1 26.8 37.4 38.7 27.5-30.4 49.2-66.1 63.5-105.4l.5-1.2H32.1C14.3 128 0 113.7 0 96s14.3-32 32-32h96V32c0-17.7 14.3-32 32-32m256 270.8L365.7 384h100.6z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="javascript:translateTo('chinese_simplified');" hreflang="zh" class="md-select__link">
              ä¸­æ–‡
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="javascript:translateTo('english');" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="javascript:translateTo('korean');" hreflang="ko" class="md-select__link">
              í•œêµ­ì–´
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="javascript:translateTo('japanese');" hreflang="ja" class="md-select__link">
              æ—¥æœ¬èª
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="æŸ¥æ‰¾">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="åˆ†äº«" aria-label="åˆ†äº«" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="æ¸…ç©ºå½“å‰å†…å®¹" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Wcowin/Wcowin.github.io" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Wcowin.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="æ ‡ç­¾" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../blog/indexblog/" class="md-tabs__link">
          
  
  
    
  
  æŠ€æœ¯

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  å¼€å‘

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../relax/" class="md-tabs__link">
          
  
  
    
  
  é—²èŠ

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../trip/" class="md-tabs__link">
          
  
  
    
  
  æ—…è¡Œ

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../tag/" class="md-tabs__link">
        
  
  
    
  
  æ ‡ç­¾

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../waline/" class="md-tabs__link">
        
  
  
    
  
  ç•™è¨€æ¿

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../link/" class="md-tabs__link">
          
  
  
    
  
  æœ‹å‹

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../blog/" class="md-tabs__link">
          
  
  
    
  
  åšå®¢

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../about/geren/" class="md-tabs__link">
          
  
  
    
  
  å…³äº

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://wcowin.work/Mkdocs-Wcowin/" class="md-tabs__link">
        
  
  
    
  
  Mkdocsä¸­æ–‡æ•™ç¨‹

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://www.travellings.cn/go.html" class="md-tabs__link">
        
  
  
    
  
  å¼€å¾€

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="å¯¼èˆªæ " data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Wcowin&#39;s Blog" class="md-nav__button md-logo" aria-label="Wcowin's Blog" data-md-component="logo">
      
  <img src="https://pica.zhimg.com/80/v2-74ecd899c7c4cc0258930eaff239a21b_1440w.webp" alt="logo">

    </a>
    Wcowin's Blog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Wcowin/Wcowin.github.io" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Wcowin.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../blog/indexblog/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    æŠ€æœ¯
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    å¼€å‘
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            å¼€å‘
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deepseek/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DeepSeek:ä»å…¥é—¨åˆ°ç²¾é€š
    
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="æœ€è¿‘æ·»åŠ ">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    MCP
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            MCP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://mcp-docs.cn/introduction" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MCPä¸­æ–‡æ–‡æ¡£
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AI/mcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is MCP
    
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="æœ€è¿‘æ·»åŠ ">
    </span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AIå·¥å…·
    
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="æœ€è¿‘æ·»åŠ ">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ChatGPT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    å¦‚ä½•æ³¨å†ŒChatGPT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mydevice/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    æˆ‘çš„è®¾å¤‡
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Markdown
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Markdown
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Markdown/markdown/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MarkdownæŒ‡å—
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Markdown/MWeb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MWeb Pro
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git å®ç”¨æŠ€å·§
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" checked>
        
          
          <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    æˆ‘çš„é¡¹ç›®/ä½œå“
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            æˆ‘çš„é¡¹ç›®/ä½œå“
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mkdocs-wcowin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Wcowin for MkDocsä¸»é¢˜
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mkdocsplugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mkdocsç›¸å…³æ’ä»¶
    
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="æœ€è¿‘æ·»åŠ ">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../muplayer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ç®€å•çš„ JavaScript éŸ³ä¹æ’­æ”¾å™¨
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    äººè„¸è¯†åˆ«ç³»ç»Ÿ
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    äººè„¸è¯†åˆ«ç³»ç»Ÿ
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      åŸºæœ¬åŸç†
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      æˆ‘åœ¨åŸä½œè€…åŸºç¡€ä¸Šåšçš„ä¼˜åŒ–ç‰ˆ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      æ•ˆæœ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ing" class="md-nav__link">
    <span class="md-ellipsis">
      æŒç»­ä¼˜åŒ–ing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      å‚è€ƒæ–‡çŒ®
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../email/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ç”¨AirScriptè„šæœ¬ç»™å¥³/ç”·æœ‹å‹å‘é€æ¯æ—¥æ—©å®‰é‚®ä»¶(æç®€ç‰ˆæœ¬)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../face_compare/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    åŸºäºè®¯é£äººè„¸ç®—æ³•è¿›è¡Œäººè„¸æ¯”å¯¹
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../opencv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    åŸºäºç™¾åº¦APIå’Œopencvçš„æ™ºèƒ½è½¦ç‰Œè¯†åˆ«ç¨‹åº
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aizhiwu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    åˆ©ç”¨ç™¾åº¦APIè¿›è¡Œæ¤ç‰©è¯†åˆ«
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ç©çš„è®¾è®¡
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_10" >
        
          
          <label class="md-nav__link" for="__nav_2_10" id="__nav_2_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    è®¾è®¡ç¾å­¦
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            è®¾è®¡ç¾å­¦
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../designbeauty/db1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    å”Â·è¯ºæ›¼â€”æƒ…æ„Ÿè®¾è®¡çš„ä¸‰ä¸ªå±‚æ¬¡
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../designbeauty/my-to-desihn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    æˆ‘å¯¹è®¾è®¡çš„ä¸€äº›è§‚ç‚¹
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1024code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1024code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lighthouse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    åˆ©ç”¨Lighthouseæµ‹è¯•ç½‘ç«™æ€§èƒ½
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Github/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is Github
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vercel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    å¦‚ä½•å°† github pages è¿ç§»åˆ° vercel ä¸Šæ‰˜ç®¡
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fenxiang/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    å¤§å‚ä»¬çš„è‰¯å¿ƒè½¯ä»¶ï½
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Mac/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    å†™ç»™æ‰€æœ‰ Mac ç”¨æˆ·çš„æ‘¸é±¼æŒ‡åŒ—
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kanyuanma/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    çœ‹æºç æ‰æ‡‚
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../relax/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    é—²èŠ
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../trip/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    æ—…è¡Œ
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    æ ‡ç­¾
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../waline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ç•™è¨€æ¿
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../link/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    æœ‹å‹
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../blog/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    åšå®¢
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../about/geren/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    å…³äº
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://wcowin.work/Mkdocs-Wcowin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mkdocsä¸­æ–‡æ•™ç¨‹
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.travellings.cn/go.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    å¼€å¾€
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      åŸºæœ¬åŸç†
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      æˆ‘åœ¨åŸä½œè€…åŸºç¡€ä¸Šåšçš„ä¼˜åŒ–ç‰ˆ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      æ•ˆæœ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ing" class="md-nav__link">
    <span class="md-ellipsis">
      æŒç»­ä¼˜åŒ–ing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      å‚è€ƒæ–‡çŒ®
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags" >
    
      
      
      
        <a href="../../../tag/#tag:æˆ‘çš„ä½œå“" class="md-tag">æˆ‘çš„ä½œå“</a>
      
    
  </nav>


  
  


<h1 id="_1">äººè„¸è¯†åˆ«ç³»ç»Ÿ<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<div class="admonition info">
<p class="admonition-title">ğŸ’¾ AIæ™ºèƒ½æ‘˜è¦ (GLM-4)</p>
<p>æœ¬æ–‡ä»‹ç»äº†ä¸€ä¸ªåŸºäº300è¡ŒPythonä»£ç å®ç°çš„äººè„¸è¯†åˆ«ç³»ç»Ÿï¼Œé‡‡ç”¨dlibåº“å’Œæ·±åº¦å­¦ä¹ æ¨¡å‹æå–äººè„¸ç‰¹å¾ï¼Œæ”¯æŒå®æ—¶æ£€æµ‹ã€è¯†åˆ«å’Œç»“æœæ˜¾ç¤ºã€‚ç³»ç»Ÿç»è¿‡ä¼˜åŒ–åï¼Œè¯†åˆ«ç²¾åº¦æ˜¾è‘—æé«˜ï¼Œæ”¯æŒå¤šäººè„¸è¯†åˆ«ï¼Œå¹¶å…·å¤‡å¤šç§åŠŸèƒ½ã€‚</p>
</div>
<div class="admonition tip">
<p class="admonition-title">ğŸ“– é˜…è¯»ä¿¡æ¯</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"/></svg></span>é˜…è¯»æ—¶é—´ï¼š<strong>5</strong> åˆ†é’Ÿ | <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"/></svg></span>ä¸­æ–‡å­—ç¬¦ï¼š<strong>1858</strong> | <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M360.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m64.6 136.1c-12.5 12.5-12.5 32.8 0 45.3l73.4 73.4-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3l-96-96c-12.5-12.5-32.8-12.5-45.3 0zm-274.7 0c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l73.3-73.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg></span>æœ‰æ•ˆä»£ç è¡Œæ•°ï¼š<strong>725</strong></p>
</div>
<p><strong>åŸæ–‡ï¼š</strong></p>
<blockquote>
<p>Bilibili:  <a href="https://www.bilibili.com/video/BV1ZZ4y1S76N/" target="_blank">ç”¨300è¡Œä»£ç å®ç°äººè„¸è¯†åˆ«ç³»ç»Ÿ_å“”å“©å“”å“©_bilibili</a>    </p>
<p>CSDNåšå®¢ï¼š<a href="https://blog.csdn.net/ECHOSON/article/details/122404926" target="_blank">ç”¨300è¡ŒPythonä»£ç å®ç°ä¸€ä¸ªäººè„¸è¯†åˆ«ç³»ç»Ÿ_dejahuçš„åšå®¢-CSDNåšå®¢</a></p>
</blockquote>
<h2 id="_2">åŸºæœ¬åŸç†<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>æ•°æ®æ”¶é›†ä¸é¢„å¤„ç†:<br />
é¦–å…ˆï¼Œä¸»è¦æ˜¯å€ŸåŠ©dlibåº“ï¼Œç³»ç»Ÿéœ€è¦æ”¶é›†ç”¨äºäººè„¸è¯†åˆ«çš„æ•°æ®ã€‚è¿™äº›æ•°æ®åŒ…æ‹¬å·²çŸ¥èº«ä»½çš„äººè„¸å›¾åƒï¼Œé€šå¸¸æ˜¯ç³»ç»Ÿçš„è®­ç»ƒæ•°æ®é›†ã€‚è¿™äº›å›¾åƒå°†ç”¨äºåˆ›å»ºäººè„¸ç‰¹å¾å‘é‡ä»¥åŠåç»­çš„äººè„¸åŒ¹é…ã€‚åœ¨æ”¶é›†æ•°æ®åï¼Œå¯¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å¢å¼ºå›¾åƒè´¨é‡ã€è°ƒæ•´å¤§å°å’Œå½’ä¸€åŒ–ç­‰æ“ä½œï¼Œä»¥ä¾¿è¿›è¡Œæ›´å‡†ç¡®çš„è¯†åˆ«ã€‚</p>
<p>äººè„¸ç‰¹å¾æå–:<br />
å¯¹äºæ¯ä¸ªäººè„¸å›¾åƒï¼Œç³»ç»Ÿä½¿ç”¨äººè„¸è¯†åˆ«æ¨¡å‹ï¼ˆé€šå¸¸æ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼‰æ¥æå–äººè„¸çš„ç‰¹å¾å‘é‡ã€‚è¿™äº›ç‰¹å¾å‘é‡æ˜¯å¯¹äººè„¸çš„ç‹¬ç‰¹è¡¨ç¤ºï¼Œç”¨äºåç»­çš„æ¯”å¯¹å’ŒåŒ¹é…ã€‚</p>
<p>äººè„¸è¯†åˆ«æ¨¡å‹:<br />
é€šå¸¸ï¼Œç³»ç»Ÿä½¿ç”¨å·²ç»è®­ç»ƒå¥½çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œä¾‹å¦‚åŸºäºå·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰çš„æ¨¡å‹æ¥è¿›è¡Œäººè„¸ç‰¹å¾æå–ã€‚è¿™äº›æ¨¡å‹åœ¨è®­ç»ƒé˜¶æ®µå­¦ä¼šäº†å¦‚ä½•ä»äººè„¸å›¾åƒä¸­æå–æœ‰ç”¨çš„ç‰¹å¾ã€‚</p>
<p>å®æ—¶æ£€æµ‹ä¸è¯†åˆ«:<br />
åœ¨å®æ—¶æ£€æµ‹è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿæ•æ‰è§†é¢‘æµæˆ–å›¾åƒå¸§ï¼Œå¹¶ä½¿ç”¨äººè„¸æ£€æµ‹ç®—æ³•ï¼ˆä¾‹å¦‚Haarçº§è”åˆ†ç±»å™¨æˆ–æ›´é«˜çº§çš„äººè„¸æ£€æµ‹å™¨ï¼‰æ¥æ£€æµ‹å›¾åƒä¸­çš„äººè„¸ä½ç½®ã€‚ä¸€æ—¦æ£€æµ‹åˆ°äººè„¸ï¼Œç³»ç»Ÿä¼šæå–è¯¥äººè„¸çš„ç‰¹å¾å‘é‡ã€‚</p>
<p>äººè„¸åŒ¹é…:<br />
æå–çš„äººè„¸ç‰¹å¾å‘é‡ä¸å·²çŸ¥çš„äººè„¸ç‰¹å¾å‘é‡è¿›è¡Œæ¯”å¯¹ã€‚è¿™å¯ä»¥é€šè¿‡è®¡ç®—ä¸¤ä¸ªç‰¹å¾å‘é‡ä¹‹é—´çš„ç›¸ä¼¼åº¦æ¥å®ç°ã€‚å¦‚æœç›¸ä¼¼åº¦è¶…è¿‡é¢„å®šçš„é˜ˆå€¼ï¼ˆä¾‹å¦‚0.5ï¼‰ï¼Œåˆ™è®¤ä¸ºæ˜¯åŒä¸€ä¸ªäººï¼Œå¦åˆ™è¢«æ ‡è®°ä¸ºâ€œæœªçŸ¥â€ã€‚</p>
<p>ç»“æœæ˜¾ç¤º:<br />
è¯†åˆ«ç»“æœä¼šæ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œé€šå¸¸ä¼šåœ¨äººè„¸å‘¨å›´ç»˜åˆ¶è¾¹ç•Œæ¡†ï¼Œå¹¶æ˜¾ç¤ºäººåæˆ–"Unknown"ï¼Œè¡¨ç¤ºæœªçŸ¥èº«ä»½ã€‚è¿™äº›ç»“æœä¼šå®æ—¶æ›´æ–°ï¼Œä»¥ä¾¿ç”¨æˆ·å¯ä»¥åœ¨è§†é¢‘æµæˆ–å›¾åƒä¸­çœ‹åˆ°è¯†åˆ«çš„äººè„¸ã€‚</p>
<p>ç”¨æˆ·äº¤äº’:<br />
ç³»ç»Ÿé€šå¸¸æä¾›ç”¨æˆ·äº¤äº’ç•Œé¢ï¼Œå…è®¸ç”¨æˆ·ä¸Šä¼ å›¾åƒã€å¼€å§‹æˆ–åœæ­¢å®æ—¶è¯†åˆ«ï¼Œå¹¶å¯èƒ½æä¾›ç®¡ç†å·²çŸ¥äººè„¸æ•°æ®çš„åŠŸèƒ½</p>
<p><strong>ç¤ºæ„å›¾</strong>
<img alt="image-20220109232309780" src="https://vehicle4cm.oss-cn-beijing.aliyuncs.com/typoraimgs/image-20220109232309780.png" />  </p>
<h2 id="_3">åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå‰å…ˆä¸‹è½½<a href="https://gitee.com/song-laogou/face_dlib_py37_42" target="_blank">æºç </a>åˆ°æœ¬åœ°ã€‚</p>
<p>éœ€è¦ä½¿ç”¨åˆ°python3.7çš„è™šæ‹Ÿç¯å¢ƒï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>face<span class="w"> </span><span class="nv">python</span><span class="o">==</span><span class="m">3</span>.7.3
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>conda<span class="w"> </span>activate<span class="w"> </span>face
</code></pre></div></td></tr></table></div></p>
<p>è·‘è½®å­ï¼ˆåŸä½œè€…<a href="https://mbd.pub/o/bread/ZJeYkpdt?next=pay&amp;author_name=è‚†åäºŒ&amp;author_avatar=https%3A%2F%2Fcdn.2zimu.com%2Fmbd_file_1679134971152.jpg">è¿™é‡Œ</a>æ˜¯è¦é’±çš„ï¼Œè½®å­ä¹Ÿæ˜¯å¿…è¦çš„ï¼Œå…¶å®ä¹Ÿæœ‰å…¶ä»–æ–¹æ³•å®ç°ï¼Œä½†æ˜¯<strong>æˆ‘ä¹Ÿä»˜è´¹äº†çš„</strong>ï¼Œä¹Ÿè¯·å°Šé‡çŸ¥è¯†ä»˜è´¹ï¼‰
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>pip<span class="w"> </span>install<span class="w"> </span>dlib-19.17.0-cp37-cp37m-win_amd64.whl
</code></pre></div></td></tr></table></div></p>
<p>å®‰è£…å¿…è¦çš„åº“
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</code></pre></div></td></tr></table></div></p>
<p>è¿è¡Œ<br />
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>python<span class="w"> </span>æ–‡ä»¶å.py
</code></pre></div></td></tr></table></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>å¦‚æœAnacondaéƒ½ä¸ä¼šï¼Œç§»æ­¥ï¼š<br />
<a href="https://blog.csdn.net/ECHOSON/article/details/117220445" target="_blank">å¦‚ä½•åœ¨pycharmä¸­é…ç½®anacondaçš„è™šæ‹Ÿç¯å¢ƒ</a> <br />
<a href="https://www.bilibili.com/video/BV15o4y127Rt/?vd_source=4c6908c51297ba49ec55863b71e0d24f" target="_blank">Pythonå­¦ä¹ ä¸­Anacondaå’ŒPycharmçš„æ­£ç¡®æ‰“å¼€æ–¹å¼</a></p>
</div>
<p>Pycharm/Vs codeä¹Ÿä¸ä¼šçš„è¯ï¼Œé‚£â€¦â€¦â€¦â€¦ä¸‹é¢çš„å†…å®¹å°±ä¸æ¨èé˜…è¯»äº†</p>
<h2 id="_4">æˆ‘åœ¨åŸä½œè€…åŸºç¡€ä¸Šåšçš„ä¼˜åŒ–ç‰ˆ<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>æé«˜äººè„¸è¯†åˆ«ç²¾åº¦çš„æ”¹è¿›ï¼š</p>
<ol>
<li>
<p><strong>å¢åŠ äººè„¸å›¾åƒçš„æ•°é‡å’Œå¤šæ ·æ€§</strong>ï¼šåœ¨æ•°æ®åº“ä¸­æ”¶é›†æ›´å¤šä¸åŒè§’åº¦ã€ä¸åŒå…‰ç…§æ¡ä»¶ä¸‹çš„äººè„¸å›¾åƒï¼Œä»¥ä¾¿ç®—æ³•å¯ä»¥æ›´å¥½åœ°é€‚åº”ä¸åŒæƒ…å†µã€‚</p>
</li>
<li>
<p><strong>ä½¿ç”¨æ›´é«˜çº§çš„äººè„¸è¯†åˆ«æ¨¡å‹</strong>ï¼šä½ ç›®å‰ä½¿ç”¨çš„æ˜¯åŸºäºdlibçš„äººè„¸è¯†åˆ«æ¨¡å‹ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æ›´é«˜çº§çš„æ¨¡å‹ï¼Œä¾‹å¦‚åŸºäºæ·±åº¦å­¦ä¹ çš„äººè„¸è¯†åˆ«æ¨¡å‹ï¼Œå¦‚FaceNetã€VGGFaceç­‰ã€‚è¿™äº›æ¨¡å‹åœ¨å¤§è§„æ¨¡äººè„¸è¯†åˆ«ä»»åŠ¡ä¸Šè¡¨ç°è‰¯å¥½ã€‚</p>
</li>
<li>
<p><strong>è¿›è¡Œäººè„¸å›¾åƒé¢„å¤„ç†</strong>ï¼šä½ å¯ä»¥åœ¨ä¸Šä¼ äººè„¸å›¾åƒæ—¶è¿›è¡Œä¸€äº›é¢„å¤„ç†ï¼Œä¾‹å¦‚ï¼š</p>
</li>
<li>å›¾åƒå¢å¼ºï¼šä½ å·²ç»åœ¨ä»£ç ä¸­å®ç°äº†å¯¹æ¯”åº¦å¢å¼ºï¼Œå¯ä»¥è€ƒè™‘æ·»åŠ å…¶ä»–å¢å¼ºæŠ€æœ¯ï¼Œå¦‚ç›´æ–¹å›¾å‡è¡¡åŒ–ï¼Œä»¥æ”¹å–„å›¾åƒè´¨é‡ã€‚</li>
<li>äººè„¸å¯¹é½ï¼šç¡®ä¿ä¸Šä¼ çš„äººè„¸å›¾åƒéƒ½ç»è¿‡å¯¹é½ï¼Œè¿™æœ‰åŠ©äºå‡å°‘å§¿æ€å’Œå…‰ç…§å·®å¼‚å¯¹è¯†åˆ«çš„å½±å“ã€‚</li>
</ol>
<p>ï¼ˆ4. <strong>è°ƒæ•´è¯†åˆ«é˜ˆå€¼</strong>ï¼šåœ¨ä»£ç ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡è°ƒæ•´äººè„¸åŒ¹é…çš„é˜ˆå€¼æ¥æ§åˆ¶è¯†åˆ«çš„ä¸¥æ ¼ç¨‹åº¦ã€‚è¾ƒé«˜çš„é˜ˆå€¼ä¼šæé«˜è¯†åˆ«çš„å‡†ç¡®æ€§ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¼è¯†åˆ«ã€‚è¾ƒä½çš„é˜ˆå€¼å¯èƒ½ä¼šå¢åŠ è¯¯è¯†åˆ«çš„é£é™©ã€‚</p>
<ol>
<li>
<p><strong>å¤„ç†å¤šä¸ªäººè„¸çš„æƒ…å†µ</strong>ï¼šå½“å‰çš„ä»£ç å¤„ç†å¤šä¸ªäººè„¸æ—¶ï¼Œåªè¿”å›æœ€ç›¸ä¼¼çš„ä¸€ä¸ªäººåï¼Œä½ å¯ä»¥è€ƒè™‘æ‰©å±•ä»£ç ä»¥è¯†åˆ«å’Œæ ‡è¯†å¤šä¸ªäººè„¸ã€‚</p>
</li>
<li>
<p><strong>å¼•å…¥äººè„¸è´¨é‡è¯„ä¼°</strong>ï¼šåœ¨è¿›è¡Œäººè„¸åŒ¹é…ä¹‹å‰ï¼Œå¯ä»¥ä½¿ç”¨äººè„¸è´¨é‡è¯„ä¼°å·¥å…·æ¥è¯„ä¼°å›¾åƒä¸­äººè„¸çš„è´¨é‡ï¼Œç„¶åé€‰æ‹©æ€§åœ°å¤„ç†è´¨é‡è¾ƒé«˜çš„äººè„¸ï¼Œä»¥æé«˜å‡†ç¡®æ€§ã€‚</p>
</li>
<li>
<p><strong>åœ¨çº¿å­¦ä¹ å’Œæ›´æ–°</strong>ï¼šå…è®¸ç”¨æˆ·æ ¹æ®æ–°ä¸Šä¼ çš„äººè„¸å›¾åƒä¸æ–­æ›´æ–°äººè„¸æ•°æ®åº“ï¼Œä»¥ä¸æ–­æ”¹è¿›æ¨¡å‹çš„æ€§èƒ½ã€‚</p>
</li>
<li>
<p><strong>å¼‚å¸¸å¤„ç†</strong>ï¼šåœ¨äººè„¸æ£€æµ‹å’Œè¯†åˆ«ä¸­ï¼Œæ·»åŠ å¼‚å¸¸å¤„ç†ï¼Œä»¥åº”å¯¹æ£€æµ‹ä¸åˆ°äººè„¸æˆ–è¯†åˆ«å¤±è´¥çš„æƒ…å†µï¼Œå¹¶æä¾›ç”¨æˆ·å‹å¥½çš„åé¦ˆã€‚</p>
</li>
<li>
<p><strong>è€ƒè™‘éšç§å’Œå®‰å…¨æ€§</strong>ï¼šç¡®ä¿ä½ çš„äººè„¸è¯†åˆ«ç³»ç»Ÿéµå®ˆéšç§æ³•è§„ï¼Œå¹¶é‡‡å–é€‚å½“çš„å®‰å…¨æªæ–½ï¼Œä»¥é˜²æ­¢æ»¥ç”¨å’Œæ•°æ®æ³„æ¼ã€‚</p>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šå¯¹äºå®æ—¶äººè„¸è¯†åˆ«ï¼Œä¼˜åŒ–ä»£ç ä»¥æé«˜å¤„ç†é€Ÿåº¦ï¼Œä»¥ä¾¿æ›´å¿«åœ°å“åº”ç”¨æˆ·çš„è¯·æ±‚ã€‚ï¼‰</p>
</li>
</ol>
<p><strong>åé¢å‡ æ¡æš‚æœªå®ç°</strong>ï¼Œä½†æ˜¯ä¹Ÿå¢åŠ äº†100å¤šè¡Œä»£ç </p>
<p>ä»£ç å¦‚ä¸‹ï¼Œå·²åšæ³¨é‡Šï¼š
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">  1</a></span>
<span class="normal"><a href="#__codelineno-4-2">  2</a></span>
<span class="normal"><a href="#__codelineno-4-3">  3</a></span>
<span class="normal"><a href="#__codelineno-4-4">  4</a></span>
<span class="normal"><a href="#__codelineno-4-5">  5</a></span>
<span class="normal"><a href="#__codelineno-4-6">  6</a></span>
<span class="normal"><a href="#__codelineno-4-7">  7</a></span>
<span class="normal"><a href="#__codelineno-4-8">  8</a></span>
<span class="normal"><a href="#__codelineno-4-9">  9</a></span>
<span class="normal"><a href="#__codelineno-4-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-4-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-4-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-4-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-4-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-4-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-4-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-4-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-4-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-4-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-4-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-4-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-4-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-4-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-4-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-4-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-4-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-4-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-4-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-4-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-4-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-4-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-4-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-4-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-4-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-4-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-4-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-4-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-4-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-4-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-4-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-4-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-4-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-4-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-4-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-4-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-4-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-4-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-4-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-4-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-4-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-4-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-4-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-4-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-4-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-4-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-4-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-4-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-4-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-4-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-4-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-4-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-4-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-4-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-4-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-4-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-4-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-4-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-4-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-4-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-4-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-4-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-4-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-4-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-4-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-4-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-4-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-4-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-4-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-4-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-4-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-4-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-4-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-4-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-4-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-4-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-4-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-4-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-4-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-4-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-4-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-4-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-4-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-4-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-4-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-4-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-4-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-4-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-4-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-4-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-4-100">100</a></span>
<span class="normal"><a href="#__codelineno-4-101">101</a></span>
<span class="normal"><a href="#__codelineno-4-102">102</a></span>
<span class="normal"><a href="#__codelineno-4-103">103</a></span>
<span class="normal"><a href="#__codelineno-4-104">104</a></span>
<span class="normal"><a href="#__codelineno-4-105">105</a></span>
<span class="normal"><a href="#__codelineno-4-106">106</a></span>
<span class="normal"><a href="#__codelineno-4-107">107</a></span>
<span class="normal"><a href="#__codelineno-4-108">108</a></span>
<span class="normal"><a href="#__codelineno-4-109">109</a></span>
<span class="normal"><a href="#__codelineno-4-110">110</a></span>
<span class="normal"><a href="#__codelineno-4-111">111</a></span>
<span class="normal"><a href="#__codelineno-4-112">112</a></span>
<span class="normal"><a href="#__codelineno-4-113">113</a></span>
<span class="normal"><a href="#__codelineno-4-114">114</a></span>
<span class="normal"><a href="#__codelineno-4-115">115</a></span>
<span class="normal"><a href="#__codelineno-4-116">116</a></span>
<span class="normal"><a href="#__codelineno-4-117">117</a></span>
<span class="normal"><a href="#__codelineno-4-118">118</a></span>
<span class="normal"><a href="#__codelineno-4-119">119</a></span>
<span class="normal"><a href="#__codelineno-4-120">120</a></span>
<span class="normal"><a href="#__codelineno-4-121">121</a></span>
<span class="normal"><a href="#__codelineno-4-122">122</a></span>
<span class="normal"><a href="#__codelineno-4-123">123</a></span>
<span class="normal"><a href="#__codelineno-4-124">124</a></span>
<span class="normal"><a href="#__codelineno-4-125">125</a></span>
<span class="normal"><a href="#__codelineno-4-126">126</a></span>
<span class="normal"><a href="#__codelineno-4-127">127</a></span>
<span class="normal"><a href="#__codelineno-4-128">128</a></span>
<span class="normal"><a href="#__codelineno-4-129">129</a></span>
<span class="normal"><a href="#__codelineno-4-130">130</a></span>
<span class="normal"><a href="#__codelineno-4-131">131</a></span>
<span class="normal"><a href="#__codelineno-4-132">132</a></span>
<span class="normal"><a href="#__codelineno-4-133">133</a></span>
<span class="normal"><a href="#__codelineno-4-134">134</a></span>
<span class="normal"><a href="#__codelineno-4-135">135</a></span>
<span class="normal"><a href="#__codelineno-4-136">136</a></span>
<span class="normal"><a href="#__codelineno-4-137">137</a></span>
<span class="normal"><a href="#__codelineno-4-138">138</a></span>
<span class="normal"><a href="#__codelineno-4-139">139</a></span>
<span class="normal"><a href="#__codelineno-4-140">140</a></span>
<span class="normal"><a href="#__codelineno-4-141">141</a></span>
<span class="normal"><a href="#__codelineno-4-142">142</a></span>
<span class="normal"><a href="#__codelineno-4-143">143</a></span>
<span class="normal"><a href="#__codelineno-4-144">144</a></span>
<span class="normal"><a href="#__codelineno-4-145">145</a></span>
<span class="normal"><a href="#__codelineno-4-146">146</a></span>
<span class="normal"><a href="#__codelineno-4-147">147</a></span>
<span class="normal"><a href="#__codelineno-4-148">148</a></span>
<span class="normal"><a href="#__codelineno-4-149">149</a></span>
<span class="normal"><a href="#__codelineno-4-150">150</a></span>
<span class="normal"><a href="#__codelineno-4-151">151</a></span>
<span class="normal"><a href="#__codelineno-4-152">152</a></span>
<span class="normal"><a href="#__codelineno-4-153">153</a></span>
<span class="normal"><a href="#__codelineno-4-154">154</a></span>
<span class="normal"><a href="#__codelineno-4-155">155</a></span>
<span class="normal"><a href="#__codelineno-4-156">156</a></span>
<span class="normal"><a href="#__codelineno-4-157">157</a></span>
<span class="normal"><a href="#__codelineno-4-158">158</a></span>
<span class="normal"><a href="#__codelineno-4-159">159</a></span>
<span class="normal"><a href="#__codelineno-4-160">160</a></span>
<span class="normal"><a href="#__codelineno-4-161">161</a></span>
<span class="normal"><a href="#__codelineno-4-162">162</a></span>
<span class="normal"><a href="#__codelineno-4-163">163</a></span>
<span class="normal"><a href="#__codelineno-4-164">164</a></span>
<span class="normal"><a href="#__codelineno-4-165">165</a></span>
<span class="normal"><a href="#__codelineno-4-166">166</a></span>
<span class="normal"><a href="#__codelineno-4-167">167</a></span>
<span class="normal"><a href="#__codelineno-4-168">168</a></span>
<span class="normal"><a href="#__codelineno-4-169">169</a></span>
<span class="normal"><a href="#__codelineno-4-170">170</a></span>
<span class="normal"><a href="#__codelineno-4-171">171</a></span>
<span class="normal"><a href="#__codelineno-4-172">172</a></span>
<span class="normal"><a href="#__codelineno-4-173">173</a></span>
<span class="normal"><a href="#__codelineno-4-174">174</a></span>
<span class="normal"><a href="#__codelineno-4-175">175</a></span>
<span class="normal"><a href="#__codelineno-4-176">176</a></span>
<span class="normal"><a href="#__codelineno-4-177">177</a></span>
<span class="normal"><a href="#__codelineno-4-178">178</a></span>
<span class="normal"><a href="#__codelineno-4-179">179</a></span>
<span class="normal"><a href="#__codelineno-4-180">180</a></span>
<span class="normal"><a href="#__codelineno-4-181">181</a></span>
<span class="normal"><a href="#__codelineno-4-182">182</a></span>
<span class="normal"><a href="#__codelineno-4-183">183</a></span>
<span class="normal"><a href="#__codelineno-4-184">184</a></span>
<span class="normal"><a href="#__codelineno-4-185">185</a></span>
<span class="normal"><a href="#__codelineno-4-186">186</a></span>
<span class="normal"><a href="#__codelineno-4-187">187</a></span>
<span class="normal"><a href="#__codelineno-4-188">188</a></span>
<span class="normal"><a href="#__codelineno-4-189">189</a></span>
<span class="normal"><a href="#__codelineno-4-190">190</a></span>
<span class="normal"><a href="#__codelineno-4-191">191</a></span>
<span class="normal"><a href="#__codelineno-4-192">192</a></span>
<span class="normal"><a href="#__codelineno-4-193">193</a></span>
<span class="normal"><a href="#__codelineno-4-194">194</a></span>
<span class="normal"><a href="#__codelineno-4-195">195</a></span>
<span class="normal"><a href="#__codelineno-4-196">196</a></span>
<span class="normal"><a href="#__codelineno-4-197">197</a></span>
<span class="normal"><a href="#__codelineno-4-198">198</a></span>
<span class="normal"><a href="#__codelineno-4-199">199</a></span>
<span class="normal"><a href="#__codelineno-4-200">200</a></span>
<span class="normal"><a href="#__codelineno-4-201">201</a></span>
<span class="normal"><a href="#__codelineno-4-202">202</a></span>
<span class="normal"><a href="#__codelineno-4-203">203</a></span>
<span class="normal"><a href="#__codelineno-4-204">204</a></span>
<span class="normal"><a href="#__codelineno-4-205">205</a></span>
<span class="normal"><a href="#__codelineno-4-206">206</a></span>
<span class="normal"><a href="#__codelineno-4-207">207</a></span>
<span class="normal"><a href="#__codelineno-4-208">208</a></span>
<span class="normal"><a href="#__codelineno-4-209">209</a></span>
<span class="normal"><a href="#__codelineno-4-210">210</a></span>
<span class="normal"><a href="#__codelineno-4-211">211</a></span>
<span class="normal"><a href="#__codelineno-4-212">212</a></span>
<span class="normal"><a href="#__codelineno-4-213">213</a></span>
<span class="normal"><a href="#__codelineno-4-214">214</a></span>
<span class="normal"><a href="#__codelineno-4-215">215</a></span>
<span class="normal"><a href="#__codelineno-4-216">216</a></span>
<span class="normal"><a href="#__codelineno-4-217">217</a></span>
<span class="normal"><a href="#__codelineno-4-218">218</a></span>
<span class="normal"><a href="#__codelineno-4-219">219</a></span>
<span class="normal"><a href="#__codelineno-4-220">220</a></span>
<span class="normal"><a href="#__codelineno-4-221">221</a></span>
<span class="normal"><a href="#__codelineno-4-222">222</a></span>
<span class="normal"><a href="#__codelineno-4-223">223</a></span>
<span class="normal"><a href="#__codelineno-4-224">224</a></span>
<span class="normal"><a href="#__codelineno-4-225">225</a></span>
<span class="normal"><a href="#__codelineno-4-226">226</a></span>
<span class="normal"><a href="#__codelineno-4-227">227</a></span>
<span class="normal"><a href="#__codelineno-4-228">228</a></span>
<span class="normal"><a href="#__codelineno-4-229">229</a></span>
<span class="normal"><a href="#__codelineno-4-230">230</a></span>
<span class="normal"><a href="#__codelineno-4-231">231</a></span>
<span class="normal"><a href="#__codelineno-4-232">232</a></span>
<span class="normal"><a href="#__codelineno-4-233">233</a></span>
<span class="normal"><a href="#__codelineno-4-234">234</a></span>
<span class="normal"><a href="#__codelineno-4-235">235</a></span>
<span class="normal"><a href="#__codelineno-4-236">236</a></span>
<span class="normal"><a href="#__codelineno-4-237">237</a></span>
<span class="normal"><a href="#__codelineno-4-238">238</a></span>
<span class="normal"><a href="#__codelineno-4-239">239</a></span>
<span class="normal"><a href="#__codelineno-4-240">240</a></span>
<span class="normal"><a href="#__codelineno-4-241">241</a></span>
<span class="normal"><a href="#__codelineno-4-242">242</a></span>
<span class="normal"><a href="#__codelineno-4-243">243</a></span>
<span class="normal"><a href="#__codelineno-4-244">244</a></span>
<span class="normal"><a href="#__codelineno-4-245">245</a></span>
<span class="normal"><a href="#__codelineno-4-246">246</a></span>
<span class="normal"><a href="#__codelineno-4-247">247</a></span>
<span class="normal"><a href="#__codelineno-4-248">248</a></span>
<span class="normal"><a href="#__codelineno-4-249">249</a></span>
<span class="normal"><a href="#__codelineno-4-250">250</a></span>
<span class="normal"><a href="#__codelineno-4-251">251</a></span>
<span class="normal"><a href="#__codelineno-4-252">252</a></span>
<span class="normal"><a href="#__codelineno-4-253">253</a></span>
<span class="normal"><a href="#__codelineno-4-254">254</a></span>
<span class="normal"><a href="#__codelineno-4-255">255</a></span>
<span class="normal"><a href="#__codelineno-4-256">256</a></span>
<span class="normal"><a href="#__codelineno-4-257">257</a></span>
<span class="normal"><a href="#__codelineno-4-258">258</a></span>
<span class="normal"><a href="#__codelineno-4-259">259</a></span>
<span class="normal"><a href="#__codelineno-4-260">260</a></span>
<span class="normal"><a href="#__codelineno-4-261">261</a></span>
<span class="normal"><a href="#__codelineno-4-262">262</a></span>
<span class="normal"><a href="#__codelineno-4-263">263</a></span>
<span class="normal"><a href="#__codelineno-4-264">264</a></span>
<span class="normal"><a href="#__codelineno-4-265">265</a></span>
<span class="normal"><a href="#__codelineno-4-266">266</a></span>
<span class="normal"><a href="#__codelineno-4-267">267</a></span>
<span class="normal"><a href="#__codelineno-4-268">268</a></span>
<span class="normal"><a href="#__codelineno-4-269">269</a></span>
<span class="normal"><a href="#__codelineno-4-270">270</a></span>
<span class="normal"><a href="#__codelineno-4-271">271</a></span>
<span class="normal"><a href="#__codelineno-4-272">272</a></span>
<span class="normal"><a href="#__codelineno-4-273">273</a></span>
<span class="normal"><a href="#__codelineno-4-274">274</a></span>
<span class="normal"><a href="#__codelineno-4-275">275</a></span>
<span class="normal"><a href="#__codelineno-4-276">276</a></span>
<span class="normal"><a href="#__codelineno-4-277">277</a></span>
<span class="normal"><a href="#__codelineno-4-278">278</a></span>
<span class="normal"><a href="#__codelineno-4-279">279</a></span>
<span class="normal"><a href="#__codelineno-4-280">280</a></span>
<span class="normal"><a href="#__codelineno-4-281">281</a></span>
<span class="normal"><a href="#__codelineno-4-282">282</a></span>
<span class="normal"><a href="#__codelineno-4-283">283</a></span>
<span class="normal"><a href="#__codelineno-4-284">284</a></span>
<span class="normal"><a href="#__codelineno-4-285">285</a></span>
<span class="normal"><a href="#__codelineno-4-286">286</a></span>
<span class="normal"><a href="#__codelineno-4-287">287</a></span>
<span class="normal"><a href="#__codelineno-4-288">288</a></span>
<span class="normal"><a href="#__codelineno-4-289">289</a></span>
<span class="normal"><a href="#__codelineno-4-290">290</a></span>
<span class="normal"><a href="#__codelineno-4-291">291</a></span>
<span class="normal"><a href="#__codelineno-4-292">292</a></span>
<span class="normal"><a href="#__codelineno-4-293">293</a></span>
<span class="normal"><a href="#__codelineno-4-294">294</a></span>
<span class="normal"><a href="#__codelineno-4-295">295</a></span>
<span class="normal"><a href="#__codelineno-4-296">296</a></span>
<span class="normal"><a href="#__codelineno-4-297">297</a></span>
<span class="normal"><a href="#__codelineno-4-298">298</a></span>
<span class="normal"><a href="#__codelineno-4-299">299</a></span>
<span class="normal"><a href="#__codelineno-4-300">300</a></span>
<span class="normal"><a href="#__codelineno-4-301">301</a></span>
<span class="normal"><a href="#__codelineno-4-302">302</a></span>
<span class="normal"><a href="#__codelineno-4-303">303</a></span>
<span class="normal"><a href="#__codelineno-4-304">304</a></span>
<span class="normal"><a href="#__codelineno-4-305">305</a></span>
<span class="normal"><a href="#__codelineno-4-306">306</a></span>
<span class="normal"><a href="#__codelineno-4-307">307</a></span>
<span class="normal"><a href="#__codelineno-4-308">308</a></span>
<span class="normal"><a href="#__codelineno-4-309">309</a></span>
<span class="normal"><a href="#__codelineno-4-310">310</a></span>
<span class="normal"><a href="#__codelineno-4-311">311</a></span>
<span class="normal"><a href="#__codelineno-4-312">312</a></span>
<span class="normal"><a href="#__codelineno-4-313">313</a></span>
<span class="normal"><a href="#__codelineno-4-314">314</a></span>
<span class="normal"><a href="#__codelineno-4-315">315</a></span>
<span class="normal"><a href="#__codelineno-4-316">316</a></span>
<span class="normal"><a href="#__codelineno-4-317">317</a></span>
<span class="normal"><a href="#__codelineno-4-318">318</a></span>
<span class="normal"><a href="#__codelineno-4-319">319</a></span>
<span class="normal"><a href="#__codelineno-4-320">320</a></span>
<span class="normal"><a href="#__codelineno-4-321">321</a></span>
<span class="normal"><a href="#__codelineno-4-322">322</a></span>
<span class="normal"><a href="#__codelineno-4-323">323</a></span>
<span class="normal"><a href="#__codelineno-4-324">324</a></span>
<span class="normal"><a href="#__codelineno-4-325">325</a></span>
<span class="normal"><a href="#__codelineno-4-326">326</a></span>
<span class="normal"><a href="#__codelineno-4-327">327</a></span>
<span class="normal"><a href="#__codelineno-4-328">328</a></span>
<span class="normal"><a href="#__codelineno-4-329">329</a></span>
<span class="normal"><a href="#__codelineno-4-330">330</a></span>
<span class="normal"><a href="#__codelineno-4-331">331</a></span>
<span class="normal"><a href="#__codelineno-4-332">332</a></span>
<span class="normal"><a href="#__codelineno-4-333">333</a></span>
<span class="normal"><a href="#__codelineno-4-334">334</a></span>
<span class="normal"><a href="#__codelineno-4-335">335</a></span>
<span class="normal"><a href="#__codelineno-4-336">336</a></span>
<span class="normal"><a href="#__codelineno-4-337">337</a></span>
<span class="normal"><a href="#__codelineno-4-338">338</a></span>
<span class="normal"><a href="#__codelineno-4-339">339</a></span>
<span class="normal"><a href="#__codelineno-4-340">340</a></span>
<span class="normal"><a href="#__codelineno-4-341">341</a></span>
<span class="normal"><a href="#__codelineno-4-342">342</a></span>
<span class="normal"><a href="#__codelineno-4-343">343</a></span>
<span class="normal"><a href="#__codelineno-4-344">344</a></span>
<span class="normal"><a href="#__codelineno-4-345">345</a></span>
<span class="normal"><a href="#__codelineno-4-346">346</a></span>
<span class="normal"><a href="#__codelineno-4-347">347</a></span>
<span class="normal"><a href="#__codelineno-4-348">348</a></span>
<span class="normal"><a href="#__codelineno-4-349">349</a></span>
<span class="normal"><a href="#__codelineno-4-350">350</a></span>
<span class="normal"><a href="#__codelineno-4-351">351</a></span>
<span class="normal"><a href="#__codelineno-4-352">352</a></span>
<span class="normal"><a href="#__codelineno-4-353">353</a></span>
<span class="normal"><a href="#__codelineno-4-354">354</a></span>
<span class="normal"><a href="#__codelineno-4-355">355</a></span>
<span class="normal"><a href="#__codelineno-4-356">356</a></span>
<span class="normal"><a href="#__codelineno-4-357">357</a></span>
<span class="normal"><a href="#__codelineno-4-358">358</a></span>
<span class="normal"><a href="#__codelineno-4-359">359</a></span>
<span class="normal"><a href="#__codelineno-4-360">360</a></span>
<span class="normal"><a href="#__codelineno-4-361">361</a></span>
<span class="normal"><a href="#__codelineno-4-362">362</a></span>
<span class="normal"><a href="#__codelineno-4-363">363</a></span>
<span class="normal"><a href="#__codelineno-4-364">364</a></span>
<span class="normal"><a href="#__codelineno-4-365">365</a></span>
<span class="normal"><a href="#__codelineno-4-366">366</a></span>
<span class="normal"><a href="#__codelineno-4-367">367</a></span>
<span class="normal"><a href="#__codelineno-4-368">368</a></span>
<span class="normal"><a href="#__codelineno-4-369">369</a></span>
<span class="normal"><a href="#__codelineno-4-370">370</a></span>
<span class="normal"><a href="#__codelineno-4-371">371</a></span>
<span class="normal"><a href="#__codelineno-4-372">372</a></span>
<span class="normal"><a href="#__codelineno-4-373">373</a></span>
<span class="normal"><a href="#__codelineno-4-374">374</a></span>
<span class="normal"><a href="#__codelineno-4-375">375</a></span>
<span class="normal"><a href="#__codelineno-4-376">376</a></span>
<span class="normal"><a href="#__codelineno-4-377">377</a></span>
<span class="normal"><a href="#__codelineno-4-378">378</a></span>
<span class="normal"><a href="#__codelineno-4-379">379</a></span>
<span class="normal"><a href="#__codelineno-4-380">380</a></span>
<span class="normal"><a href="#__codelineno-4-381">381</a></span>
<span class="normal"><a href="#__codelineno-4-382">382</a></span>
<span class="normal"><a href="#__codelineno-4-383">383</a></span>
<span class="normal"><a href="#__codelineno-4-384">384</a></span>
<span class="normal"><a href="#__codelineno-4-385">385</a></span>
<span class="normal"><a href="#__codelineno-4-386">386</a></span>
<span class="normal"><a href="#__codelineno-4-387">387</a></span>
<span class="normal"><a href="#__codelineno-4-388">388</a></span>
<span class="normal"><a href="#__codelineno-4-389">389</a></span>
<span class="normal"><a href="#__codelineno-4-390">390</a></span>
<span class="normal"><a href="#__codelineno-4-391">391</a></span>
<span class="normal"><a href="#__codelineno-4-392">392</a></span>
<span class="normal"><a href="#__codelineno-4-393">393</a></span>
<span class="normal"><a href="#__codelineno-4-394">394</a></span>
<span class="normal"><a href="#__codelineno-4-395">395</a></span>
<span class="normal"><a href="#__codelineno-4-396">396</a></span>
<span class="normal"><a href="#__codelineno-4-397">397</a></span>
<span class="normal"><a href="#__codelineno-4-398">398</a></span>
<span class="normal"><a href="#__codelineno-4-399">399</a></span>
<span class="normal"><a href="#__codelineno-4-400">400</a></span>
<span class="normal"><a href="#__codelineno-4-401">401</a></span>
<span class="normal"><a href="#__codelineno-4-402">402</a></span>
<span class="normal"><a href="#__codelineno-4-403">403</a></span>
<span class="normal"><a href="#__codelineno-4-404">404</a></span>
<span class="normal"><a href="#__codelineno-4-405">405</a></span>
<span class="normal"><a href="#__codelineno-4-406">406</a></span>
<span class="normal"><a href="#__codelineno-4-407">407</a></span>
<span class="normal"><a href="#__codelineno-4-408">408</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtCore</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFileDialog</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QDockWidget</span><span class="p">,</span> <span class="n">QListWidget</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtGui</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">face_recognition</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">face_recognition_models</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="kn">import</span><span class="w"> </span><span class="nn">locale</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">LC_ALL</span><span class="p">,</span> <span class="s1">&#39;zh_CN.UTF-8&#39;</span><span class="p">)</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="k">def</span><span class="w"> </span><span class="nf">enhance_image_quality</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>    <span class="c1"># å¢å¼ºå¯¹æ¯”åº¦</span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a>    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.5</span>  <span class="c1"># è°ƒæ•´å¯¹æ¯”åº¦çš„å‚æ•°</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a>    <span class="n">beta</span> <span class="o">=</span> <span class="mi">30</span>    <span class="c1"># è°ƒæ•´äº®åº¦çš„å‚æ•°</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a>    <span class="n">enhanced_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">convertScaleAbs</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">)</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a>    <span class="k">return</span> <span class="n">enhanced_image</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a><span class="c1"># çª—å£ä¸»ç±»</span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="k">class</span><span class="w"> </span><span class="nc">MainWindow</span><span class="p">(</span><span class="n">QTabWidget</span><span class="p">):</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a>    <span class="c1"># åŸºæœ¬é…ç½®ä¸åŠ¨ï¼Œç„¶ååªåŠ¨ç¬¬ä¸‰ä¸ªç•Œé¢</span>
<a id="__codelineno-4-28" name="__codelineno-4-28"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a>        <span class="c1"># åˆå§‹åŒ–è®¾ç½®</span>
<a id="__codelineno-4-30" name="__codelineno-4-30"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-4-31" name="__codelineno-4-31"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;å®æ—¶äººè„¸è¯†åˆ«ç³»ç»Ÿ&#39;</span><span class="p">)</span>
<a id="__codelineno-4-32" name="__codelineno-4-32"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">1100</span><span class="p">,</span> <span class="mi">650</span><span class="p">)</span>
<a id="__codelineno-4-33" name="__codelineno-4-33"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="s2">&quot;UI_images/faxian.png&quot;</span><span class="p">))</span>
<a id="__codelineno-4-34" name="__codelineno-4-34"></a>        <span class="c1"># è¦ä¸Šä¼ çš„å›¾ç‰‡è·¯å¾„</span>
<a id="__codelineno-4-35" name="__codelineno-4-35"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-4-36" name="__codelineno-4-36"></a>        <span class="c1"># è¦æ£€æµ‹çš„å›¾ç‰‡åç§°</span>
<a id="__codelineno-4-37" name="__codelineno-4-37"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_fname</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-4-38" name="__codelineno-4-38"></a>        <span class="c1"># è¦æ£€æµ‹çš„è§†é¢‘åç§°</span>
<a id="__codelineno-4-39" name="__codelineno-4-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-4-40" name="__codelineno-4-40"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-4-41" name="__codelineno-4-41"></a>        <span class="c1"># åˆå§‹åŒ–ä¸­æ­¢äº‹ä»¶</span>
<a id="__codelineno-4-42" name="__codelineno-4-42"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
<a id="__codelineno-4-43" name="__codelineno-4-43"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-4-44" name="__codelineno-4-44"></a>        <span class="c1"># åˆå§‹åŒ–äººè„¸å‘é‡</span>
<a id="__codelineno-4-45" name="__codelineno-4-45"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">known_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">known_encodings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initFaces</span><span class="p">()</span>
<a id="__codelineno-4-46" name="__codelineno-4-46"></a>        <span class="c1"># åŠ è½½lbpæ£€æµ‹å™¨</span>
<a id="__codelineno-4-47" name="__codelineno-4-47"></a>        <span class="c1"># åŠ è½½äººè„¸è¯†åˆ«æ¨¡å‹</span>
<a id="__codelineno-4-48" name="__codelineno-4-48"></a>        <span class="c1"># åˆå§‹åŒ–ç•Œé¢</span>
<a id="__codelineno-4-49" name="__codelineno-4-49"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>
<a id="__codelineno-4-50" name="__codelineno-4-50"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-4-51" name="__codelineno-4-51"></a>
<a id="__codelineno-4-52" name="__codelineno-4-52"></a>
<a id="__codelineno-4-53" name="__codelineno-4-53"></a>
<a id="__codelineno-4-54" name="__codelineno-4-54"></a>
<a id="__codelineno-4-55" name="__codelineno-4-55"></a>    <span class="c1"># åˆå§‹åŒ–æ•°æ®åº“çš„äººè„¸</span>
<a id="__codelineno-4-56" name="__codelineno-4-56"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">initFaces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-57" name="__codelineno-4-57"></a>        <span class="c1"># å­˜å‚¨çŸ¥é“äººååˆ—è¡¨</span>
<a id="__codelineno-4-58" name="__codelineno-4-58"></a>        <span class="n">known_names</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-4-59" name="__codelineno-4-59"></a>        <span class="c1"># å­˜å‚¨çŸ¥é“çš„ç‰¹å¾å€¼</span>
<a id="__codelineno-4-60" name="__codelineno-4-60"></a>        <span class="n">known_encodings</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-4-61" name="__codelineno-4-61"></a>        <span class="c1"># éå†å­˜å‚¨äººè„¸å›¾ç‰‡çš„æ–‡ä»¶å¤¹</span>
<a id="__codelineno-4-62" name="__codelineno-4-62"></a>        <span class="n">db_folder</span> <span class="o">=</span> <span class="s2">&quot;images/db_faces&quot;</span>
<a id="__codelineno-4-63" name="__codelineno-4-63"></a>        <span class="n">face_imgs</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">db_folder</span><span class="p">)</span>
<a id="__codelineno-4-64" name="__codelineno-4-64"></a>        <span class="c1"># åŠ è½½æ›´å¤æ‚çš„äººè„¸è¯†åˆ«æ¨¡å‹</span>
<a id="__codelineno-4-65" name="__codelineno-4-65"></a>        <span class="n">face_rec_model</span> <span class="o">=</span> <span class="s2">&quot;cnn&quot;</span>  <span class="c1"># ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œé€šå¸¸æ›´å‡†ç¡®</span>
<a id="__codelineno-4-66" name="__codelineno-4-66"></a>        <span class="c1"># éå†å›¾ç‰‡ï¼Œå°†äººè„¸å›¾ç‰‡è½¬åŒ–ä¸ºå‘é‡</span>
<a id="__codelineno-4-67" name="__codelineno-4-67"></a>        <span class="k">for</span> <span class="n">face_img</span> <span class="ow">in</span> <span class="n">face_imgs</span><span class="p">:</span>
<a id="__codelineno-4-68" name="__codelineno-4-68"></a>            <span class="n">face_img_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">db_folder</span><span class="p">,</span> <span class="n">face_img</span><span class="p">)</span>
<a id="__codelineno-4-69" name="__codelineno-4-69"></a>            <span class="n">face_name</span> <span class="o">=</span> <span class="n">face_img</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-4-70" name="__codelineno-4-70"></a>            <span class="n">load_image</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">load_image_file</span><span class="p">(</span><span class="n">face_img_path</span><span class="p">)</span>  <span class="c1"># åŠ è½½å›¾ç‰‡</span>
<a id="__codelineno-4-71" name="__codelineno-4-71"></a>            <span class="n">image_face_encoding</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_encodings</span><span class="p">(</span><span class="n">load_image</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">face_rec_model</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># è·å¾—128ç»´ç‰¹å¾å€¼</span>
<a id="__codelineno-4-72" name="__codelineno-4-72"></a>            <span class="n">known_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">face_name</span><span class="p">)</span>  <span class="c1"># æ·»åŠ åˆ°äººåçš„åˆ—è¡¨</span>
<a id="__codelineno-4-73" name="__codelineno-4-73"></a>            <span class="n">known_encodings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image_face_encoding</span><span class="p">)</span>  <span class="c1"># æ·»åŠ åˆ°å‘é‡çš„åˆ—è¡¨</span>
<a id="__codelineno-4-74" name="__codelineno-4-74"></a>        <span class="k">return</span> <span class="n">known_names</span><span class="p">,</span> <span class="n">known_encodings</span>
<a id="__codelineno-4-75" name="__codelineno-4-75"></a>
<a id="__codelineno-4-76" name="__codelineno-4-76"></a>    <span class="c1"># åœ¨ up_img å‡½æ•°ä¸­æ·»åŠ å›¾åƒé¢„å¤„ç†æ­¥éª¤</span>
<a id="__codelineno-4-77" name="__codelineno-4-77"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">up_img</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-78" name="__codelineno-4-78"></a>        <span class="c1"># æ‰“å¼€æ–‡ä»¶é€‰æ‹©æ¡†</span>
<a id="__codelineno-4-79" name="__codelineno-4-79"></a>        <span class="n">openfile_name</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;é€‰æ‹©æ–‡ä»¶&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Image files(*.jpg , *.png)&#39;</span><span class="p">)</span>
<a id="__codelineno-4-80" name="__codelineno-4-80"></a>        <span class="c1"># è·å–ä¸Šä¼ çš„æ–‡ä»¶åç§°</span>
<a id="__codelineno-4-81" name="__codelineno-4-81"></a>        <span class="n">img_name</span> <span class="o">=</span> <span class="n">openfile_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-4-82" name="__codelineno-4-82"></a>        <span class="k">if</span> <span class="n">img_name</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
<a id="__codelineno-4-83" name="__codelineno-4-83"></a>            <span class="k">pass</span>
<a id="__codelineno-4-84" name="__codelineno-4-84"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-85" name="__codelineno-4-85"></a>            <span class="c1"># ä¸Šä¼ ä¹‹åæ˜¾ç¤ºå¹¶åšå½’ä¸€åŒ–å¤„ç†</span>
<a id="__codelineno-4-86" name="__codelineno-4-86"></a>            <span class="n">src_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_name</span><span class="p">)</span>
<a id="__codelineno-4-87" name="__codelineno-4-87"></a>            <span class="n">src_img</span> <span class="o">=</span> <span class="n">enhance_image_quality</span><span class="p">(</span><span class="n">src_img</span><span class="p">)</span>  <span class="c1"># å¢å¼ºå›¾åƒè´¨é‡</span>
<a id="__codelineno-4-88" name="__codelineno-4-88"></a>            <span class="n">src_img_height</span> <span class="o">=</span> <span class="n">src_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-4-89" name="__codelineno-4-89"></a>            <span class="n">src_img_width</span> <span class="o">=</span> <span class="n">src_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-4-90" name="__codelineno-4-90"></a>            <span class="n">target_img_height</span> <span class="o">=</span> <span class="mi">400</span>
<a id="__codelineno-4-91" name="__codelineno-4-91"></a>            <span class="n">ratio</span> <span class="o">=</span> <span class="n">target_img_height</span> <span class="o">/</span> <span class="n">src_img_height</span>
<a id="__codelineno-4-92" name="__codelineno-4-92"></a>            <span class="n">target_img_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">src_img_width</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>
<a id="__codelineno-4-93" name="__codelineno-4-93"></a>            <span class="c1"># å°†å›¾ç‰‡ç»Ÿä¸€å¤„ç†åˆ°é«˜ä¸º400çš„å›¾ç‰‡ï¼Œæ–¹ä¾¿åœ¨ç•Œé¢ä¸Šæ˜¾ç¤º</span>
<a id="__codelineno-4-94" name="__codelineno-4-94"></a>            <span class="n">target_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">src_img</span><span class="p">,</span> <span class="p">(</span><span class="n">target_img_width</span><span class="p">,</span> <span class="n">target_img_height</span><span class="p">))</span>
<a id="__codelineno-4-95" name="__codelineno-4-95"></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span><span class="p">,</span> <span class="n">target_img</span><span class="p">)</span>
<a id="__codelineno-4-96" name="__codelineno-4-96"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span><span class="p">))</span>
<a id="__codelineno-4-97" name="__codelineno-4-97"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span> <span class="o">=</span> <span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span>
<a id="__codelineno-4-98" name="__codelineno-4-98"></a>
<a id="__codelineno-4-99" name="__codelineno-4-99"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open_local</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-100" name="__codelineno-4-100"></a>        <span class="c1"># é€‰æ‹©å½•åƒæ–‡ä»¶è¿›è¡Œè¯»å–</span>
<a id="__codelineno-4-101" name="__codelineno-4-101"></a>        <span class="n">mp4_filename</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-4-102" name="__codelineno-4-102"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">mp4_filename</span>
<a id="__codelineno-4-103" name="__codelineno-4-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-4-104" name="__codelineno-4-104"></a>
<a id="__codelineno-4-105" name="__codelineno-4-105"></a>        <span class="c1"># è®¾ç½®æ‘„åƒå¤´åˆ†è¾¨ç‡</span>
<a id="__codelineno-4-106" name="__codelineno-4-106"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_WIDTH</span><span class="p">,</span> <span class="mi">640</span><span class="p">)</span>
<a id="__codelineno-4-107" name="__codelineno-4-107"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_HEIGHT</span><span class="p">,</span> <span class="mi">480</span><span class="p">)</span>
<a id="__codelineno-4-108" name="__codelineno-4-108"></a>
<a id="__codelineno-4-109" name="__codelineno-4-109"></a>        <span class="n">th</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_video</span><span class="p">)</span>
<a id="__codelineno-4-110" name="__codelineno-4-110"></a>        <span class="n">th</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-4-111" name="__codelineno-4-111"></a>
<a id="__codelineno-4-112" name="__codelineno-4-112"></a>
<a id="__codelineno-4-113" name="__codelineno-4-113"></a>    <span class="c1"># åˆå§‹åŒ–ç•Œé¢</span>
<a id="__codelineno-4-114" name="__codelineno-4-114"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-115" name="__codelineno-4-115"></a>        <span class="c1"># è®¾ç½®å­—ä½“</span>
<a id="__codelineno-4-116" name="__codelineno-4-116"></a>        <span class="n">font_v</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;æ¥·ä½“&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-4-117" name="__codelineno-4-117"></a>        <span class="n">generally_font</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;æ¥·ä½“&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<a id="__codelineno-4-118" name="__codelineno-4-118"></a>        <span class="c1"># å›¾ç‰‡æ£€æµ‹</span>
<a id="__codelineno-4-119" name="__codelineno-4-119"></a>        <span class="n">img_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<a id="__codelineno-4-120" name="__codelineno-4-120"></a>        <span class="n">img_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<a id="__codelineno-4-121" name="__codelineno-4-121"></a>        <span class="n">img_f_title</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;ä¸Šä¼ äººè„¸å›¾åƒ&quot;</span><span class="p">)</span>  <span class="c1"># è®¾ç½®æ ‡é¢˜</span>
<a id="__codelineno-4-122" name="__codelineno-4-122"></a>        <span class="n">img_f_title</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>  <span class="c1"># è®¾ç½®æ ‡é¢˜ä½ç½®ä¸ºå±…ä¸­</span>
<a id="__codelineno-4-123" name="__codelineno-4-123"></a>        <span class="n">img_f_title</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;æ¥·ä½“&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>  <span class="c1"># è®¾ç½®æ ‡é¢˜å­—ä½“å¤§å°</span>
<a id="__codelineno-4-124" name="__codelineno-4-124"></a>        <span class="c1"># todo è¦ä¸Šä¼ çš„äººè„¸å›¾åƒ</span>
<a id="__codelineno-4-125" name="__codelineno-4-125"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>  <span class="c1"># è®¾ç½®ç¬¬ä¸€ä¸ªç•Œé¢ä¸Šè¦æ˜¾ç¤ºçš„å›¾ç‰‡</span>
<a id="__codelineno-4-126" name="__codelineno-4-126"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;UI_images/zhuye.jpeg&quot;</span><span class="p">))</span>  <span class="c1"># åˆå§‹åŒ–è¦æ˜¾ç¤ºçš„å›¾ç‰‡</span>
<a id="__codelineno-4-127" name="__codelineno-4-127"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>  <span class="c1"># è®¾ç½®å›¾ç‰‡å±…ä¸­</span>
<a id="__codelineno-4-128" name="__codelineno-4-128"></a>
<a id="__codelineno-4-129" name="__codelineno-4-129"></a>        <span class="c1"># åˆ›å»ºä¸€ä¸ªè¡¨å•å¸ƒå±€æ¥åŒ…å«æç¤ºæ–‡æœ¬å’Œäººåè¾“å…¥æ¡†</span>
<a id="__codelineno-4-130" name="__codelineno-4-130"></a>        <span class="n">form_layout</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
<a id="__codelineno-4-131" name="__codelineno-4-131"></a>        <span class="n">name_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;è¯·è¾“å…¥å§“å: &quot;</span><span class="p">)</span>  <span class="c1"># æ·»åŠ æç¤ºæ–‡æœ¬</span>
<a id="__codelineno-4-132" name="__codelineno-4-132"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">face_name</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>  <span class="c1"># è®¾ç½®å½“å‰å›¾ç‰‡å¯¹åº”çš„äººå</span>
<a id="__codelineno-4-133" name="__codelineno-4-133"></a>        <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">name_label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_name</span><span class="p">)</span>  <span class="c1"># å°†æç¤ºæ–‡æœ¬å’Œè¾“å…¥æ¡†æ·»åŠ åˆ°è¡¨å•å¸ƒå±€</span>
<a id="__codelineno-4-134" name="__codelineno-4-134"></a>
<a id="__codelineno-4-135" name="__codelineno-4-135"></a>        <span class="c1"># åˆ›å»ºä¸€ä¸ªæ°´å¹³å¸ƒå±€æ¥åŒ…å«&quot;ä¸Šä¼ å›¾ç‰‡&quot;æŒ‰é’®å’Œ&quot;å¼€å§‹ä¸Šä¼ &quot;æŒ‰é’®</span>
<a id="__codelineno-4-136" name="__codelineno-4-136"></a>        <span class="n">buttons_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
<a id="__codelineno-4-137" name="__codelineno-4-137"></a>        <span class="n">img_up_btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;ä¸Šä¼ å›¾ç‰‡&quot;</span><span class="p">)</span>  <span class="c1"># è®¾ç½®ä¸Šä¼ å›¾ç‰‡çš„æŒ‰é’®</span>
<a id="__codelineno-4-138" name="__codelineno-4-138"></a>        <span class="n">img_det_btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;å¼€å§‹ä¸Šä¼ &quot;</span><span class="p">)</span>  <span class="c1"># è®¾ç½®å¼€å§‹ä¸Šä¼ çš„æŒ‰é’®</span>
<a id="__codelineno-4-139" name="__codelineno-4-139"></a>        <span class="n">img_up_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_img</span><span class="p">)</span>  <span class="c1"># è”ç³»åˆ°ç›¸å…³å‡½æ•°</span>
<a id="__codelineno-4-140" name="__codelineno-4-140"></a>        <span class="n">img_det_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_db_img</span><span class="p">)</span>  <span class="c1"># è¿æ¥åˆ°ç›¸å…³å‡½æ•°</span>
<a id="__codelineno-4-141" name="__codelineno-4-141"></a>
<a id="__codelineno-4-142" name="__codelineno-4-142"></a>        <span class="c1"># è®¾ç½®ç»„ä»¶çš„æ ·å¼</span>
<a id="__codelineno-4-143" name="__codelineno-4-143"></a>        <span class="n">img_up_btn</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">generally_font</span><span class="p">)</span>
<a id="__codelineno-4-144" name="__codelineno-4-144"></a>        <span class="n">img_det_btn</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">generally_font</span><span class="p">)</span>
<a id="__codelineno-4-145" name="__codelineno-4-145"></a>        <span class="n">img_up_btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-4-146" name="__codelineno-4-146"></a>                                <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-4-147" name="__codelineno-4-147"></a>                                <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-4-148" name="__codelineno-4-148"></a>                                <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-4-149" name="__codelineno-4-149"></a>                                <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-4-150" name="__codelineno-4-150"></a>                                <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-4-151" name="__codelineno-4-151"></a>                                <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-4-152" name="__codelineno-4-152"></a>        <span class="n">img_det_btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-4-153" name="__codelineno-4-153"></a>                                <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-4-154" name="__codelineno-4-154"></a>                                <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-4-155" name="__codelineno-4-155"></a>                                <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-4-156" name="__codelineno-4-156"></a>                                <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-4-157" name="__codelineno-4-157"></a>                                <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-4-158" name="__codelineno-4-158"></a>                                <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-4-159" name="__codelineno-4-159"></a>
<a id="__codelineno-4-160" name="__codelineno-4-160"></a>        <span class="c1"># å°†ç»„ä»¶æ·»åŠ åˆ°å¸ƒå±€ä¸Šï¼Œç„¶åè®¾ç½®ä¸»è¦çš„widgetä¸ºå½“å‰çš„å¸ƒå±€</span>
<a id="__codelineno-4-161" name="__codelineno-4-161"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">img_f_title</span><span class="p">)</span>
<a id="__codelineno-4-162" name="__codelineno-4-162"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="p">)</span>
<a id="__codelineno-4-163" name="__codelineno-4-163"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">form_layout</span><span class="p">)</span>  <span class="c1"># æ·»åŠ è¡¨å•å¸ƒå±€åˆ°å‚ç›´å¸ƒå±€</span>
<a id="__codelineno-4-164" name="__codelineno-4-164"></a>        <span class="n">buttons_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">img_up_btn</span><span class="p">)</span>  <span class="c1"># æ·»åŠ æŒ‰é’®åˆ°æ°´å¹³å¸ƒå±€</span>
<a id="__codelineno-4-165" name="__codelineno-4-165"></a>        <span class="n">buttons_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">img_det_btn</span><span class="p">)</span>  <span class="c1"># æ·»åŠ æŒ‰é’®åˆ°æ°´å¹³å¸ƒå±€</span>
<a id="__codelineno-4-166" name="__codelineno-4-166"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">buttons_layout</span><span class="p">)</span>  <span class="c1"># æ·»åŠ æ°´å¹³å¸ƒå±€åˆ°å‚ç›´å¸ƒå±€</span>
<a id="__codelineno-4-167" name="__codelineno-4-167"></a>        <span class="n">img_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">img_layout</span><span class="p">)</span>
<a id="__codelineno-4-168" name="__codelineno-4-168"></a>
<a id="__codelineno-4-169" name="__codelineno-4-169"></a>
<a id="__codelineno-4-170" name="__codelineno-4-170"></a>
<a id="__codelineno-4-171" name="__codelineno-4-171"></a>
<a id="__codelineno-4-172" name="__codelineno-4-172"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-4-173" name="__codelineno-4-173"></a><span class="sd">        *** 4. è§†é¢‘è¯†åˆ«ç•Œé¢ ***</span>
<a id="__codelineno-4-174" name="__codelineno-4-174"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-4-175" name="__codelineno-4-175"></a>        <span class="n">video_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<a id="__codelineno-4-176" name="__codelineno-4-176"></a>        <span class="n">video_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<a id="__codelineno-4-177" name="__codelineno-4-177"></a>        <span class="c1"># è®¾ç½®è§†é¢‘è¯†åˆ«åŒºçš„æ ‡é¢˜</span>
<a id="__codelineno-4-178" name="__codelineno-4-178"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;æ‘„åƒå¤´/è§†é¢‘è¯†åˆ«åŒº&quot;</span><span class="p">)</span>
<a id="__codelineno-4-179" name="__codelineno-4-179"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-4-180" name="__codelineno-4-180"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-4-181" name="__codelineno-4-181"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-4-182" name="__codelineno-4-182"></a>        <span class="c1"># è®¾ç½®æ˜¾ç¤ºçš„ç•Œé¢</span>
<a id="__codelineno-4-183" name="__codelineno-4-183"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>
<a id="__codelineno-4-184" name="__codelineno-4-184"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
<a id="__codelineno-4-185" name="__codelineno-4-185"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;äººè„¸æ£€æµ‹æ‘„åƒå¤´&quot;</span><span class="p">)</span>
<a id="__codelineno-4-186" name="__codelineno-4-186"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-4-187" name="__codelineno-4-187"></a>        <span class="c1"># è®¾ç½®æ‰“å¼€æ‘„åƒå¤´çš„æŒ‰é’®å’Œæ ·å¼</span>
<a id="__codelineno-4-188" name="__codelineno-4-188"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-4-189" name="__codelineno-4-189"></a>                                          <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-4-190" name="__codelineno-4-190"></a>                                          <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-4-191" name="__codelineno-4-191"></a>                                          <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-4-192" name="__codelineno-4-192"></a>                                          <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-4-193" name="__codelineno-4-193"></a>                                          <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-4-194" name="__codelineno-4-194"></a>                                          <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-4-195" name="__codelineno-4-195"></a>        <span class="c1"># è®¾ç½®é€‰æ‹©æ–‡ä»¶çš„çš„æŒ‰é’®å’Œæ ·å¼</span>
<a id="__codelineno-4-196" name="__codelineno-4-196"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;å¼€å§‹è¯†åˆ«ï¼ˆé€‰æ‹©æ–‡ä»¶ï¼‰&quot;</span><span class="p">)</span>
<a id="__codelineno-4-197" name="__codelineno-4-197"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-4-198" name="__codelineno-4-198"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-4-199" name="__codelineno-4-199"></a>                                    <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-4-200" name="__codelineno-4-200"></a>                                    <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-4-201" name="__codelineno-4-201"></a>                                    <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-4-202" name="__codelineno-4-202"></a>                                    <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-4-203" name="__codelineno-4-203"></a>                                    <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-4-204" name="__codelineno-4-204"></a>                                    <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-4-205" name="__codelineno-4-205"></a>        <span class="c1"># è®¾ç½®ç»“æŸæ¼”ç¤ºçš„æŒ‰é’®å’Œæ ·å¼</span>
<a id="__codelineno-4-206" name="__codelineno-4-206"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;ç»“æŸæ£€æµ‹&quot;</span><span class="p">)</span>
<a id="__codelineno-4-207" name="__codelineno-4-207"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-4-208" name="__codelineno-4-208"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-4-209" name="__codelineno-4-209"></a>                                     <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-4-210" name="__codelineno-4-210"></a>                                     <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-4-211" name="__codelineno-4-211"></a>                                     <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-4-212" name="__codelineno-4-212"></a>                                     <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-4-213" name="__codelineno-4-213"></a>                                     <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-4-214" name="__codelineno-4-214"></a>                                     <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-4-215" name="__codelineno-4-215"></a>        <span class="c1"># å°†ç»„ä»¶æ·»åŠ åˆ°å¸ƒå±€ä¸Š</span>
<a id="__codelineno-4-216" name="__codelineno-4-216"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_local</span><span class="p">)</span>
<a id="__codelineno-4-217" name="__codelineno-4-217"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">)</span>
<a id="__codelineno-4-218" name="__codelineno-4-218"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
<a id="__codelineno-4-219" name="__codelineno-4-219"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-4-220" name="__codelineno-4-220"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="p">)</span>
<a id="__codelineno-4-221" name="__codelineno-4-221"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="p">)</span>
<a id="__codelineno-4-222" name="__codelineno-4-222"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-4-223" name="__codelineno-4-223"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="p">)</span>
<a id="__codelineno-4-224" name="__codelineno-4-224"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="p">)</span>
<a id="__codelineno-4-225" name="__codelineno-4-225"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="p">)</span>
<a id="__codelineno-4-226" name="__codelineno-4-226"></a>        <span class="n">video_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">video_layout</span><span class="p">)</span>
<a id="__codelineno-4-227" name="__codelineno-4-227"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-4-228" name="__codelineno-4-228"></a><span class="sd">        *** 5. å…³äºç•Œé¢ ***</span>
<a id="__codelineno-4-229" name="__codelineno-4-229"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-4-230" name="__codelineno-4-230"></a>        <span class="n">about_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<a id="__codelineno-4-231" name="__codelineno-4-231"></a>        <span class="n">about_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<a id="__codelineno-4-232" name="__codelineno-4-232"></a>        <span class="n">about_title</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;æ¬¢è¿ä½¿ç”¨äººè„¸æ£€æµ‹ç³»ç»Ÿ</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># todo ä¿®æ”¹æ¬¢è¿è¯è¯­</span>
<a id="__codelineno-4-233" name="__codelineno-4-233"></a>        <span class="n">about_title</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;æ¥·ä½“&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>
<a id="__codelineno-4-234" name="__codelineno-4-234"></a>        <span class="n">about_title</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-4-235" name="__codelineno-4-235"></a>        <span class="n">about_img</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>
<a id="__codelineno-4-236" name="__codelineno-4-236"></a>        <span class="n">about_img</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s1">&#39;UI_images/san.png&#39;</span><span class="p">))</span>
<a id="__codelineno-4-237" name="__codelineno-4-237"></a>        <span class="n">about_img</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-4-238" name="__codelineno-4-238"></a>
<a id="__codelineno-4-239" name="__codelineno-4-239"></a>        <span class="c1"># label4.setText(&quot;&lt;a href=&#39;https://oi.wiki/wiki/å­¦ä¹ ç‡çš„è°ƒæ•´&#39;&gt;å¦‚ä½•è°ƒæ•´å­¦ä¹ ç‡&lt;/a&gt;&quot;)</span>
<a id="__codelineno-4-240" name="__codelineno-4-240"></a>        <span class="n">label_super</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>  <span class="c1"># todo æ›´æ¢ä½œè€…ä¿¡æ¯</span>
<a id="__codelineno-4-241" name="__codelineno-4-241"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&lt;a href=&#39;https://wcowin.work/&#39;&gt;--&gt;è”ç³»æˆ‘ä»¬&lt;/a&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-4-242" name="__codelineno-4-242"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;æ¥·ä½“&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<a id="__codelineno-4-243" name="__codelineno-4-243"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setOpenExternalLinks</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-4-244" name="__codelineno-4-244"></a>        <span class="c1"># label_super.setOpenExternalLinks(True)</span>
<a id="__codelineno-4-245" name="__codelineno-4-245"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignRight</span><span class="p">)</span>
<a id="__codelineno-4-246" name="__codelineno-4-246"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">about_title</span><span class="p">)</span>
<a id="__codelineno-4-247" name="__codelineno-4-247"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
<a id="__codelineno-4-248" name="__codelineno-4-248"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">about_img</span><span class="p">)</span>
<a id="__codelineno-4-249" name="__codelineno-4-249"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
<a id="__codelineno-4-250" name="__codelineno-4-250"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label_super</span><span class="p">)</span>
<a id="__codelineno-4-251" name="__codelineno-4-251"></a>        <span class="n">about_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">about_layout</span><span class="p">)</span>
<a id="__codelineno-4-252" name="__codelineno-4-252"></a>        <span class="c1"># åˆ†åˆ«æ·»åŠ å­é¡µé¢</span>
<a id="__codelineno-4-253" name="__codelineno-4-253"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">img_widget</span><span class="p">,</span> <span class="s2">&quot;ä¸Šä¼ äººè„¸&quot;</span><span class="p">)</span>
<a id="__codelineno-4-254" name="__codelineno-4-254"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">video_widget</span><span class="p">,</span> <span class="s1">&#39;è§†é¢‘æ£€æµ‹&#39;</span><span class="p">)</span>
<a id="__codelineno-4-255" name="__codelineno-4-255"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">about_widget</span><span class="p">,</span> <span class="s1">&#39;å…³äº&#39;</span><span class="p">)</span>
<a id="__codelineno-4-256" name="__codelineno-4-256"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/å›¾ç‰‡.png&#39;</span><span class="p">))</span>
<a id="__codelineno-4-257" name="__codelineno-4-257"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/å›¾ç‰‡.png&#39;</span><span class="p">))</span>
<a id="__codelineno-4-258" name="__codelineno-4-258"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/ç›´æ’­.png&#39;</span><span class="p">))</span>
<a id="__codelineno-4-259" name="__codelineno-4-259"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/logo_about.png&#39;</span><span class="p">))</span>
<a id="__codelineno-4-260" name="__codelineno-4-260"></a>
<a id="__codelineno-4-261" name="__codelineno-4-261"></a>    <span class="c1"># ç¬¬ä¸€ä¸ªç•Œé¢çš„å‡½æ•°</span>
<a id="__codelineno-4-262" name="__codelineno-4-262"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">up_img</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-263" name="__codelineno-4-263"></a>        <span class="c1"># æ‰“å¼€æ–‡ä»¶é€‰æ‹©æ¡†</span>
<a id="__codelineno-4-264" name="__codelineno-4-264"></a>        <span class="n">openfile_name</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;é€‰æ‹©æ–‡ä»¶&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Image files(*.jpg , *.png)&#39;</span><span class="p">)</span>
<a id="__codelineno-4-265" name="__codelineno-4-265"></a>        <span class="c1"># è·å–ä¸Šä¼ çš„æ–‡ä»¶åç§°</span>
<a id="__codelineno-4-266" name="__codelineno-4-266"></a>        <span class="n">img_name</span> <span class="o">=</span> <span class="n">openfile_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-4-267" name="__codelineno-4-267"></a>        <span class="k">if</span> <span class="n">img_name</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
<a id="__codelineno-4-268" name="__codelineno-4-268"></a>            <span class="k">pass</span>
<a id="__codelineno-4-269" name="__codelineno-4-269"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-270" name="__codelineno-4-270"></a>            <span class="c1"># ä¸Šä¼ ä¹‹åæ˜¾ç¤ºå¹¶åšå½’ä¸€åŒ–å¤„ç†</span>
<a id="__codelineno-4-271" name="__codelineno-4-271"></a>            <span class="n">src_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_name</span><span class="p">)</span>
<a id="__codelineno-4-272" name="__codelineno-4-272"></a>            <span class="n">src_img_height</span> <span class="o">=</span> <span class="n">src_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-4-273" name="__codelineno-4-273"></a>            <span class="n">src_img_width</span> <span class="o">=</span> <span class="n">src_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-4-274" name="__codelineno-4-274"></a>            <span class="n">target_img_height</span> <span class="o">=</span> <span class="mi">400</span>
<a id="__codelineno-4-275" name="__codelineno-4-275"></a>            <span class="n">ratio</span> <span class="o">=</span> <span class="n">target_img_height</span> <span class="o">/</span> <span class="n">src_img_height</span>
<a id="__codelineno-4-276" name="__codelineno-4-276"></a>            <span class="n">target_img_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">src_img_width</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>
<a id="__codelineno-4-277" name="__codelineno-4-277"></a>            <span class="c1"># å°†å›¾ç‰‡ç»Ÿä¸€å¤„ç†åˆ°é«˜ä¸º400çš„å›¾ç‰‡ï¼Œæ–¹ä¾¿åœ¨ç•Œé¢ä¸Šæ˜¾ç¤º</span>
<a id="__codelineno-4-278" name="__codelineno-4-278"></a>            <span class="n">target_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">src_img</span><span class="p">,</span> <span class="p">(</span><span class="n">target_img_width</span><span class="p">,</span> <span class="n">target_img_height</span><span class="p">))</span>
<a id="__codelineno-4-279" name="__codelineno-4-279"></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span><span class="p">,</span> <span class="n">target_img</span><span class="p">)</span>
<a id="__codelineno-4-280" name="__codelineno-4-280"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span><span class="p">))</span>
<a id="__codelineno-4-281" name="__codelineno-4-281"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span> <span class="o">=</span> <span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span>
<a id="__codelineno-4-282" name="__codelineno-4-282"></a>
<a id="__codelineno-4-283" name="__codelineno-4-283"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">up_db_img</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-284" name="__codelineno-4-284"></a>        <span class="c1"># é¦–å…ˆåˆ¤æ–­è¯¥å›¾åƒæ˜¯å¦æœ‰ä¸€ä¸ªäººè„¸ï¼Œå¤šä¸ªäººè„¸æˆ–è€…æ²¡æœ‰äººè„¸éƒ½ä¸è¡Œ</span>
<a id="__codelineno-4-285" name="__codelineno-4-285"></a>        <span class="n">face_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_name</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
<a id="__codelineno-4-286" name="__codelineno-4-286"></a>        <span class="k">if</span> <span class="n">face_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
<a id="__codelineno-4-287" name="__codelineno-4-287"></a>            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ä¸èƒ½ä¸ºç©º&quot;</span><span class="p">,</span> <span class="s2">&quot;è¯·å¡«å†™äººè„¸å§“å&quot;</span><span class="p">)</span>
<a id="__codelineno-4-288" name="__codelineno-4-288"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-289" name="__codelineno-4-289"></a>            <span class="n">load_image</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">load_image_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span><span class="p">)</span>  <span class="c1"># åŠ è½½å›¾ç‰‡</span>
<a id="__codelineno-4-290" name="__codelineno-4-290"></a>            <span class="n">image_face_encoding</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_encodings</span><span class="p">(</span><span class="n">load_image</span><span class="p">)</span>  <span class="c1"># è·å¾—128ç»´ç‰¹å¾å€¼</span>
<a id="__codelineno-4-291" name="__codelineno-4-291"></a>            <span class="n">encoding_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">image_face_encoding</span><span class="p">)</span>  <span class="c1"># è·å–äººè„¸å¾—æ•°é‡</span>
<a id="__codelineno-4-292" name="__codelineno-4-292"></a>            <span class="k">if</span> <span class="n">encoding_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># å¦‚æœæ²¡æœ‰äººè„¸ï¼Œæç¤ºç”¨æˆ·é‡æ–°ä¸Šä¼ </span>
<a id="__codelineno-4-293" name="__codelineno-4-293"></a>                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;è¯·é‡æ–°ä¸Šä¼ &quot;</span><span class="p">,</span> <span class="s2">&quot;å½“å‰å›¾ç‰‡æ²¡æœ‰å‘ç°äººè„¸&quot;</span><span class="p">)</span>
<a id="__codelineno-4-294" name="__codelineno-4-294"></a>            <span class="k">elif</span> <span class="n">encoding_length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># å¦‚æœäººè„¸æœ‰å¤šä¸ªï¼Œä¹Ÿæç¤ºç”¨æˆ·é‡æ–°ä¸Šä¼ </span>
<a id="__codelineno-4-295" name="__codelineno-4-295"></a>                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;è¯·é‡æ–°ä¸Šä¼ &quot;</span><span class="p">,</span> <span class="s2">&quot;å½“å‰å›¾ç‰‡å‘ç°å¤šå¼ äººè„¸&quot;</span><span class="p">)</span>
<a id="__codelineno-4-296" name="__codelineno-4-296"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-297" name="__codelineno-4-297"></a>                <span class="n">face_encoding</span> <span class="o">=</span> <span class="n">image_face_encoding</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># è·å–è§£æå¾—åˆ°å¾—äººè„¸æ•°é‡</span>
<a id="__codelineno-4-298" name="__codelineno-4-298"></a>                <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span><span class="p">)</span>  <span class="c1"># å°†ä¸Šä¼ å¾—å›¾ç‰‡ä¿å­˜åœ¨dbç›®å½•ä¸‹</span>
<a id="__codelineno-4-299" name="__codelineno-4-299"></a>                <span class="n">img_path</span> <span class="o">=</span> <span class="n">face_name</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span>
<a id="__codelineno-4-300" name="__codelineno-4-300"></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;images/db_faces/&quot;</span> <span class="o">+</span> <span class="n">img_path</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
<a id="__codelineno-4-301" name="__codelineno-4-301"></a>                <span class="c1"># ä¸Šä¼ ä¹‹åé‡æ–°å¯¹å­—å…¸è¿›è¡Œå¤„ç†</span>
<a id="__codelineno-4-302" name="__codelineno-4-302"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">known_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">face_name</span><span class="p">)</span>
<a id="__codelineno-4-303" name="__codelineno-4-303"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">known_encodings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">face_encoding</span><span class="p">)</span>
<a id="__codelineno-4-304" name="__codelineno-4-304"></a>                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ä¸Šä¼ æˆåŠŸ&quot;</span><span class="p">,</span> <span class="s2">&quot;æ•°æ®å·²ä¸Šä¼ ï¼&quot;</span><span class="p">)</span>
<a id="__codelineno-4-305" name="__codelineno-4-305"></a>
<a id="__codelineno-4-306" name="__codelineno-4-306"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-4-307" name="__codelineno-4-307"></a><span class="sd">    ### 3. è§†é¢‘è¯†åˆ«ç›¸å…³åŠŸèƒ½ ### </span>
<a id="__codelineno-4-308" name="__codelineno-4-308"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-4-309" name="__codelineno-4-309"></a>
<a id="__codelineno-4-310" name="__codelineno-4-310"></a>    <span class="c1"># å…³é—­äº‹ä»¶ è¯¢é—®ç”¨æˆ·æ˜¯å¦é€€å‡º</span>
<a id="__codelineno-4-311" name="__codelineno-4-311"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">closeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<a id="__codelineno-4-312" name="__codelineno-4-312"></a>        <span class="n">reply</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-4-313" name="__codelineno-4-313"></a>                                     <span class="s1">&#39;é€€å‡º&#39;</span><span class="p">,</span>
<a id="__codelineno-4-314" name="__codelineno-4-314"></a>                                     <span class="s2">&quot;æ˜¯å¦è¦é€€å‡ºç¨‹åºï¼Ÿ&quot;</span><span class="p">,</span>
<a id="__codelineno-4-315" name="__codelineno-4-315"></a>                                     <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">,</span>
<a id="__codelineno-4-316" name="__codelineno-4-316"></a>                                     <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
<a id="__codelineno-4-317" name="__codelineno-4-317"></a>        <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
<a id="__codelineno-4-318" name="__codelineno-4-318"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-4-319" name="__codelineno-4-319"></a>            <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
<a id="__codelineno-4-320" name="__codelineno-4-320"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-321" name="__codelineno-4-321"></a>            <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
<a id="__codelineno-4-322" name="__codelineno-4-322"></a>
<a id="__codelineno-4-323" name="__codelineno-4-323"></a>    <span class="c1"># è¯»å–å½•åƒæ–‡ä»¶</span>
<a id="__codelineno-4-324" name="__codelineno-4-324"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-325" name="__codelineno-4-325"></a>        <span class="c1"># é€‰æ‹©å½•åƒæ–‡ä»¶è¿›è¡Œè¯»å–</span>
<a id="__codelineno-4-326" name="__codelineno-4-326"></a>        <span class="n">mp4_fileName</span><span class="p">,</span> <span class="n">fileType</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Choose file&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;*.mp4&#39;</span><span class="p">)</span>
<a id="__codelineno-4-327" name="__codelineno-4-327"></a>        <span class="k">if</span> <span class="n">mp4_fileName</span><span class="p">:</span>
<a id="__codelineno-4-328" name="__codelineno-4-328"></a>            <span class="c1"># å¯åŠ¨å½•åƒæ–‡ä»¶è¯»å–å¾—çº¿ç¨‹å¹¶åœ¨ç”»é¢ä¸Šå®æ—¶æ˜¾ç¤º</span>
<a id="__codelineno-4-329" name="__codelineno-4-329"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">mp4_fileName</span>
<a id="__codelineno-4-330" name="__codelineno-4-330"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-4-331" name="__codelineno-4-331"></a>            <span class="n">th</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_video</span><span class="p">)</span>
<a id="__codelineno-4-332" name="__codelineno-4-332"></a>            <span class="n">th</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-4-333" name="__codelineno-4-333"></a>
<a id="__codelineno-4-334" name="__codelineno-4-334"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open_local</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-335" name="__codelineno-4-335"></a>        <span class="c1"># é€‰æ‹©å½•åƒæ–‡ä»¶è¿›è¡Œè¯»å–</span>
<a id="__codelineno-4-336" name="__codelineno-4-336"></a>        <span class="n">mp4_filename</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-4-337" name="__codelineno-4-337"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">mp4_filename</span>
<a id="__codelineno-4-338" name="__codelineno-4-338"></a>        <span class="c1"># è¯»å–æ‘„åƒå¤´è¿›è¡Œå®æ—¶å¾—æ˜¾ç¤º</span>
<a id="__codelineno-4-339" name="__codelineno-4-339"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-4-340" name="__codelineno-4-340"></a>        <span class="n">th</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_video</span><span class="p">)</span>
<a id="__codelineno-4-341" name="__codelineno-4-341"></a>        <span class="n">th</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-4-342" name="__codelineno-4-342"></a>
<a id="__codelineno-4-343" name="__codelineno-4-343"></a>    <span class="c1"># é€€å‡ºè¿›ç¨‹</span>
<a id="__codelineno-4-344" name="__codelineno-4-344"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-345" name="__codelineno-4-345"></a>        <span class="c1"># ç‚¹å‡»å…³é—­æŒ‰é’®åé‡æ–°åˆå§‹åŒ–ç•Œé¢</span>
<a id="__codelineno-4-346" name="__codelineno-4-346"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<a id="__codelineno-4-347" name="__codelineno-4-347"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-4-348" name="__codelineno-4-348"></a>
<a id="__codelineno-4-349" name="__codelineno-4-349"></a>    <span class="c1"># todo æ‰§è¡Œäººè„¸è¯†åˆ«ä¸»è¿›ç¨‹</span>
<a id="__codelineno-4-350" name="__codelineno-4-350"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_video</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-351" name="__codelineno-4-351"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-4-352" name="__codelineno-4-352"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-4-353" name="__codelineno-4-353"></a>        <span class="n">process_this_frame</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-4-354" name="__codelineno-4-354"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-4-355" name="__codelineno-4-355"></a>            <span class="n">ret</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a id="__codelineno-4-356" name="__codelineno-4-356"></a>            <span class="n">rgb_frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
<a id="__codelineno-4-357" name="__codelineno-4-357"></a>            <span class="k">if</span> <span class="n">process_this_frame</span><span class="p">:</span>
<a id="__codelineno-4-358" name="__codelineno-4-358"></a>                <span class="n">face_locations</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_locations</span><span class="p">(</span><span class="n">rgb_frame</span><span class="p">)</span>
<a id="__codelineno-4-359" name="__codelineno-4-359"></a>                <span class="n">face_encodings</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_encodings</span><span class="p">(</span><span class="n">rgb_frame</span><span class="p">,</span> <span class="n">face_locations</span><span class="p">)</span>
<a id="__codelineno-4-360" name="__codelineno-4-360"></a>                <span class="n">face_names</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-4-361" name="__codelineno-4-361"></a>                <span class="k">for</span> <span class="n">face_encoding</span> <span class="ow">in</span> <span class="n">face_encodings</span><span class="p">:</span>
<a id="__codelineno-4-362" name="__codelineno-4-362"></a>                    <span class="n">matches</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">compare_faces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">known_encodings</span><span class="p">,</span> <span class="n">face_encoding</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a id="__codelineno-4-363" name="__codelineno-4-363"></a>                    <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
<a id="__codelineno-4-364" name="__codelineno-4-364"></a>                        <span class="n">first_match_index</span> <span class="o">=</span> <span class="n">matches</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-4-365" name="__codelineno-4-365"></a>                        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">known_names</span><span class="p">[</span><span class="n">first_match_index</span><span class="p">]</span>
<a id="__codelineno-4-366" name="__codelineno-4-366"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-367" name="__codelineno-4-367"></a>                        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Unknown&quot;</span>
<a id="__codelineno-4-368" name="__codelineno-4-368"></a>                    <span class="n">face_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-4-369" name="__codelineno-4-369"></a>            <span class="n">process_this_frame</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">process_this_frame</span>
<a id="__codelineno-4-370" name="__codelineno-4-370"></a>            <span class="k">for</span> <span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">left</span><span class="p">),</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">face_locations</span><span class="p">,</span> <span class="n">face_names</span><span class="p">):</span>
<a id="__codelineno-4-371" name="__codelineno-4-371"></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">),</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># ä¿®æ”¹è¾¹ç•Œæ¡†é¢œè‰²ä¸ºçº¢è‰²</span>
<a id="__codelineno-4-372" name="__codelineno-4-372"></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">-</span> <span class="mi">35</span><span class="p">),</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FILLED</span><span class="p">)</span>  <span class="c1"># ä¿®æ”¹å¡«å……é¢œè‰²ä¸ºçº¢è‰²</span>
<a id="__codelineno-4-373" name="__codelineno-4-373"></a>                <span class="n">font</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_DUPLEX</span>
<a id="__codelineno-4-374" name="__codelineno-4-374"></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">left</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">-</span> <span class="mi">6</span><span class="p">),</span> <span class="n">font</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-4-375" name="__codelineno-4-375"></a>            <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>
<a id="__codelineno-4-376" name="__codelineno-4-376"></a>            <span class="n">frame_height</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-4-377" name="__codelineno-4-377"></a>            <span class="n">frame_width</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-4-378" name="__codelineno-4-378"></a>            <span class="n">frame_scale</span> <span class="o">=</span> <span class="mi">500</span> <span class="o">/</span> <span class="n">frame_height</span>
<a id="__codelineno-4-379" name="__codelineno-4-379"></a>            <span class="n">frame_resize</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">frame_width</span> <span class="o">*</span> <span class="n">frame_scale</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_height</span> <span class="o">*</span> <span class="n">frame_scale</span><span class="p">)))</span>
<a id="__codelineno-4-380" name="__codelineno-4-380"></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;images/tmp.jpg&quot;</span><span class="p">,</span> <span class="n">frame_resize</span><span class="p">)</span>
<a id="__codelineno-4-381" name="__codelineno-4-381"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;images/tmp.jpg&quot;</span><span class="p">))</span>
<a id="__codelineno-4-382" name="__codelineno-4-382"></a>            <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-4-383" name="__codelineno-4-383"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-4-384" name="__codelineno-4-384"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-4-385" name="__codelineno-4-385"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-4-386" name="__codelineno-4-386"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-4-387" name="__codelineno-4-387"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-4-388" name="__codelineno-4-388"></a>                <span class="k">break</span>
<a id="__codelineno-4-389" name="__codelineno-4-389"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-4-390" name="__codelineno-4-390"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-4-391" name="__codelineno-4-391"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-4-392" name="__codelineno-4-392"></a>
<a id="__codelineno-4-393" name="__codelineno-4-393"></a>    <span class="c1"># åˆå§‹åŒ–è§†é¢‘æ£€æµ‹ç•Œé¢</span>
<a id="__codelineno-4-394" name="__codelineno-4-394"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_down</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-4-395" name="__codelineno-4-395"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
<a id="__codelineno-4-396" name="__codelineno-4-396"></a>        <span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
<a id="__codelineno-4-397" name="__codelineno-4-397"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;UI_images/dier.jpeg&quot;</span><span class="p">))</span>
<a id="__codelineno-4-398" name="__codelineno-4-398"></a>
<a id="__codelineno-4-399" name="__codelineno-4-399"></a>
<a id="__codelineno-4-400" name="__codelineno-4-400"></a><span class="c1"># https://www.lfd.uci.edu/~gohlke/pythonlibs/</span>
<a id="__codelineno-4-401" name="__codelineno-4-401"></a><span class="c1"># https://pypi.org/project/dlib/#files</span>
<a id="__codelineno-4-402" name="__codelineno-4-402"></a><span class="c1"># https://download.csdn.net/download/ECHOSON/75224362</span>
<a id="__codelineno-4-403" name="__codelineno-4-403"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-4-404" name="__codelineno-4-404"></a>    <span class="c1"># åŠ è½½é¡µé¢</span>
<a id="__codelineno-4-405" name="__codelineno-4-405"></a>    <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<a id="__codelineno-4-406" name="__codelineno-4-406"></a>    <span class="n">mainWindow</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
<a id="__codelineno-4-407" name="__codelineno-4-407"></a>    <span class="n">mainWindow</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-4-408" name="__codelineno-4-408"></a>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
</code></pre></div></td></tr></table></div></p>
<h2 id="_5">æ•ˆæœ<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<p><img alt="image.png" src="https://s2.loli.net/2024/02/04/AcdiBjGqRu3zZnO.jpg" /></p>
<p><strong>å‡†ç¡®åº¦æ˜¾è‘—æé«˜ï¼Œå¤šäººç…§ç‰‡è¯†åˆ«ä¹Ÿæ›´å¿«ï¼ŒUIäº¤äº’ä¹Ÿåšäº†æ”¹è¿›</strong>  </p>
<h2 id="ing">æŒç»­ä¼˜åŒ–ing<a class="headerlink" href="#ing" title="Permanent link">&para;</a></h2>
<p>æ°é€¢Pythoè¯¾ç¨‹è®¾è®¡ï¼Œäºæ˜¯æˆ‘ä¾¿æ‹¿å‡ºæ¥ä½œä¸ºå°ç»„è®¾è®¡ä½œå“ï¼Œä½†æ˜¯åšäº†è¿›ä¸€æ­¥å®Œå–„  </p>
<p>å›¢é˜Ÿ(å§šåŒã€æœ¬ä½œè€…ã€å¼ å¹³ã€åˆ˜é“¶æ°)ä¼˜åŒ–åæœ€ç»ˆç‰ˆæœ¬ï¼š<br />
<strong>è¯†åˆ«ç²¾åº¦å¤§å¹…æå‡ï¼Œæ”¯æŒå¤šäººè„¸è¯†åˆ«ï¼Œæ”¯æŒå¤šç§äººè„¸è¯†åˆ«æ¨¡å‹ï¼Œæ”¯æŒäººè„¸å›¾åƒé¢„å¤„ç†ï¼Œæ”¯æŒä½¿ç”¨æ›´é«˜çº§çš„äººè„¸è¯†åˆ«æ¨¡å‹ï¼Œæ”¯æŒå¢åŠ äººè„¸å›¾åƒçš„æ•°é‡å’Œå¤šæ ·æ€§ï¼Œæ”¯æŒä½¿ç”¨æ›´é«˜çº§çš„äººè„¸è¯†åˆ«æ¨¡å‹ï¼Œæ”¯æŒäººè„¸å›¾åƒé¢„å¤„ç†ï¼Œæ”¯æŒäººè„¸åŒ¹é…ï¼Œæ”¯æŒç»“æœæ˜¾ç¤ºï¼Œæ”¯æŒç”¨æˆ·äº¤äº’ï¼Œæ”¯æŒæ•°æ®æ”¶é›†ä¸é¢„å¤„ç†ï¼Œæ”¯æŒäººè„¸ç‰¹å¾æå–</strong>  </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">  1</a></span>
<span class="normal"><a href="#__codelineno-5-2">  2</a></span>
<span class="normal"><a href="#__codelineno-5-3">  3</a></span>
<span class="normal"><a href="#__codelineno-5-4">  4</a></span>
<span class="normal"><a href="#__codelineno-5-5">  5</a></span>
<span class="normal"><a href="#__codelineno-5-6">  6</a></span>
<span class="normal"><a href="#__codelineno-5-7">  7</a></span>
<span class="normal"><a href="#__codelineno-5-8">  8</a></span>
<span class="normal"><a href="#__codelineno-5-9">  9</a></span>
<span class="normal"><a href="#__codelineno-5-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-5-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-5-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-5-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-5-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-5-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-5-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-5-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-5-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-5-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-5-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-5-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-5-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-5-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-5-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-5-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-5-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-5-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-5-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-5-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-5-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-5-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-5-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-5-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-5-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-5-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-5-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-5-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-5-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-5-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-5-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-5-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-5-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-5-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-5-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-5-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-5-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-5-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-5-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-5-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-5-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-5-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-5-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-5-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-5-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-5-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-5-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-5-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-5-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-5-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-5-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-5-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-5-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-5-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-5-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-5-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-5-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-5-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-5-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-5-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-5-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-5-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-5-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-5-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-5-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-5-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-5-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-5-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-5-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-5-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-5-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-5-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-5-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-5-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-5-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-5-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-5-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-5-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-5-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-5-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-5-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-5-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-5-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-5-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-5-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-5-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-5-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-5-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-5-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-5-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-5-100">100</a></span>
<span class="normal"><a href="#__codelineno-5-101">101</a></span>
<span class="normal"><a href="#__codelineno-5-102">102</a></span>
<span class="normal"><a href="#__codelineno-5-103">103</a></span>
<span class="normal"><a href="#__codelineno-5-104">104</a></span>
<span class="normal"><a href="#__codelineno-5-105">105</a></span>
<span class="normal"><a href="#__codelineno-5-106">106</a></span>
<span class="normal"><a href="#__codelineno-5-107">107</a></span>
<span class="normal"><a href="#__codelineno-5-108">108</a></span>
<span class="normal"><a href="#__codelineno-5-109">109</a></span>
<span class="normal"><a href="#__codelineno-5-110">110</a></span>
<span class="normal"><a href="#__codelineno-5-111">111</a></span>
<span class="normal"><a href="#__codelineno-5-112">112</a></span>
<span class="normal"><a href="#__codelineno-5-113">113</a></span>
<span class="normal"><a href="#__codelineno-5-114">114</a></span>
<span class="normal"><a href="#__codelineno-5-115">115</a></span>
<span class="normal"><a href="#__codelineno-5-116">116</a></span>
<span class="normal"><a href="#__codelineno-5-117">117</a></span>
<span class="normal"><a href="#__codelineno-5-118">118</a></span>
<span class="normal"><a href="#__codelineno-5-119">119</a></span>
<span class="normal"><a href="#__codelineno-5-120">120</a></span>
<span class="normal"><a href="#__codelineno-5-121">121</a></span>
<span class="normal"><a href="#__codelineno-5-122">122</a></span>
<span class="normal"><a href="#__codelineno-5-123">123</a></span>
<span class="normal"><a href="#__codelineno-5-124">124</a></span>
<span class="normal"><a href="#__codelineno-5-125">125</a></span>
<span class="normal"><a href="#__codelineno-5-126">126</a></span>
<span class="normal"><a href="#__codelineno-5-127">127</a></span>
<span class="normal"><a href="#__codelineno-5-128">128</a></span>
<span class="normal"><a href="#__codelineno-5-129">129</a></span>
<span class="normal"><a href="#__codelineno-5-130">130</a></span>
<span class="normal"><a href="#__codelineno-5-131">131</a></span>
<span class="normal"><a href="#__codelineno-5-132">132</a></span>
<span class="normal"><a href="#__codelineno-5-133">133</a></span>
<span class="normal"><a href="#__codelineno-5-134">134</a></span>
<span class="normal"><a href="#__codelineno-5-135">135</a></span>
<span class="normal"><a href="#__codelineno-5-136">136</a></span>
<span class="normal"><a href="#__codelineno-5-137">137</a></span>
<span class="normal"><a href="#__codelineno-5-138">138</a></span>
<span class="normal"><a href="#__codelineno-5-139">139</a></span>
<span class="normal"><a href="#__codelineno-5-140">140</a></span>
<span class="normal"><a href="#__codelineno-5-141">141</a></span>
<span class="normal"><a href="#__codelineno-5-142">142</a></span>
<span class="normal"><a href="#__codelineno-5-143">143</a></span>
<span class="normal"><a href="#__codelineno-5-144">144</a></span>
<span class="normal"><a href="#__codelineno-5-145">145</a></span>
<span class="normal"><a href="#__codelineno-5-146">146</a></span>
<span class="normal"><a href="#__codelineno-5-147">147</a></span>
<span class="normal"><a href="#__codelineno-5-148">148</a></span>
<span class="normal"><a href="#__codelineno-5-149">149</a></span>
<span class="normal"><a href="#__codelineno-5-150">150</a></span>
<span class="normal"><a href="#__codelineno-5-151">151</a></span>
<span class="normal"><a href="#__codelineno-5-152">152</a></span>
<span class="normal"><a href="#__codelineno-5-153">153</a></span>
<span class="normal"><a href="#__codelineno-5-154">154</a></span>
<span class="normal"><a href="#__codelineno-5-155">155</a></span>
<span class="normal"><a href="#__codelineno-5-156">156</a></span>
<span class="normal"><a href="#__codelineno-5-157">157</a></span>
<span class="normal"><a href="#__codelineno-5-158">158</a></span>
<span class="normal"><a href="#__codelineno-5-159">159</a></span>
<span class="normal"><a href="#__codelineno-5-160">160</a></span>
<span class="normal"><a href="#__codelineno-5-161">161</a></span>
<span class="normal"><a href="#__codelineno-5-162">162</a></span>
<span class="normal"><a href="#__codelineno-5-163">163</a></span>
<span class="normal"><a href="#__codelineno-5-164">164</a></span>
<span class="normal"><a href="#__codelineno-5-165">165</a></span>
<span class="normal"><a href="#__codelineno-5-166">166</a></span>
<span class="normal"><a href="#__codelineno-5-167">167</a></span>
<span class="normal"><a href="#__codelineno-5-168">168</a></span>
<span class="normal"><a href="#__codelineno-5-169">169</a></span>
<span class="normal"><a href="#__codelineno-5-170">170</a></span>
<span class="normal"><a href="#__codelineno-5-171">171</a></span>
<span class="normal"><a href="#__codelineno-5-172">172</a></span>
<span class="normal"><a href="#__codelineno-5-173">173</a></span>
<span class="normal"><a href="#__codelineno-5-174">174</a></span>
<span class="normal"><a href="#__codelineno-5-175">175</a></span>
<span class="normal"><a href="#__codelineno-5-176">176</a></span>
<span class="normal"><a href="#__codelineno-5-177">177</a></span>
<span class="normal"><a href="#__codelineno-5-178">178</a></span>
<span class="normal"><a href="#__codelineno-5-179">179</a></span>
<span class="normal"><a href="#__codelineno-5-180">180</a></span>
<span class="normal"><a href="#__codelineno-5-181">181</a></span>
<span class="normal"><a href="#__codelineno-5-182">182</a></span>
<span class="normal"><a href="#__codelineno-5-183">183</a></span>
<span class="normal"><a href="#__codelineno-5-184">184</a></span>
<span class="normal"><a href="#__codelineno-5-185">185</a></span>
<span class="normal"><a href="#__codelineno-5-186">186</a></span>
<span class="normal"><a href="#__codelineno-5-187">187</a></span>
<span class="normal"><a href="#__codelineno-5-188">188</a></span>
<span class="normal"><a href="#__codelineno-5-189">189</a></span>
<span class="normal"><a href="#__codelineno-5-190">190</a></span>
<span class="normal"><a href="#__codelineno-5-191">191</a></span>
<span class="normal"><a href="#__codelineno-5-192">192</a></span>
<span class="normal"><a href="#__codelineno-5-193">193</a></span>
<span class="normal"><a href="#__codelineno-5-194">194</a></span>
<span class="normal"><a href="#__codelineno-5-195">195</a></span>
<span class="normal"><a href="#__codelineno-5-196">196</a></span>
<span class="normal"><a href="#__codelineno-5-197">197</a></span>
<span class="normal"><a href="#__codelineno-5-198">198</a></span>
<span class="normal"><a href="#__codelineno-5-199">199</a></span>
<span class="normal"><a href="#__codelineno-5-200">200</a></span>
<span class="normal"><a href="#__codelineno-5-201">201</a></span>
<span class="normal"><a href="#__codelineno-5-202">202</a></span>
<span class="normal"><a href="#__codelineno-5-203">203</a></span>
<span class="normal"><a href="#__codelineno-5-204">204</a></span>
<span class="normal"><a href="#__codelineno-5-205">205</a></span>
<span class="normal"><a href="#__codelineno-5-206">206</a></span>
<span class="normal"><a href="#__codelineno-5-207">207</a></span>
<span class="normal"><a href="#__codelineno-5-208">208</a></span>
<span class="normal"><a href="#__codelineno-5-209">209</a></span>
<span class="normal"><a href="#__codelineno-5-210">210</a></span>
<span class="normal"><a href="#__codelineno-5-211">211</a></span>
<span class="normal"><a href="#__codelineno-5-212">212</a></span>
<span class="normal"><a href="#__codelineno-5-213">213</a></span>
<span class="normal"><a href="#__codelineno-5-214">214</a></span>
<span class="normal"><a href="#__codelineno-5-215">215</a></span>
<span class="normal"><a href="#__codelineno-5-216">216</a></span>
<span class="normal"><a href="#__codelineno-5-217">217</a></span>
<span class="normal"><a href="#__codelineno-5-218">218</a></span>
<span class="normal"><a href="#__codelineno-5-219">219</a></span>
<span class="normal"><a href="#__codelineno-5-220">220</a></span>
<span class="normal"><a href="#__codelineno-5-221">221</a></span>
<span class="normal"><a href="#__codelineno-5-222">222</a></span>
<span class="normal"><a href="#__codelineno-5-223">223</a></span>
<span class="normal"><a href="#__codelineno-5-224">224</a></span>
<span class="normal"><a href="#__codelineno-5-225">225</a></span>
<span class="normal"><a href="#__codelineno-5-226">226</a></span>
<span class="normal"><a href="#__codelineno-5-227">227</a></span>
<span class="normal"><a href="#__codelineno-5-228">228</a></span>
<span class="normal"><a href="#__codelineno-5-229">229</a></span>
<span class="normal"><a href="#__codelineno-5-230">230</a></span>
<span class="normal"><a href="#__codelineno-5-231">231</a></span>
<span class="normal"><a href="#__codelineno-5-232">232</a></span>
<span class="normal"><a href="#__codelineno-5-233">233</a></span>
<span class="normal"><a href="#__codelineno-5-234">234</a></span>
<span class="normal"><a href="#__codelineno-5-235">235</a></span>
<span class="normal"><a href="#__codelineno-5-236">236</a></span>
<span class="normal"><a href="#__codelineno-5-237">237</a></span>
<span class="normal"><a href="#__codelineno-5-238">238</a></span>
<span class="normal"><a href="#__codelineno-5-239">239</a></span>
<span class="normal"><a href="#__codelineno-5-240">240</a></span>
<span class="normal"><a href="#__codelineno-5-241">241</a></span>
<span class="normal"><a href="#__codelineno-5-242">242</a></span>
<span class="normal"><a href="#__codelineno-5-243">243</a></span>
<span class="normal"><a href="#__codelineno-5-244">244</a></span>
<span class="normal"><a href="#__codelineno-5-245">245</a></span>
<span class="normal"><a href="#__codelineno-5-246">246</a></span>
<span class="normal"><a href="#__codelineno-5-247">247</a></span>
<span class="normal"><a href="#__codelineno-5-248">248</a></span>
<span class="normal"><a href="#__codelineno-5-249">249</a></span>
<span class="normal"><a href="#__codelineno-5-250">250</a></span>
<span class="normal"><a href="#__codelineno-5-251">251</a></span>
<span class="normal"><a href="#__codelineno-5-252">252</a></span>
<span class="normal"><a href="#__codelineno-5-253">253</a></span>
<span class="normal"><a href="#__codelineno-5-254">254</a></span>
<span class="normal"><a href="#__codelineno-5-255">255</a></span>
<span class="normal"><a href="#__codelineno-5-256">256</a></span>
<span class="normal"><a href="#__codelineno-5-257">257</a></span>
<span class="normal"><a href="#__codelineno-5-258">258</a></span>
<span class="normal"><a href="#__codelineno-5-259">259</a></span>
<span class="normal"><a href="#__codelineno-5-260">260</a></span>
<span class="normal"><a href="#__codelineno-5-261">261</a></span>
<span class="normal"><a href="#__codelineno-5-262">262</a></span>
<span class="normal"><a href="#__codelineno-5-263">263</a></span>
<span class="normal"><a href="#__codelineno-5-264">264</a></span>
<span class="normal"><a href="#__codelineno-5-265">265</a></span>
<span class="normal"><a href="#__codelineno-5-266">266</a></span>
<span class="normal"><a href="#__codelineno-5-267">267</a></span>
<span class="normal"><a href="#__codelineno-5-268">268</a></span>
<span class="normal"><a href="#__codelineno-5-269">269</a></span>
<span class="normal"><a href="#__codelineno-5-270">270</a></span>
<span class="normal"><a href="#__codelineno-5-271">271</a></span>
<span class="normal"><a href="#__codelineno-5-272">272</a></span>
<span class="normal"><a href="#__codelineno-5-273">273</a></span>
<span class="normal"><a href="#__codelineno-5-274">274</a></span>
<span class="normal"><a href="#__codelineno-5-275">275</a></span>
<span class="normal"><a href="#__codelineno-5-276">276</a></span>
<span class="normal"><a href="#__codelineno-5-277">277</a></span>
<span class="normal"><a href="#__codelineno-5-278">278</a></span>
<span class="normal"><a href="#__codelineno-5-279">279</a></span>
<span class="normal"><a href="#__codelineno-5-280">280</a></span>
<span class="normal"><a href="#__codelineno-5-281">281</a></span>
<span class="normal"><a href="#__codelineno-5-282">282</a></span>
<span class="normal"><a href="#__codelineno-5-283">283</a></span>
<span class="normal"><a href="#__codelineno-5-284">284</a></span>
<span class="normal"><a href="#__codelineno-5-285">285</a></span>
<span class="normal"><a href="#__codelineno-5-286">286</a></span>
<span class="normal"><a href="#__codelineno-5-287">287</a></span>
<span class="normal"><a href="#__codelineno-5-288">288</a></span>
<span class="normal"><a href="#__codelineno-5-289">289</a></span>
<span class="normal"><a href="#__codelineno-5-290">290</a></span>
<span class="normal"><a href="#__codelineno-5-291">291</a></span>
<span class="normal"><a href="#__codelineno-5-292">292</a></span>
<span class="normal"><a href="#__codelineno-5-293">293</a></span>
<span class="normal"><a href="#__codelineno-5-294">294</a></span>
<span class="normal"><a href="#__codelineno-5-295">295</a></span>
<span class="normal"><a href="#__codelineno-5-296">296</a></span>
<span class="normal"><a href="#__codelineno-5-297">297</a></span>
<span class="normal"><a href="#__codelineno-5-298">298</a></span>
<span class="normal"><a href="#__codelineno-5-299">299</a></span>
<span class="normal"><a href="#__codelineno-5-300">300</a></span>
<span class="normal"><a href="#__codelineno-5-301">301</a></span>
<span class="normal"><a href="#__codelineno-5-302">302</a></span>
<span class="normal"><a href="#__codelineno-5-303">303</a></span>
<span class="normal"><a href="#__codelineno-5-304">304</a></span>
<span class="normal"><a href="#__codelineno-5-305">305</a></span>
<span class="normal"><a href="#__codelineno-5-306">306</a></span>
<span class="normal"><a href="#__codelineno-5-307">307</a></span>
<span class="normal"><a href="#__codelineno-5-308">308</a></span>
<span class="normal"><a href="#__codelineno-5-309">309</a></span>
<span class="normal"><a href="#__codelineno-5-310">310</a></span>
<span class="normal"><a href="#__codelineno-5-311">311</a></span>
<span class="normal"><a href="#__codelineno-5-312">312</a></span>
<span class="normal"><a href="#__codelineno-5-313">313</a></span>
<span class="normal"><a href="#__codelineno-5-314">314</a></span>
<span class="normal"><a href="#__codelineno-5-315">315</a></span>
<span class="normal"><a href="#__codelineno-5-316">316</a></span>
<span class="normal"><a href="#__codelineno-5-317">317</a></span>
<span class="normal"><a href="#__codelineno-5-318">318</a></span>
<span class="normal"><a href="#__codelineno-5-319">319</a></span>
<span class="normal"><a href="#__codelineno-5-320">320</a></span>
<span class="normal"><a href="#__codelineno-5-321">321</a></span>
<span class="normal"><a href="#__codelineno-5-322">322</a></span>
<span class="normal"><a href="#__codelineno-5-323">323</a></span>
<span class="normal"><a href="#__codelineno-5-324">324</a></span>
<span class="normal"><a href="#__codelineno-5-325">325</a></span>
<span class="normal"><a href="#__codelineno-5-326">326</a></span>
<span class="normal"><a href="#__codelineno-5-327">327</a></span>
<span class="normal"><a href="#__codelineno-5-328">328</a></span>
<span class="normal"><a href="#__codelineno-5-329">329</a></span>
<span class="normal"><a href="#__codelineno-5-330">330</a></span>
<span class="normal"><a href="#__codelineno-5-331">331</a></span>
<span class="normal"><a href="#__codelineno-5-332">332</a></span>
<span class="normal"><a href="#__codelineno-5-333">333</a></span>
<span class="normal"><a href="#__codelineno-5-334">334</a></span>
<span class="normal"><a href="#__codelineno-5-335">335</a></span>
<span class="normal"><a href="#__codelineno-5-336">336</a></span>
<span class="normal"><a href="#__codelineno-5-337">337</a></span>
<span class="normal"><a href="#__codelineno-5-338">338</a></span>
<span class="normal"><a href="#__codelineno-5-339">339</a></span>
<span class="normal"><a href="#__codelineno-5-340">340</a></span>
<span class="normal"><a href="#__codelineno-5-341">341</a></span>
<span class="normal"><a href="#__codelineno-5-342">342</a></span>
<span class="normal"><a href="#__codelineno-5-343">343</a></span>
<span class="normal"><a href="#__codelineno-5-344">344</a></span>
<span class="normal"><a href="#__codelineno-5-345">345</a></span>
<span class="normal"><a href="#__codelineno-5-346">346</a></span>
<span class="normal"><a href="#__codelineno-5-347">347</a></span>
<span class="normal"><a href="#__codelineno-5-348">348</a></span>
<span class="normal"><a href="#__codelineno-5-349">349</a></span>
<span class="normal"><a href="#__codelineno-5-350">350</a></span>
<span class="normal"><a href="#__codelineno-5-351">351</a></span>
<span class="normal"><a href="#__codelineno-5-352">352</a></span>
<span class="normal"><a href="#__codelineno-5-353">353</a></span>
<span class="normal"><a href="#__codelineno-5-354">354</a></span>
<span class="normal"><a href="#__codelineno-5-355">355</a></span>
<span class="normal"><a href="#__codelineno-5-356">356</a></span>
<span class="normal"><a href="#__codelineno-5-357">357</a></span>
<span class="normal"><a href="#__codelineno-5-358">358</a></span>
<span class="normal"><a href="#__codelineno-5-359">359</a></span>
<span class="normal"><a href="#__codelineno-5-360">360</a></span>
<span class="normal"><a href="#__codelineno-5-361">361</a></span>
<span class="normal"><a href="#__codelineno-5-362">362</a></span>
<span class="normal"><a href="#__codelineno-5-363">363</a></span>
<span class="normal"><a href="#__codelineno-5-364">364</a></span>
<span class="normal"><a href="#__codelineno-5-365">365</a></span>
<span class="normal"><a href="#__codelineno-5-366">366</a></span>
<span class="normal"><a href="#__codelineno-5-367">367</a></span>
<span class="normal"><a href="#__codelineno-5-368">368</a></span>
<span class="normal"><a href="#__codelineno-5-369">369</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtCore</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFileDialog</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QDockWidget</span><span class="p">,</span> <span class="n">QListWidget</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtGui</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">face_recognition</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageFont</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="c1"># çª—å£ä¸»ç±»</span>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="k">class</span><span class="w"> </span><span class="nc">MainWindow</span><span class="p">(</span><span class="n">QTabWidget</span><span class="p">):</span>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a>    <span class="c1"># åŸºæœ¬é…ç½®ä¸åŠ¨ï¼Œç„¶ååªåŠ¨ç¬¬ä¸‰ä¸ªç•Œé¢</span>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a>        <span class="c1"># åˆå§‹åŒ–è®¾ç½®</span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;å®æ—¶äººè„¸è¯†åˆ«ç³»ç»Ÿ&#39;</span><span class="p">)</span>
<a id="__codelineno-5-21" name="__codelineno-5-21"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">1100</span><span class="p">,</span> <span class="mi">650</span><span class="p">)</span>
<a id="__codelineno-5-22" name="__codelineno-5-22"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="s2">&quot;UI_images/faxian.png&quot;</span><span class="p">))</span>
<a id="__codelineno-5-23" name="__codelineno-5-23"></a>        <span class="c1"># è¦ä¸Šä¼ çš„å›¾ç‰‡è·¯å¾„</span>
<a id="__codelineno-5-24" name="__codelineno-5-24"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-5-25" name="__codelineno-5-25"></a>        <span class="c1"># è¦æ£€æµ‹çš„å›¾ç‰‡åç§°</span>
<a id="__codelineno-5-26" name="__codelineno-5-26"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_fname</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-5-27" name="__codelineno-5-27"></a>        <span class="c1"># è¦æ£€æµ‹çš„è§†é¢‘åç§°</span>
<a id="__codelineno-5-28" name="__codelineno-5-28"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-5-29" name="__codelineno-5-29"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-5-30" name="__codelineno-5-30"></a>        <span class="c1"># åˆå§‹åŒ–ä¸­æ­¢äº‹ä»¶</span>
<a id="__codelineno-5-31" name="__codelineno-5-31"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
<a id="__codelineno-5-32" name="__codelineno-5-32"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-5-33" name="__codelineno-5-33"></a>        <span class="c1"># åˆå§‹åŒ–äººè„¸å‘é‡</span>
<a id="__codelineno-5-34" name="__codelineno-5-34"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">known_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">known_encodings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initFaces</span><span class="p">()</span>
<a id="__codelineno-5-35" name="__codelineno-5-35"></a>        <span class="c1"># åŠ è½½lbpæ£€æµ‹å™¨</span>
<a id="__codelineno-5-36" name="__codelineno-5-36"></a>        <span class="c1"># åŠ è½½äººè„¸è¯†åˆ«æ¨¡å‹</span>
<a id="__codelineno-5-37" name="__codelineno-5-37"></a>        <span class="c1"># åˆå§‹åŒ–ç•Œé¢</span>
<a id="__codelineno-5-38" name="__codelineno-5-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>
<a id="__codelineno-5-39" name="__codelineno-5-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-5-40" name="__codelineno-5-40"></a>
<a id="__codelineno-5-41" name="__codelineno-5-41"></a>    <span class="c1"># åˆå§‹åŒ–æ•°æ®åº“çš„äººè„¸</span>
<a id="__codelineno-5-42" name="__codelineno-5-42"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">initFaces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-43" name="__codelineno-5-43"></a>        <span class="c1"># å­˜å‚¨çŸ¥é“äººååˆ—è¡¨</span>
<a id="__codelineno-5-44" name="__codelineno-5-44"></a>        <span class="n">known_names</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-5-45" name="__codelineno-5-45"></a>        <span class="c1"># å­˜å‚¨çŸ¥é“çš„ç‰¹å¾å€¼</span>
<a id="__codelineno-5-46" name="__codelineno-5-46"></a>        <span class="n">known_encodings</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-5-47" name="__codelineno-5-47"></a>        <span class="c1"># éå†å­˜å‚¨äººè„¸å›¾ç‰‡çš„æ–‡ä»¶å¤¹</span>
<a id="__codelineno-5-48" name="__codelineno-5-48"></a>        <span class="n">db_folder</span> <span class="o">=</span> <span class="s2">&quot;images/db_faces&quot;</span>
<a id="__codelineno-5-49" name="__codelineno-5-49"></a>        <span class="n">face_imgs</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">db_folder</span><span class="p">)</span>
<a id="__codelineno-5-50" name="__codelineno-5-50"></a>        <span class="c1"># éå†å›¾ç‰‡ï¼Œå°†äººè„¸å›¾ç‰‡è½¬åŒ–ä¸ºå‘é‡</span>
<a id="__codelineno-5-51" name="__codelineno-5-51"></a>        <span class="k">for</span> <span class="n">face_img</span> <span class="ow">in</span> <span class="n">face_imgs</span><span class="p">:</span>
<a id="__codelineno-5-52" name="__codelineno-5-52"></a>            <span class="n">face_img_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">db_folder</span><span class="p">,</span> <span class="n">face_img</span><span class="p">)</span>
<a id="__codelineno-5-53" name="__codelineno-5-53"></a>            <span class="n">face_name</span> <span class="o">=</span> <span class="n">face_img</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-5-54" name="__codelineno-5-54"></a>            <span class="n">load_image</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">load_image_file</span><span class="p">(</span><span class="n">face_img_path</span><span class="p">)</span>  <span class="c1"># åŠ è½½å›¾ç‰‡</span>
<a id="__codelineno-5-55" name="__codelineno-5-55"></a>            <span class="n">image_face_encoding</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_encodings</span><span class="p">(</span><span class="n">load_image</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># è·å¾—128ç»´ç‰¹å¾å€¼</span>
<a id="__codelineno-5-56" name="__codelineno-5-56"></a>            <span class="n">known_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">face_name</span><span class="p">)</span>  <span class="c1"># æ·»åŠ åˆ°äººåçš„åˆ—è¡¨</span>
<a id="__codelineno-5-57" name="__codelineno-5-57"></a>            <span class="n">known_encodings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image_face_encoding</span><span class="p">)</span>  <span class="c1"># æ·»åŠ åˆ°å‘é‡çš„åˆ—è¡¨</span>
<a id="__codelineno-5-58" name="__codelineno-5-58"></a>        <span class="k">return</span> <span class="n">known_names</span><span class="p">,</span> <span class="n">known_encodings</span>
<a id="__codelineno-5-59" name="__codelineno-5-59"></a>
<a id="__codelineno-5-60" name="__codelineno-5-60"></a>    <span class="c1"># åˆå§‹åŒ–ç•Œé¢</span>
<a id="__codelineno-5-61" name="__codelineno-5-61"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-62" name="__codelineno-5-62"></a>        <span class="c1"># è®¾ç½®å­—ä½“</span>
<a id="__codelineno-5-63" name="__codelineno-5-63"></a>        <span class="n">font_v</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;æ¥·ä½“&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-5-64" name="__codelineno-5-64"></a>        <span class="n">generally_font</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;æ¥·ä½“&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<a id="__codelineno-5-65" name="__codelineno-5-65"></a>        <span class="c1"># å›¾ç‰‡æ£€æµ‹</span>
<a id="__codelineno-5-66" name="__codelineno-5-66"></a>        <span class="n">img_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<a id="__codelineno-5-67" name="__codelineno-5-67"></a>        <span class="n">img_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<a id="__codelineno-5-68" name="__codelineno-5-68"></a>        <span class="n">img_f_title</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;ä¸Šä¼ äººè„¸å›¾åƒ&quot;</span><span class="p">)</span>  <span class="c1"># è®¾ç½®æ ‡é¢˜</span>
<a id="__codelineno-5-69" name="__codelineno-5-69"></a>        <span class="n">img_f_title</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>  <span class="c1"># è®¾ç½®æ ‡é¢˜ä½ç½®ä¸ºå±…ä¸­</span>
<a id="__codelineno-5-70" name="__codelineno-5-70"></a>        <span class="n">img_f_title</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;æ¥·ä½“&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>  <span class="c1"># è®¾ç½®æ ‡é¢˜å­—ä½“å¤§å°</span>
<a id="__codelineno-5-71" name="__codelineno-5-71"></a>        <span class="c1"># todo è¦ä¸Šä¼ çš„äººè„¸å›¾åƒ</span>
<a id="__codelineno-5-72" name="__codelineno-5-72"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>  <span class="c1"># è®¾ç½®ç¬¬ä¸€ä¸ªç•Œé¢ä¸Šè¦æ˜¾ç¤ºçš„å›¾ç‰‡</span>
<a id="__codelineno-5-73" name="__codelineno-5-73"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;UI_images/zhuye.jpeg&quot;</span><span class="p">))</span>  <span class="c1"># åˆå§‹åŒ–è¦æ˜¾ç¤ºçš„å›¾ç‰‡</span>
<a id="__codelineno-5-74" name="__codelineno-5-74"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>  <span class="c1"># è®¾ç½®å›¾ç‰‡å±…ä¸­</span>
<a id="__codelineno-5-75" name="__codelineno-5-75"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">face_name</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>  <span class="c1"># è®¾ç½®å½“å‰å›¾ç‰‡å¯¹åº”çš„äººå</span>
<a id="__codelineno-5-76" name="__codelineno-5-76"></a>        <span class="n">img_up_btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;ä¸Šä¼ å›¾ç‰‡&quot;</span><span class="p">)</span>  <span class="c1"># è®¾ç½®ä¸Šä¼ å›¾ç‰‡çš„æŒ‰é’®</span>
<a id="__codelineno-5-77" name="__codelineno-5-77"></a>        <span class="n">img_det_btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;å¼€å§‹ä¸Šä¼ &quot;</span><span class="p">)</span>  <span class="c1"># è®¾ç½®å¼€å§‹ä¸Šä¼ çš„æŒ‰é’®</span>
<a id="__codelineno-5-78" name="__codelineno-5-78"></a>        <span class="n">img_up_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_img</span><span class="p">)</span>  <span class="c1"># è”ç³»åˆ°ç›¸å…³å‡½æ•°</span>
<a id="__codelineno-5-79" name="__codelineno-5-79"></a>        <span class="n">img_det_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_db_img</span><span class="p">)</span>  <span class="c1"># è¿æ¥åˆ°ç›¸å…³å‡½æ•°</span>
<a id="__codelineno-5-80" name="__codelineno-5-80"></a>        <span class="c1"># è®¾ç½®ç»„ä»¶çš„æ ·å¼</span>
<a id="__codelineno-5-81" name="__codelineno-5-81"></a>        <span class="n">img_up_btn</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">generally_font</span><span class="p">)</span>
<a id="__codelineno-5-82" name="__codelineno-5-82"></a>        <span class="n">img_det_btn</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">generally_font</span><span class="p">)</span>
<a id="__codelineno-5-83" name="__codelineno-5-83"></a>        <span class="n">img_up_btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-5-84" name="__codelineno-5-84"></a>                                 <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-5-85" name="__codelineno-5-85"></a>                                 <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-5-86" name="__codelineno-5-86"></a>                                 <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-5-87" name="__codelineno-5-87"></a>                                 <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-5-88" name="__codelineno-5-88"></a>                                 <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-5-89" name="__codelineno-5-89"></a>                                 <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-5-90" name="__codelineno-5-90"></a>        <span class="n">img_det_btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-5-91" name="__codelineno-5-91"></a>                                  <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-5-92" name="__codelineno-5-92"></a>                                  <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-5-93" name="__codelineno-5-93"></a>                                  <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-5-94" name="__codelineno-5-94"></a>                                  <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-5-95" name="__codelineno-5-95"></a>                                  <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-5-96" name="__codelineno-5-96"></a>                                  <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-5-97" name="__codelineno-5-97"></a>        <span class="c1"># å°†ç»„ä»¶æ·»åŠ åˆ°å¸ƒå±€ä¸Šï¼Œç„¶åè®¾ç½®ä¸»è¦çš„widgetä¸ºå½“å‰çš„å¸ƒå±€</span>
<a id="__codelineno-5-98" name="__codelineno-5-98"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">img_f_title</span><span class="p">)</span>
<a id="__codelineno-5-99" name="__codelineno-5-99"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="p">)</span>
<a id="__codelineno-5-100" name="__codelineno-5-100"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">face_name</span><span class="p">)</span>
<a id="__codelineno-5-101" name="__codelineno-5-101"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">img_up_btn</span><span class="p">)</span>
<a id="__codelineno-5-102" name="__codelineno-5-102"></a>        <span class="n">img_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">img_det_btn</span><span class="p">)</span>
<a id="__codelineno-5-103" name="__codelineno-5-103"></a>        <span class="n">img_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">img_layout</span><span class="p">)</span>
<a id="__codelineno-5-104" name="__codelineno-5-104"></a>
<a id="__codelineno-5-105" name="__codelineno-5-105"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-5-106" name="__codelineno-5-106"></a><span class="sd">        *** 4. è§†é¢‘è¯†åˆ«ç•Œé¢ ***</span>
<a id="__codelineno-5-107" name="__codelineno-5-107"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-5-108" name="__codelineno-5-108"></a>        <span class="n">video_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<a id="__codelineno-5-109" name="__codelineno-5-109"></a>        <span class="n">video_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<a id="__codelineno-5-110" name="__codelineno-5-110"></a>        <span class="c1"># è®¾ç½®è§†é¢‘è¯†åˆ«åŒºçš„æ ‡é¢˜</span>
<a id="__codelineno-5-111" name="__codelineno-5-111"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;è§†é¢‘è¯†åˆ«åŒº&quot;</span><span class="p">)</span>
<a id="__codelineno-5-112" name="__codelineno-5-112"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-5-113" name="__codelineno-5-113"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-5-114" name="__codelineno-5-114"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-5-115" name="__codelineno-5-115"></a>        <span class="c1"># è®¾ç½®æ˜¾ç¤ºçš„ç•Œé¢</span>
<a id="__codelineno-5-116" name="__codelineno-5-116"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>
<a id="__codelineno-5-117" name="__codelineno-5-117"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
<a id="__codelineno-5-118" name="__codelineno-5-118"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;æ£€æµ‹æ‘„åƒå¤´&quot;</span><span class="p">)</span>
<a id="__codelineno-5-119" name="__codelineno-5-119"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-5-120" name="__codelineno-5-120"></a>        <span class="c1"># è®¾ç½®æ‰“å¼€æ‘„åƒå¤´çš„æŒ‰é’®å’Œæ ·å¼</span>
<a id="__codelineno-5-121" name="__codelineno-5-121"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-5-122" name="__codelineno-5-122"></a>                                          <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-5-123" name="__codelineno-5-123"></a>                                          <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-5-124" name="__codelineno-5-124"></a>                                          <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-5-125" name="__codelineno-5-125"></a>                                          <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-5-126" name="__codelineno-5-126"></a>                                          <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-5-127" name="__codelineno-5-127"></a>                                          <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-5-128" name="__codelineno-5-128"></a>        <span class="c1"># è®¾ç½®é€‰æ‹©æ–‡ä»¶çš„çš„æŒ‰é’®å’Œæ ·å¼</span>
<a id="__codelineno-5-129" name="__codelineno-5-129"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;å¼€å§‹è¯†åˆ«ï¼ˆé€‰æ‹©æ–‡ä»¶ï¼‰&quot;</span><span class="p">)</span>
<a id="__codelineno-5-130" name="__codelineno-5-130"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-5-131" name="__codelineno-5-131"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-5-132" name="__codelineno-5-132"></a>                                    <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-5-133" name="__codelineno-5-133"></a>                                    <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-5-134" name="__codelineno-5-134"></a>                                    <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-5-135" name="__codelineno-5-135"></a>                                    <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-5-136" name="__codelineno-5-136"></a>                                    <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-5-137" name="__codelineno-5-137"></a>                                    <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-5-138" name="__codelineno-5-138"></a>        <span class="c1"># è®¾ç½®ç»“æŸæ¼”ç¤ºçš„æŒ‰é’®å’Œæ ·å¼</span>
<a id="__codelineno-5-139" name="__codelineno-5-139"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;ç»“æŸæ£€æµ‹&quot;</span><span class="p">)</span>
<a id="__codelineno-5-140" name="__codelineno-5-140"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font_v</span><span class="p">)</span>
<a id="__codelineno-5-141" name="__codelineno-5-141"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QPushButton{color:white}&quot;</span>
<a id="__codelineno-5-142" name="__codelineno-5-142"></a>                                     <span class="s2">&quot;QPushButton:hover{background-color: rgb(2,110,180);}&quot;</span>
<a id="__codelineno-5-143" name="__codelineno-5-143"></a>                                     <span class="s2">&quot;QPushButton{background-color:rgb(48,124,208)}&quot;</span>
<a id="__codelineno-5-144" name="__codelineno-5-144"></a>                                     <span class="s2">&quot;QPushButton{border:2px}&quot;</span>
<a id="__codelineno-5-145" name="__codelineno-5-145"></a>                                     <span class="s2">&quot;QPushButton{border-radius:5px}&quot;</span>
<a id="__codelineno-5-146" name="__codelineno-5-146"></a>                                     <span class="s2">&quot;QPushButton{padding:5px 5px}&quot;</span>
<a id="__codelineno-5-147" name="__codelineno-5-147"></a>                                     <span class="s2">&quot;QPushButton{margin:5px 5px}&quot;</span><span class="p">)</span>
<a id="__codelineno-5-148" name="__codelineno-5-148"></a>        <span class="c1"># å°†ç»„ä»¶æ·»åŠ åˆ°å¸ƒå±€ä¸Š</span>
<a id="__codelineno-5-149" name="__codelineno-5-149"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_local</span><span class="p">)</span>
<a id="__codelineno-5-150" name="__codelineno-5-150"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">)</span>
<a id="__codelineno-5-151" name="__codelineno-5-151"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
<a id="__codelineno-5-152" name="__codelineno-5-152"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-5-153" name="__codelineno-5-153"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video_title2</span><span class="p">)</span>
<a id="__codelineno-5-154" name="__codelineno-5-154"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="p">)</span>
<a id="__codelineno-5-155" name="__codelineno-5-155"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-5-156" name="__codelineno-5-156"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_open_rsmtp</span><span class="p">)</span>
<a id="__codelineno-5-157" name="__codelineno-5-157"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="p">)</span>
<a id="__codelineno-5-158" name="__codelineno-5-158"></a>        <span class="n">video_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="p">)</span>
<a id="__codelineno-5-159" name="__codelineno-5-159"></a>        <span class="n">video_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">video_layout</span><span class="p">)</span>
<a id="__codelineno-5-160" name="__codelineno-5-160"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-5-161" name="__codelineno-5-161"></a><span class="sd">        *** 5. å…³äºç•Œé¢ ***</span>
<a id="__codelineno-5-162" name="__codelineno-5-162"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-5-163" name="__codelineno-5-163"></a>        <span class="n">about_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<a id="__codelineno-5-164" name="__codelineno-5-164"></a>        <span class="n">about_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<a id="__codelineno-5-165" name="__codelineno-5-165"></a>        <span class="n">about_title</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;æ¬¢è¿ä½¿ç”¨äººè„¸æ£€æµ‹ç³»ç»Ÿ</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># todo ä¿®æ”¹æ¬¢è¿è¯è¯­</span>
<a id="__codelineno-5-166" name="__codelineno-5-166"></a>        <span class="n">about_title</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;æ¥·ä½“&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>
<a id="__codelineno-5-167" name="__codelineno-5-167"></a>        <span class="n">about_title</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-5-168" name="__codelineno-5-168"></a>        <span class="n">about_img</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>
<a id="__codelineno-5-169" name="__codelineno-5-169"></a>        <span class="n">about_img</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s1">&#39;UI_images/san.png&#39;</span><span class="p">))</span>
<a id="__codelineno-5-170" name="__codelineno-5-170"></a>        <span class="n">about_img</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<a id="__codelineno-5-171" name="__codelineno-5-171"></a>
<a id="__codelineno-5-172" name="__codelineno-5-172"></a>        <span class="n">label_super</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>  <span class="c1"># todo æ›´æ¢ä½œè€…ä¿¡æ¯</span>
<a id="__codelineno-5-173" name="__codelineno-5-173"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&lt;a href=&#39;https://wcowin.work/&#39;&gt;--&gt;è”ç³»æˆ‘&lt;/a&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-5-174" name="__codelineno-5-174"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s1">&#39;æ¥·ä½“&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<a id="__codelineno-5-175" name="__codelineno-5-175"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setOpenExternalLinks</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-5-176" name="__codelineno-5-176"></a>        <span class="c1"># label_super.setOpenExternalLinks(True)</span>
<a id="__codelineno-5-177" name="__codelineno-5-177"></a>        <span class="n">label_super</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignRight</span><span class="p">)</span>
<a id="__codelineno-5-178" name="__codelineno-5-178"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">about_title</span><span class="p">)</span>
<a id="__codelineno-5-179" name="__codelineno-5-179"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
<a id="__codelineno-5-180" name="__codelineno-5-180"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">about_img</span><span class="p">)</span>
<a id="__codelineno-5-181" name="__codelineno-5-181"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
<a id="__codelineno-5-182" name="__codelineno-5-182"></a>        <span class="n">about_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label_super</span><span class="p">)</span>
<a id="__codelineno-5-183" name="__codelineno-5-183"></a>        <span class="n">about_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">about_layout</span><span class="p">)</span>
<a id="__codelineno-5-184" name="__codelineno-5-184"></a>        <span class="c1"># åˆ†åˆ«æ·»åŠ å­é¡µé¢</span>
<a id="__codelineno-5-185" name="__codelineno-5-185"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">img_widget</span><span class="p">,</span> <span class="s2">&quot;ä¸Šä¼ äººè„¸&quot;</span><span class="p">)</span>
<a id="__codelineno-5-186" name="__codelineno-5-186"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">video_widget</span><span class="p">,</span> <span class="s1">&#39;è§†é¢‘æ£€æµ‹&#39;</span><span class="p">)</span>
<a id="__codelineno-5-187" name="__codelineno-5-187"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">about_widget</span><span class="p">,</span> <span class="s1">&#39;å…³äº&#39;</span><span class="p">)</span>
<a id="__codelineno-5-188" name="__codelineno-5-188"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/å›¾ç‰‡.png&#39;</span><span class="p">))</span>
<a id="__codelineno-5-189" name="__codelineno-5-189"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/å›¾ç‰‡.png&#39;</span><span class="p">))</span>
<a id="__codelineno-5-190" name="__codelineno-5-190"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/ç›´æ’­.png&#39;</span><span class="p">))</span>
<a id="__codelineno-5-191" name="__codelineno-5-191"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setTabIcon</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;UI_images/logo_about.png&#39;</span><span class="p">))</span>
<a id="__codelineno-5-192" name="__codelineno-5-192"></a>
<a id="__codelineno-5-193" name="__codelineno-5-193"></a>    <span class="c1"># ç¬¬ä¸€ä¸ªç•Œé¢çš„å‡½æ•°</span>
<a id="__codelineno-5-194" name="__codelineno-5-194"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">up_img</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-195" name="__codelineno-5-195"></a>        <span class="c1"># æ‰“å¼€æ–‡ä»¶é€‰æ‹©æ¡†</span>
<a id="__codelineno-5-196" name="__codelineno-5-196"></a>        <span class="n">openfile_name</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;é€‰æ‹©æ–‡ä»¶&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Image files(*.jpg , *.png)&#39;</span><span class="p">)</span>
<a id="__codelineno-5-197" name="__codelineno-5-197"></a>        <span class="c1"># è·å–ä¸Šä¼ çš„æ–‡ä»¶åç§°</span>
<a id="__codelineno-5-198" name="__codelineno-5-198"></a>        <span class="n">img_name</span> <span class="o">=</span> <span class="n">openfile_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-5-199" name="__codelineno-5-199"></a>        <span class="k">if</span> <span class="n">img_name</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
<a id="__codelineno-5-200" name="__codelineno-5-200"></a>            <span class="k">pass</span>
<a id="__codelineno-5-201" name="__codelineno-5-201"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-5-202" name="__codelineno-5-202"></a>            <span class="c1"># ä¸Šä¼ ä¹‹åæ˜¾ç¤ºå¹¶åšå½’ä¸€åŒ–å¤„ç†</span>
<a id="__codelineno-5-203" name="__codelineno-5-203"></a>            <span class="n">src_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_name</span><span class="p">)</span>
<a id="__codelineno-5-204" name="__codelineno-5-204"></a>            <span class="n">src_img_height</span> <span class="o">=</span> <span class="n">src_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-5-205" name="__codelineno-5-205"></a>            <span class="n">src_img_width</span> <span class="o">=</span> <span class="n">src_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-5-206" name="__codelineno-5-206"></a>            <span class="n">target_img_height</span> <span class="o">=</span> <span class="mi">400</span>
<a id="__codelineno-5-207" name="__codelineno-5-207"></a>            <span class="n">ratio</span> <span class="o">=</span> <span class="n">target_img_height</span> <span class="o">/</span> <span class="n">src_img_height</span>
<a id="__codelineno-5-208" name="__codelineno-5-208"></a>            <span class="n">target_img_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">src_img_width</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>
<a id="__codelineno-5-209" name="__codelineno-5-209"></a>            <span class="c1"># å°†å›¾ç‰‡ç»Ÿä¸€å¤„ç†åˆ°é«˜ä¸º400çš„å›¾ç‰‡ï¼Œæ–¹ä¾¿åœ¨ç•Œé¢ä¸Šæ˜¾ç¤º</span>
<a id="__codelineno-5-210" name="__codelineno-5-210"></a>            <span class="n">target_img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">src_img</span><span class="p">,</span> <span class="p">(</span><span class="n">target_img_width</span><span class="p">,</span> <span class="n">target_img_height</span><span class="p">))</span>
<a id="__codelineno-5-211" name="__codelineno-5-211"></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span><span class="p">,</span> <span class="n">target_img</span><span class="p">)</span>
<a id="__codelineno-5-212" name="__codelineno-5-212"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">img_f_img</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span><span class="p">))</span>
<a id="__codelineno-5-213" name="__codelineno-5-213"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span> <span class="o">=</span> <span class="s2">&quot;UI_images/tmp/toup.jpg&quot;</span>
<a id="__codelineno-5-214" name="__codelineno-5-214"></a>
<a id="__codelineno-5-215" name="__codelineno-5-215"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">up_db_img</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-216" name="__codelineno-5-216"></a>        <span class="n">face_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_name</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
<a id="__codelineno-5-217" name="__codelineno-5-217"></a>        <span class="c1"># Convert the face name to a utf-8 encoded string</span>
<a id="__codelineno-5-218" name="__codelineno-5-218"></a>        <span class="n">face_name</span> <span class="o">=</span> <span class="n">face_name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-5-219" name="__codelineno-5-219"></a>
<a id="__codelineno-5-220" name="__codelineno-5-220"></a>        <span class="k">if</span> <span class="n">face_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
<a id="__codelineno-5-221" name="__codelineno-5-221"></a>            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ä¸èƒ½ä¸ºç©º&quot;</span><span class="p">,</span> <span class="s2">&quot;è¯·å¡«å†™äººè„¸å§“å&quot;</span><span class="p">)</span>
<a id="__codelineno-5-222" name="__codelineno-5-222"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-5-223" name="__codelineno-5-223"></a>            <span class="n">load_image</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">load_image_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span><span class="p">)</span>
<a id="__codelineno-5-224" name="__codelineno-5-224"></a>            <span class="n">image_face_encoding</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_encodings</span><span class="p">(</span><span class="n">load_image</span><span class="p">)</span>
<a id="__codelineno-5-225" name="__codelineno-5-225"></a>            <span class="n">encoding_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">image_face_encoding</span><span class="p">)</span>
<a id="__codelineno-5-226" name="__codelineno-5-226"></a>            <span class="k">if</span> <span class="n">encoding_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-5-227" name="__codelineno-5-227"></a>                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;è¯·é‡æ–°ä¸Šä¼ &quot;</span><span class="p">,</span> <span class="s2">&quot;å½“å‰å›¾ç‰‡æ²¡æœ‰å‘ç°äººè„¸&quot;</span><span class="p">)</span>
<a id="__codelineno-5-228" name="__codelineno-5-228"></a>            <span class="k">elif</span> <span class="n">encoding_length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-5-229" name="__codelineno-5-229"></a>                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;è¯·é‡æ–°ä¸Šä¼ &quot;</span><span class="p">,</span> <span class="s2">&quot;å½“å‰å›¾ç‰‡å‘ç°å¤šå¼ äººè„¸&quot;</span><span class="p">)</span>
<a id="__codelineno-5-230" name="__codelineno-5-230"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-5-231" name="__codelineno-5-231"></a>                <span class="n">face_encoding</span> <span class="o">=</span> <span class="n">image_face_encoding</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-5-232" name="__codelineno-5-232"></a>                <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up_img_name</span><span class="p">)</span>
<a id="__codelineno-5-233" name="__codelineno-5-233"></a>                <span class="n">img_path</span> <span class="o">=</span> <span class="n">face_name</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span>
<a id="__codelineno-5-234" name="__codelineno-5-234"></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;images/db_faces/&quot;</span> <span class="o">+</span> <span class="n">img_path</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
<a id="__codelineno-5-235" name="__codelineno-5-235"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">known_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">face_name</span><span class="p">)</span>
<a id="__codelineno-5-236" name="__codelineno-5-236"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">known_encodings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">face_encoding</span><span class="p">)</span>
<a id="__codelineno-5-237" name="__codelineno-5-237"></a>                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ä¸Šä¼ æˆåŠŸ&quot;</span><span class="p">,</span> <span class="s2">&quot;æ•°æ®å·²ä¸Šä¼ ï¼&quot;</span><span class="p">)</span>
<a id="__codelineno-5-238" name="__codelineno-5-238"></a>
<a id="__codelineno-5-239" name="__codelineno-5-239"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-5-240" name="__codelineno-5-240"></a><span class="sd">    ### 3. è§†é¢‘è¯†åˆ«ç›¸å…³åŠŸèƒ½ ### </span>
<a id="__codelineno-5-241" name="__codelineno-5-241"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-5-242" name="__codelineno-5-242"></a>
<a id="__codelineno-5-243" name="__codelineno-5-243"></a>    <span class="c1"># å…³é—­äº‹ä»¶ è¯¢é—®ç”¨æˆ·æ˜¯å¦é€€å‡º</span>
<a id="__codelineno-5-244" name="__codelineno-5-244"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">closeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<a id="__codelineno-5-245" name="__codelineno-5-245"></a>        <span class="n">reply</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-5-246" name="__codelineno-5-246"></a>                                     <span class="s1">&#39;é€€å‡º&#39;</span><span class="p">,</span>
<a id="__codelineno-5-247" name="__codelineno-5-247"></a>                                     <span class="s2">&quot;æ˜¯å¦è¦é€€å‡ºç¨‹åºï¼Ÿ&quot;</span><span class="p">,</span>
<a id="__codelineno-5-248" name="__codelineno-5-248"></a>                                     <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">,</span>
<a id="__codelineno-5-249" name="__codelineno-5-249"></a>                                     <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
<a id="__codelineno-5-250" name="__codelineno-5-250"></a>        <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
<a id="__codelineno-5-251" name="__codelineno-5-251"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-5-252" name="__codelineno-5-252"></a>            <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
<a id="__codelineno-5-253" name="__codelineno-5-253"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-5-254" name="__codelineno-5-254"></a>            <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
<a id="__codelineno-5-255" name="__codelineno-5-255"></a>
<a id="__codelineno-5-256" name="__codelineno-5-256"></a>    <span class="c1"># è¯»å–å½•åƒæ–‡ä»¶</span>
<a id="__codelineno-5-257" name="__codelineno-5-257"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-258" name="__codelineno-5-258"></a>        <span class="c1"># é€‰æ‹©å½•åƒæ–‡ä»¶è¿›è¡Œè¯»å–</span>
<a id="__codelineno-5-259" name="__codelineno-5-259"></a>        <span class="n">mp4_fileName</span><span class="p">,</span> <span class="n">fileType</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Choose file&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;*.mp4&#39;</span><span class="p">)</span>
<a id="__codelineno-5-260" name="__codelineno-5-260"></a>        <span class="k">if</span> <span class="n">mp4_fileName</span><span class="p">:</span>
<a id="__codelineno-5-261" name="__codelineno-5-261"></a>            <span class="c1"># å¯åŠ¨å½•åƒæ–‡ä»¶è¯»å–å¾—çº¿ç¨‹å¹¶åœ¨ç”»é¢ä¸Šå®æ—¶æ˜¾ç¤º</span>
<a id="__codelineno-5-262" name="__codelineno-5-262"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">mp4_fileName</span>
<a id="__codelineno-5-263" name="__codelineno-5-263"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-5-264" name="__codelineno-5-264"></a>            <span class="n">th</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_video</span><span class="p">)</span>
<a id="__codelineno-5-265" name="__codelineno-5-265"></a>            <span class="n">th</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-5-266" name="__codelineno-5-266"></a>
<a id="__codelineno-5-267" name="__codelineno-5-267"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open_local</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-268" name="__codelineno-5-268"></a>        <span class="c1"># é€‰æ‹©å½•åƒæ–‡ä»¶è¿›è¡Œè¯»å–</span>
<a id="__codelineno-5-269" name="__codelineno-5-269"></a>        <span class="n">mp4_filename</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-5-270" name="__codelineno-5-270"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">mp4_filename</span>
<a id="__codelineno-5-271" name="__codelineno-5-271"></a>        <span class="c1"># è¯»å–æ‘„åƒå¤´è¿›è¡Œå®æ—¶å¾—æ˜¾ç¤º</span>
<a id="__codelineno-5-272" name="__codelineno-5-272"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-5-273" name="__codelineno-5-273"></a>        <span class="n">th</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_video</span><span class="p">)</span>
<a id="__codelineno-5-274" name="__codelineno-5-274"></a>        <span class="n">th</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-5-275" name="__codelineno-5-275"></a>
<a id="__codelineno-5-276" name="__codelineno-5-276"></a>    <span class="c1"># é€€å‡ºè¿›ç¨‹</span>
<a id="__codelineno-5-277" name="__codelineno-5-277"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-278" name="__codelineno-5-278"></a>        <span class="c1"># ç‚¹å‡»å…³é—­æŒ‰é’®åé‡æ–°åˆå§‹åŒ–ç•Œé¢</span>
<a id="__codelineno-5-279" name="__codelineno-5-279"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<a id="__codelineno-5-280" name="__codelineno-5-280"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-5-281" name="__codelineno-5-281"></a>
<a id="__codelineno-5-282" name="__codelineno-5-282"></a>    <span class="c1">#è½¬æ¢ä¸­æ–‡æ˜¾ç¤º</span>
<a id="__codelineno-5-283" name="__codelineno-5-283"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nameText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">textColor</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">textSize</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
<a id="__codelineno-5-284" name="__codelineno-5-284"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>  <span class="c1"># åˆ¤æ–­æ˜¯å¦OpenCVå›¾ç‰‡ç±»å‹</span>
<a id="__codelineno-5-285" name="__codelineno-5-285"></a>            <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<a id="__codelineno-5-286" name="__codelineno-5-286"></a>        <span class="c1"># åˆ›å»ºä¸€ä¸ªå¯ä»¥åœ¨ç»™å®šå›¾åƒä¸Šç»˜å›¾çš„å¯¹è±¡</span>
<a id="__codelineno-5-287" name="__codelineno-5-287"></a>        <span class="n">face_draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<a id="__codelineno-5-288" name="__codelineno-5-288"></a>        <span class="c1"># æ˜¾ç¤ºå­—ä½“çš„æ ¼å¼</span>
<a id="__codelineno-5-289" name="__codelineno-5-289"></a>        <span class="n">name_font</span><span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;simsun.ttc&quot;</span><span class="p">,</span> <span class="n">textSize</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<a id="__codelineno-5-290" name="__codelineno-5-290"></a>        <span class="c1"># ç»˜åˆ¶äººè„¸åç§°æ–‡æœ¬</span>
<a id="__codelineno-5-291" name="__codelineno-5-291"></a>        <span class="n">face_draw</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">textColor</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">name_font</span><span class="p">)</span>
<a id="__codelineno-5-292" name="__codelineno-5-292"></a>        <span class="c1"># è½¬æ¢å›OpenCVæ ¼å¼</span>
<a id="__codelineno-5-293" name="__codelineno-5-293"></a>        <span class="k">return</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2BGR</span><span class="p">)</span>
<a id="__codelineno-5-294" name="__codelineno-5-294"></a>
<a id="__codelineno-5-295" name="__codelineno-5-295"></a>    <span class="c1"># todo æ‰§è¡Œäººè„¸è¯†åˆ«ä¸»è¿›ç¨‹</span>
<a id="__codelineno-5-296" name="__codelineno-5-296"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_video</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-297" name="__codelineno-5-297"></a>        <span class="c1"># é¦–å…ˆæŠŠæ‰“å¼€æŒ‰é’®å…³é—­</span>
<a id="__codelineno-5-298" name="__codelineno-5-298"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-5-299" name="__codelineno-5-299"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-5-300" name="__codelineno-5-300"></a>        <span class="n">process_this_frame</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-5-301" name="__codelineno-5-301"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-5-302" name="__codelineno-5-302"></a>            <span class="n">ret</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># è¯»å–æ‘„åƒå¤´</span>
<a id="__codelineno-5-303" name="__codelineno-5-303"></a>            <span class="c1"># opencvçš„å›¾åƒæ˜¯BGRæ ¼å¼çš„ï¼Œè€Œæˆ‘ä»¬éœ€è¦æ˜¯çš„RGBæ ¼å¼çš„ï¼Œå› æ­¤éœ€è¦è¿›è¡Œä¸€ä¸ªè½¬æ¢ã€‚</span>
<a id="__codelineno-5-304" name="__codelineno-5-304"></a>            <span class="n">rgb_frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>  <span class="c1"># å°†å›¾åƒè½¬åŒ–ä¸ºrgbé¢œè‰²é€šé“</span>
<a id="__codelineno-5-305" name="__codelineno-5-305"></a>            <span class="c1"># gray_frame = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)</span>
<a id="__codelineno-5-306" name="__codelineno-5-306"></a>            <span class="c1"># æ£€æŸ¥äººè„¸ æŒ‰ç…§1.1å€æ”¾åˆ° å‘¨å›´æœ€å°åƒç´ ä¸º5</span>
<a id="__codelineno-5-307" name="__codelineno-5-307"></a>            <span class="c1"># face_zone = self.face_detect.detectMultiScale(gray_frame, scaleFactor=2, minNeighbors=2)  # maxSize = (55,55)</span>
<a id="__codelineno-5-308" name="__codelineno-5-308"></a>            <span class="k">if</span> <span class="n">process_this_frame</span><span class="p">:</span>
<a id="__codelineno-5-309" name="__codelineno-5-309"></a>                <span class="n">face_locations</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_locations</span><span class="p">(</span><span class="n">rgb_frame</span><span class="p">)</span>  <span class="c1"># è·å¾—æ‰€æœ‰äººè„¸ä½ç½®</span>
<a id="__codelineno-5-310" name="__codelineno-5-310"></a>                <span class="n">face_encodings</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">face_encodings</span><span class="p">(</span><span class="n">rgb_frame</span><span class="p">,</span> <span class="n">face_locations</span><span class="p">)</span>  <span class="c1"># è·å¾—äººè„¸ç‰¹å¾å€¼</span>
<a id="__codelineno-5-311" name="__codelineno-5-311"></a>                <span class="n">face_names</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># å­˜å‚¨å‡ºç°åœ¨ç”»é¢ä¸­äººè„¸çš„åå­—</span>
<a id="__codelineno-5-312" name="__codelineno-5-312"></a>                <span class="k">for</span> <span class="n">face_encoding</span> <span class="ow">in</span> <span class="n">face_encodings</span><span class="p">:</span>  <span class="c1"># å’Œæ•°æ®åº“äººè„¸è¿›è¡Œå¯¹æ¯”</span>
<a id="__codelineno-5-313" name="__codelineno-5-313"></a>                    <span class="c1"># å¦‚æœå½“å‰äººè„¸å’Œæ•°æ®åº“çš„äººè„¸çš„ç›¸ä¼¼åº¦è¶…è¿‡0.6ï¼Œåˆ™è®¤ä¸ºäººè„¸åŒ¹é…</span>
<a id="__codelineno-5-314" name="__codelineno-5-314"></a>                    <span class="n">matches</span> <span class="o">=</span> <span class="n">face_recognition</span><span class="o">.</span><span class="n">compare_faces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">known_encodings</span><span class="p">,</span> <span class="n">face_encoding</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<a id="__codelineno-5-315" name="__codelineno-5-315"></a>                    <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
<a id="__codelineno-5-316" name="__codelineno-5-316"></a>                        <span class="n">first_match_index</span> <span class="o">=</span> <span class="n">matches</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-5-317" name="__codelineno-5-317"></a>                        <span class="c1"># è¿”å›ç›¸ä¼¼åº¦æœ€é«˜çš„ä½œä¸ºå½“å‰äººè„¸çš„åç§°</span>
<a id="__codelineno-5-318" name="__codelineno-5-318"></a>                        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">known_names</span><span class="p">[</span><span class="n">first_match_index</span><span class="p">]</span>
<a id="__codelineno-5-319" name="__codelineno-5-319"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-5-320" name="__codelineno-5-320"></a>                        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;æœªçŸ¥äººè„¸&quot;</span>
<a id="__codelineno-5-321" name="__codelineno-5-321"></a>                    <span class="n">face_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-5-322" name="__codelineno-5-322"></a>            <span class="n">process_this_frame</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">process_this_frame</span>
<a id="__codelineno-5-323" name="__codelineno-5-323"></a>            <span class="c1"># å°†æ•æ‰åˆ°çš„äººè„¸æ˜¾ç¤ºå‡ºæ¥</span>
<a id="__codelineno-5-324" name="__codelineno-5-324"></a>            <span class="k">for</span> <span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">left</span><span class="p">),</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">face_locations</span><span class="p">,</span> <span class="n">face_names</span><span class="p">):</span>
<a id="__codelineno-5-325" name="__codelineno-5-325"></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">),</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">),</span> <span class="p">(</span><span class="mi">113</span><span class="p">,</span><span class="mi">152</span><span class="p">,</span><span class="mi">248</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># ç”»äººè„¸çŸ©å½¢æ¡†</span>
<a id="__codelineno-5-326" name="__codelineno-5-326"></a>                <span class="k">if</span> <span class="n">name</span><span class="o">!=</span><span class="s1">&#39;æœªçŸ¥äººè„¸&#39;</span><span class="p">:</span>
<a id="__codelineno-5-327" name="__codelineno-5-327"></a>                    <span class="n">name_list</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-5-328" name="__codelineno-5-328"></a>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_list</span><span class="p">)):</span>
<a id="__codelineno-5-329" name="__codelineno-5-329"></a>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-5-330" name="__codelineno-5-330"></a>                            <span class="n">name_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;*&quot;</span>
<a id="__codelineno-5-331" name="__codelineno-5-331"></a>                        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span> <span class="p">:</span>
<a id="__codelineno-5-332" name="__codelineno-5-332"></a>                            <span class="n">name_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;*&quot;</span>
<a id="__codelineno-5-333" name="__codelineno-5-333"></a>                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span>
<a id="__codelineno-5-334" name="__codelineno-5-334"></a>                <span class="n">frame</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nameText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">name</span><span class="p">,(</span><span class="n">left</span><span class="o">+</span><span class="mi">55</span><span class="p">,</span> <span class="n">bottom</span><span class="o">+</span><span class="mi">15</span><span class="p">),(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">30</span><span class="p">)</span>
<a id="__codelineno-5-335" name="__codelineno-5-335"></a>
<a id="__codelineno-5-336" name="__codelineno-5-336"></a>
<a id="__codelineno-5-337" name="__codelineno-5-337"></a>            <span class="c1"># ä¿å­˜å›¾ç‰‡å¹¶è¿›è¡Œå®æ—¶çš„æ˜¾ç¤º</span>
<a id="__codelineno-5-338" name="__codelineno-5-338"></a>            <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>
<a id="__codelineno-5-339" name="__codelineno-5-339"></a>            <span class="n">frame_height</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-5-340" name="__codelineno-5-340"></a>            <span class="n">frame_width</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-5-341" name="__codelineno-5-341"></a>            <span class="n">frame_scale</span> <span class="o">=</span> <span class="mi">500</span> <span class="o">/</span> <span class="n">frame_height</span>
<a id="__codelineno-5-342" name="__codelineno-5-342"></a>            <span class="n">frame_resize</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">frame_width</span> <span class="o">*</span> <span class="n">frame_scale</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_height</span> <span class="o">*</span> <span class="n">frame_scale</span><span class="p">)))</span>
<a id="__codelineno-5-343" name="__codelineno-5-343"></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;images/tmp.jpg&quot;</span><span class="p">,</span> <span class="n">frame_resize</span><span class="p">)</span>
<a id="__codelineno-5-344" name="__codelineno-5-344"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;images/tmp.jpg&quot;</span><span class="p">))</span>
<a id="__codelineno-5-345" name="__codelineno-5-345"></a>            <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-5-346" name="__codelineno-5-346"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stopEvent</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-5-347" name="__codelineno-5-347"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-5-348" name="__codelineno-5-348"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-5-349" name="__codelineno-5-349"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-5-350" name="__codelineno-5-350"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-5-351" name="__codelineno-5-351"></a>                <span class="k">break</span>
<a id="__codelineno-5-352" name="__codelineno-5-352"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_open</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-5-353" name="__codelineno-5-353"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">btn_close</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-5-354" name="__codelineno-5-354"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_down</span><span class="p">()</span>
<a id="__codelineno-5-355" name="__codelineno-5-355"></a>
<a id="__codelineno-5-356" name="__codelineno-5-356"></a>    <span class="c1"># åˆå§‹åŒ–è§†é¢‘æ£€æµ‹ç•Œé¢</span>
<a id="__codelineno-5-357" name="__codelineno-5-357"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_down</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-358" name="__codelineno-5-358"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">video_capture</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
<a id="__codelineno-5-359" name="__codelineno-5-359"></a>        <span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
<a id="__codelineno-5-360" name="__codelineno-5-360"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DisplayLabel</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;UI_images/ae862.jpg&quot;</span><span class="p">))</span>
<a id="__codelineno-5-361" name="__codelineno-5-361"></a>
<a id="__codelineno-5-362" name="__codelineno-5-362"></a>
<a id="__codelineno-5-363" name="__codelineno-5-363"></a>
<a id="__codelineno-5-364" name="__codelineno-5-364"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-5-365" name="__codelineno-5-365"></a>    <span class="c1"># åŠ è½½é¡µé¢</span>
<a id="__codelineno-5-366" name="__codelineno-5-366"></a>    <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<a id="__codelineno-5-367" name="__codelineno-5-367"></a>    <span class="n">mainWindow</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
<a id="__codelineno-5-368" name="__codelineno-5-368"></a>    <span class="n">mainWindow</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-5-369" name="__codelineno-5-369"></a>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<h2 id="_6">å‚è€ƒæ–‡çŒ®<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<p>[1] é¾™æ…§,æœ±å­Ÿæ˜¥,é‚“å¨…å€©ç­‰.åŸºäº OpenCV çš„æ™ºèƒ½æ ¡å›­äººè„¸é—¨ç¦ç³»ç»Ÿçš„è®¾è®¡ä¸å®ç°[J].å·¥ä¸šæ§åˆ¶ è®¡ç®—æœº,2023,36(09):73-75.<br />
[2] å†¯å©§,é¡¾æ¢…èŠ±.åŸºäº OpenCV çš„äººè„¸è¯†åˆ«ç®—æ³•ç ”ç©¶ä¸å®ç°[J].ç”µè„‘çŸ¥è¯†ä¸æŠ€ æœ¯,2020,16(14):3-5.DOI:10.14004/j.cnki.ckt.2020.1473<br />
[3] å»–å‘¨å®‡,ç‹é’°å©·,é™ˆç§‘è‰¯.åŸºäº OpenCV çš„äººè„¸è¯†åˆ«ç®—æ³•[J].ç”µå­æŠ€æœ¯ä¸è½¯ä»¶å·¥ ç¨‹,2020,(09):133-136.<br />
[4] æé¢–èª,é™ˆè´æ–‡,å»–æ™“èŠ³ç­‰.åŸºäº OpenCV çš„äººè„¸è¯†åˆ«ç³»ç»Ÿè®¾è®¡ä¸å®ç°[J].ç”µè„‘çŸ¥è¯†ä¸æŠ€ æœ¯,2022,18(18):53-55.DOI:10.14004/j.cnki.ckt.2022.1155<br />
[5] å¼ ç»¿äº‘,éŸ¦è‚–é›¨,æç³.åŸºäºPythonä¸OpenCVçš„äººè„¸è¯†åˆ«ç³»ç»Ÿè®¾è®¡ä¸å®ç°[J].ç”µè„‘çŸ¥è¯†ä¸æŠ€ æœ¯,2022,18(10):87-88.DOI:10.14004/j.cnki.ckt.2022.0783<br />
[6] é»„å®‰ç¥º, &amp; é™ˆäº‰å¥‡. (2017). åŸºäº OpenCV çš„äººè„¸è¯†åˆ«æŠ€æœ¯ç ”ç©¶. ç”µå­æŠ€æœ¯ä¸è½¯ä»¶å·¥ç¨‹, 16(13), 36-37.<br />
[7] éƒ‘äºšå†›, &amp; ç‹ä¸½å¨Ÿ. (2019). åŸºäº OpenCV çš„äººè„¸è¯†åˆ«æŠ€æœ¯ç ”ç©¶ä¸å®ç°. ç”µå­æŠ€æœ¯ä¸è½¯ä»¶å·¥ ç¨‹, 18(5), 46-48.<br />
[8] ç‹å¿—æ•, &amp; åˆ˜æ°. (2019). åŸºäº OpenCV çš„äººè„¸è¯†åˆ«ç®—æ³•ç ”ç©¶ä¸å®ç°. ç°ä»£è®¡ç®—æœº, (11), 26-28.<br />
[9] å¼ æµ·æ³¢, &amp; ç‹æŒ¯å. (2019). åŸºäº OpenCV çš„äººè„¸è¯†åˆ«ç®—æ³•ç ”ç©¶ä¸å®ç°. è®¡ç®—æœºä¸æ•°å­—å·¥ç¨‹, (6), 169-170.<br />
[10] èµµå®‡èˆª, &amp; å¼ æ™“è‰³. (2018). åŸºäº OpenCV çš„äººè„¸è¯†åˆ«ç®—æ³•ç ”ç©¶ä¸å®ç°. ç°ä»£è®¡ç®—æœº, (12), 16-18.</p>
<style>
.related-posts {
  margin-top: 1.5rem;
  padding-top: 0.75rem;
  border-top: 1px solid rgba(0,0,0,0.1);
  max-height: none !important; /* é˜²æ­¢Safarié”™è¯¯è®¡ç®—é«˜åº¦ */
  overflow: visible !important; /* é˜²æ­¢å†…å®¹è¢«æˆªæ–­ */
}
.related-posts h3 {
  margin-top: 0;
  margin-bottom: 0.5rem;
  font-size: 1.2rem;
  font-weight: 500;
  line-height: 1.3;
}
.related-posts ul {
  margin: 0 0 0.5rem 0 !important; /* å¼ºåˆ¶è¦†ç›–å¯èƒ½çš„å†²çªæ ·å¼ */
  padding-left: 1.5rem;
  list-style-position: outside;
}
.related-posts li {
  margin-bottom: 0.25rem;
  line-height: 1.4;
}
/* æš—è‰²æ¨¡å¼é€‚é… */
[data-md-color-scheme="slate"] .related-posts {
  border-top-color: rgba(255,255,255,0.1);
}
/* Safariç‰¹å®šä¿®å¤ */
@supports (-webkit-hyphens:none) {
  .related-posts {
    display: block;
    position: relative;
    height: auto !important;
  }
  .related-posts ul {
    position: static;
  }
}
</style>
<div class="related-posts">
<h3>ğŸ“š ç›¸å…³æ–‡ç« æ¨è</h3>
<ul>
<li><a href="/develop/Mywork/mkdocs-wcowin/">Mkdocs-Wcowinä¸»é¢˜</a></li>
<li><a href="/develop/Mywork/opencv/">åŸºäºç™¾åº¦APIå’Œopencvçš„æ™ºèƒ½è½¦ç‰Œè¯†åˆ«ç¨‹åº</a></li>
<li><a href="/develop/Mywork/design/">ç©çš„è®¾è®¡</a></li>
<li><a href="/develop/Mywork/aizhiwu/">åˆ©ç”¨ç™¾åº¦APIè¿›è¡Œæ¤ç‰©è¯†åˆ«</a></li>
<li><a href="/blog/technique%20sharing/comkdocs/">åŸºäº Mkdocs çš„ä¸»é¢˜ä¸ç«™ç‚¹</a></li>
</ul>
</div>

<!-- Twikoo è¯„è®ºç³»ç»Ÿ -->
<div class="twikoo-container" style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid rgba(0,0,0,0.1);">
    <h3 style="margin-bottom: 1rem; font-size: 1.2rem; font-weight: 500;">ğŸ’¬ è¯„è®º</h3>
    <div id="tcomment" class="loading" style="min-height: 200px;">
        <p style="text-align: center; color: #666; padding: 2rem;">è¯„è®ºç³»ç»ŸåŠ è½½ä¸­...</p>
    </div>
</div>

<style>
.twikoo-container {
    max-width: 100%;
}

/* æš—è‰²æ¨¡å¼é€‚é… */
[data-md-color-scheme="slate"] .twikoo-container {
    border-top-color: rgba(255,255,255,0.1);
}

/* åŠ è½½çŠ¶æ€æ ·å¼ */
#tcomment.loading {
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(0,0,0,0.02);
    border-radius: 8px;
}

[data-md-color-scheme="slate"] #tcomment.loading {
    background: rgba(255,255,255,0.05);
}
</style>

<script>
(function() {
    // é˜²æ­¢é‡å¤åŠ è½½
    if (window.twikooLoaded) {
        return;
    }

    function loadTwikoo() {
        // æ£€æŸ¥æ˜¯å¦å·²ç»åŠ è½½è¿‡ Twikoo
        if (window.twikoo) {
            initTwikoo();
            return;
        }

        const script = document.createElement('script');
        script.src = 'https://registry.npmmirror.com/twikoo/1.6.44/files/dist/twikoo.min.js';
        script.onload = function() {
            console.log('Twikoo è„šæœ¬åŠ è½½æˆåŠŸ');
            initTwikoo();
        };
        script.onerror = function() {
            console.error('Twikoo è„šæœ¬åŠ è½½å¤±è´¥');
            const commentEl = document.getElementById('tcomment');
            if (commentEl) {
                commentEl.classList.remove('loading');
                commentEl.innerHTML = '<p style="text-align: center; color: #f56565; padding: 2rem;">è¯„è®ºç³»ç»ŸåŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•</p>';
            }
        };
        document.head.appendChild(script);
    }

    function initTwikoo() {
        const commentEl = document.getElementById('tcomment');
        if (!commentEl) {
            console.warn('è¯„è®ºå®¹å™¨æœªæ‰¾åˆ°');
            return;
        }

        commentEl.classList.remove('loading');

        try {
            twikoo.init({
                envId: 'https://superb-salamander-e730b6.netlify.app/.netlify/functions/twikoo',
                el: '#tcomment',
                lang: 'zh-CN',
                path: location.pathname,
                onCommentLoaded: function () {
                    console.log('è¯„è®ºåŠ è½½å®Œæˆ');
                },
                onError: function(err) {
                    console.error('Twikoo åˆå§‹åŒ–å¤±è´¥:', err);
                    commentEl.innerHTML = '<p style="text-align: center; color: #f56565; padding: 2rem;">è¯„è®ºç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥</p>';
                }
            });
            window.twikooLoaded = true;
        } catch (error) {
            console.error('Twikoo åˆå§‹åŒ–å¼‚å¸¸:', error);
            commentEl.innerHTML = '<p style="text-align: center; color: #f56565; padding: 2rem;">è¯„è®ºç³»ç»Ÿåˆå§‹åŒ–å¼‚å¸¸</p>';
        }
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadTwikoo);
    } else {
        loadTwikoo();
    }
})();
</script>







  
  


  <aside class="md-source-file">
    
    
    
    
      
  <span class="md-source-file__fact">
    
      
  <span class="md-icon" title="è´¡çŒ®è€…">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </span>
  <span>GitHub</span>

    
    <nav>
      
        <a href="https://github.com/Wcowin" class="md-author" title="@Wcowin">
          
          <img src="https://avatars.githubusercontent.com/u/99159173?v=4&size=72" alt="Wcowin">
        </a>
      
      
      
    </nav>
  </span>

    
  </aside>

<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine feedback configuration -->

  


<!-- Determine whether to show feedback -->


<!-- Was this page helpful? -->

  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        æ­¤é¡µé¢æœ‰å¸®åŠ©å—ï¼Ÿ
      </legend>
      <div class="md-feedback__inner">

        <!-- Feedback ratings -->
        <div class="md-feedback__list">
          
            <button
              class="md-feedback__icon md-icon"
              type="submit"
              title="This page was helpful"
              data-md-value="1"
            >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg>
            </button>
          
            <button
              class="md-feedback__icon md-icon"
              type="submit"
              title="This page could be improved"
              data-md-value="0"
            >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg>
            </button>
          
        </div>

        <!-- Feedback rating notes (shown after submission) -->
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              

              <!-- Determine title -->
              
                
              

              <!-- Replace {url} and {title} placeholders in note -->
              è°¢è°¢ä½ çš„åé¦ˆï¼
            </div>
          
            <div data-md-value="0" hidden>
              

              <!-- Determine title -->
              
                
              

              <!-- Replace {url} and {title} placeholders in note -->
              Thanks for your feedback! Help us improve this page by using our <a href="https://marketingplatform.google.com/about/analytics/" target="_blank" rel="noopener">feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  å›åˆ°é¡µé¢é¡¶éƒ¨
</button>
        
      </main>
      
        <!-- ç¡®ä¿è¯­è¨€é€‰æ‹©å™¨ä¸è¢«ç¿»è¯‘çš„æ ·å¼ -->
<style>
  /* ç¡®ä¿è¯­è¨€é€‰æ‹©å™¨ä¸è¢«ç¿»è¯‘ */
  .md-select,
  .md-header__option,
  .md-header__option *,
  [data-md-component="select"],
  [data-md-component="select"] *,
  .md-select__inner,
  .md-select__list,
  .md-select__item,
  .md-select__link,
  .md-header__button[for="__select"],
  .md-header__button[for="__select"] *,
  .md-header__source,
  .md-header__source * {
    translate: no !important;
  }
  
  /* ä¸ºè¯­è¨€é€‰æ‹©å™¨æ·»åŠ é¢å¤–çš„ä¿æŠ¤ */
  [data-md-component="header"] .md-header__option,
  [data-md-component="header"] .md-select {
    translate: no !important;
  }
</style>

<!-- Footer -->
<footer class="md-footer">
  <!-- Link to previous and/or next page -->
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="é¡µè„š" >
        <!-- Link to previous page -->
        
          
          <a href="../muplayer/" class="md-footer__link md-footer__link--prev" aria-label="ä¸Šä¸€é¡µ: ç®€å•çš„ JavaScript éŸ³ä¹æ’­æ”¾å™¨">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">ä¸Šä¸€é¡µ</span>
              <div class="md-ellipsis">ç®€å•çš„ JavaScript éŸ³ä¹æ’­æ”¾å™¨</div>
            </div>
          </a>
        

        <!-- Link to next page -->
        
          
          <a href="../email/" class="md-footer__link md-footer__link--next" aria-label="ä¸‹ä¸€é¡µ: ç”¨AirScriptè„šæœ¬ç»™å¥³/ç”·æœ‹å‹å‘é€æ¯æ—¥æ—©å®‰é‚®ä»¶(æç®€ç‰ˆæœ¬)">
            <div class="md-footer__title">
              <span class="md-footer__direction">ä¸‹ä¸€é¡µ</span>
              <div class="md-ellipsis">ç”¨AirScriptè„šæœ¬ç»™å¥³/ç”·æœ‹å‹å‘é€æ¯æ—¥æ—©å®‰é‚®ä»¶(æç®€ç‰ˆæœ¬)</div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  

  <!-- Footer content -->
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="footer-wrapper">
        <!-- Desktop layout -->
        <div class="footer-content">
          <div class="footer-visit-count">
            <div class="footer-item">
              <span>æœ¬ç«™è®¿é—®é‡ï¼š</span>
              <span id="finicount_views" class="footer-highlight">åŠ è½½ä¸­...</span>
            </div>
            <div class="footer-item">
              <a href="https://icp.gov.moe/?keyword=20230640" target="_blank" rel="noopener" class="icp-link">èŒICPå¤‡20230640å·</a>
            </div>
            <div class="footer-item runtime-info">
              <span>æœ¬ç«™å·²ç»è¿è¡Œ</span>
              <span id="box1" class="footer-highlight">è®¡ç®—ä¸­...</span>
            </div>
          </div>
        </div>

        <!-- Mobile layout -->
        <div class="footer-visit-count-mobile">
          <span>æœ¬ç«™è®¿é—®é‡ï¼š</span>
          <span id="finicount_views_mobile" class="footer-highlight">åŠ è½½ä¸­...</span>
          |
          <a href="https://icp.gov.moe/?keyword=20230640" target="_blank" rel="noopener" class="icp-link">èŒICPå¤‡20230640å·</a>
          <span class="runtime-info">
            <span>æœ¬ç«™å·²ç»è¿è¡Œ</span>
            <span id="box1_mobile" class="footer-highlight">è®¡ç®—ä¸­...</span>
          </span>
        </div>

        <!-- Copyright and social media -->
        <div class="footer-bottom-section">
          <div class="md-footer-copyright">
            <p>Copyright Â© 2022-2025 Wcowin</p>
            <p>Made with <a href="https://squidfunk.github.io/mkdocs-material/" class="mkdocs-link">Material for MkDocs</a></p>
          </div>
          
            <div class="footer-social">
              <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://pic1.zhimg.com/80/v2-8ad8e415b3eb139134b0373ff95c6846_1440w.webp" target="_blank" rel="noopener" title="pic1.zhimg.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://t.me/Wcowin" target="_blank" rel="noopener" title="t.me" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M256 8a248 248 0 1 0 0 496 248 248 0 1 0 0-496m115 168.7c-3.7 39.2-19.9 134.4-28.1 178.3-3.5 18.6-10.3 24.8-16.9 25.4-14.4 1.3-25.3-9.5-39.3-18.7-21.8-14.3-34.2-23.2-55.3-37.2-24.5-16.1-8.6-25 5.3-39.5 3.7-3.8 67.1-61.5 68.3-66.7.2-.7.3-3.1-1.2-4.4s-3.6-.8-5.1-.5c-2.2.5-37.1 23.5-104.6 69.1-9.9 6.8-18.9 10.1-26.9 9.9-8.9-.2-25.9-5-38.6-9.1-15.5-5-27.9-7.7-26.8-16.3.6-4.5 6.7-9 18.4-13.7 72.3-31.5 120.5-52.3 144.6-62.3 68.9-28.6 83.2-33.6 92.5-33.8 2.1 0 6.6.5 9.6 2.9 2 1.7 3.2 4.1 3.5 6.7.5 3.2.6 6.5.4 9.8z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://twitter.com/wcowin_" target="_blank" rel="noopener" title="Twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/Wcowin" target="_blank" rel="noopener" title="Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://space.bilibili.com/1407028951/lists/4566631?type=series" target="_blank" rel="noopener" title="space.bilibili.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92c-26.4-.8-48.2-9.8-65.3-27.2S.7 396.5 0 368.2V169.8c.8-26 9.7-47.6 26.7-65.7C43.8 87.8 65.5 78.8 92 78h29.4L96 52.2c-5.7-5.7-8.6-13-8.6-21.8S90.3 14.3 96 8.6 109 0 117.9 0s16.1 2.9 21.9 8.6L213.1 78h88l74.5-69.4C381.7 2.9 389.2 0 398 0s16.1 2.9 21.9 8.6c5.7 5.7 8.6 13 8.6 21.8s-2.9 16.1-8.6 21.8L394.6 78h29.3c26.4.8 48 9.8 64.7 26.1m-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96c-9.6.4-17.4 3.7-23.6 9.8-6.1 6.1-9.4 13.9-9.8 23.5v194.4c0 9.2 3.3 17 9.8 23.5s14.4 9.8 23.6 9.8h320.4c9.2 0 17-3.3 23.3-9.8s9.7-14.3 10.1-23.5zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5s-17.5-3.2-23.6-9.5-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2s13.2-9.6 23.3-10c9.2.4 17 3.7 23.3 10m191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2s-14 9.5-23.6 9.5-17.4-3.2-23.6-9.5c-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2s14.1-9.6 23.3-10c9.2.4 17 3.7 23.3 10"/></svg>
    </a>
  
    
    
    
    
    <a href="https://blog.csdn.net/m0_63203517?spm=1000.2115.3001.5343" target="_blank" rel="noopener" title="CSDN" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M0 64C0 28.7 28.7 0 64 0h149.5c17 0 33.3 6.7 45.3 18.7l106.5 106.6c12 12 18.7 28.3 18.7 45.3V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64zm208-5.5V152c0 13.3 10.7 24 24 24h93.5zm-53.8 237.1c8.6-10.1 7.5-25.2-2.6-33.8s-25.2-7.5-33.8 2.6l-48 56c-7.7 9-7.7 22.2 0 31.2l48 56c8.6 10.1 23.8 11.2 33.8 2.6s11.2-23.8 2.6-33.8L119.6 336zm112-31.2c-8.6-10.1-23.8-11.2-33.8-2.6s-11.2 23.8-2.6 33.8l34.6 40.4-34.6 40.4c-8.6 10.1-7.5 25.2 2.6 33.8s25.2 7.5 33.8-2.6l48-56c7.7-9 7.7-22.2 0-31.2z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<wangkewen821@gmail.com>" target="_blank" rel="noopener" title="Email" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M61.4 64C27.5 64 0 91.5 0 125.4c0 .9 0 1.7.1 2.6H0v256c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V128h-.1c0-.9.1-1.7.1-2.6 0-33.9-27.5-61.4-61.4-61.4zM464 192.3V384c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192.3l154.8 117.4c31.4 23.9 74.9 23.9 106.4 0zM48 125.4c0-7.4 6-13.4 13.4-13.4h389.2c7.4 0 13.4 6 13.4 13.4 0 4.2-2 8.2-5.3 10.7L280.2 271.5c-14.3 10.8-34.1 10.8-48.4 0L53.3 136.1c-3.3-2.5-5.3-6.5-5.3-10.7"/></svg>
    </a>
  
</div>
            </div>
          
        </div>
      </div>

      <!-- GLM-4-Flash æ™ºèƒ½ç¿»è¯‘ç³»ç»Ÿ - ä¸MkDocs Alternateé›†æˆç‰ˆ -->
      <script>
      (function() {
        'use strict';
        
        // é˜²æ­¢é‡å¤åˆå§‹åŒ–
        if (window.glmTranslateInitialized) return;
        
        // GLM-4-Flash é…ç½® - ä¼˜åŒ–æ€§èƒ½å’Œç¨³å®šæ€§
        const GLM_CONFIG = {
          endpoint: 'https://open.bigmodel.cn/api/paas/v4/chat/completions',
          model: 'glm-4-flash',
          maxRetries: 3,
          timeout: 8000,
          batchSize: 15,
          batchDelay: 50,
          maxConcurrent: 6,
          apiKey: '46ad7781e9fa44cb9b31d11a9696da89.GCUpkep25U5Y6vBg'
        };
        
        // ä¸MkDocsé…ç½®åŒæ­¥çš„è¯­è¨€æ˜ å°„
        const LANGUAGE_MAP = {
          'chinese_simplified': 'ä¸­æ–‡',
          'english': 'English', 
          'korean': 'í•œêµ­ì–´',
          'japanese': 'æ—¥æœ¬èª'
        };
        
        // è¯­è¨€ä»£ç åˆ°ISOä»£ç çš„æ˜ å°„ (ç”¨äºMkDocs alternate)
        const LANG_TO_ISO = {
          'chinese_simplified': 'zh',
          'english': 'en',
          'korean': 'ko', 
          'japanese': 'ja'
        };
        
        // ä¸“ä¸šæœ¯è¯­è¯å…¸ - æå‡ç¿»è¯‘è´¨é‡
        const TECHNICAL_TERMS = {
          'chinese_simplified': {
            'API': 'API',
            'JavaScript': 'JavaScript',
            'TypeScript': 'TypeScript',
            'React': 'React',
            'Vue': 'Vue',
            'Node.js': 'Node.js',
            'GitHub': 'GitHub',
            'Docker': 'Docker',
            'Kubernetes': 'Kubernetes',
            'DevOps': 'DevOps',
            'CI/CD': 'CI/CD',
            'Material Design': 'Material Design',
            'MkDocs': 'MkDocs',
            'Markdown': 'Markdown',
            'äººå·¥æ™ºèƒ½': 'AI',
            'æœºå™¨å­¦ä¹ ': 'Machine Learning',
            'æ·±åº¦å­¦ä¹ ': 'Deep Learning',
            'æ•°æ®åº“': 'Database',
            'å‰ç«¯': 'Frontend',
            'åç«¯': 'Backend',
            'å…¨æ ˆ': 'Full Stack'
          },
          'english': {
            'API': 'API',
            'JavaScript': 'JavaScript',
            'TypeScript': 'TypeScript',
            'React': 'React',
            'Vue': 'Vue',
            'Node.js': 'Node.js',
            'GitHub': 'GitHub',
            'Docker': 'Docker',
            'Kubernetes': 'Kubernetes',
            'DevOps': 'DevOps',
            'CI/CD': 'CI/CD',
            'Material Design': 'Material Design',
            'MkDocs': 'MkDocs',
            'Markdown': 'Markdown',
            'AI': 'Artificial Intelligence',
            'Machine Learning': 'Machine Learning',
            'Deep Learning': 'Deep Learning',
            'Database': 'Database',
            'Frontend': 'Frontend',
            'Backend': 'Backend',
            'Full Stack': 'Full Stack'
          },
          'korean': {
            'API': 'API',
            'JavaScript': 'JavaScript',
            'TypeScript': 'TypeScript',
            'React': 'React',
            'Vue': 'Vue',
            'Node.js': 'Node.js',
            'GitHub': 'GitHub',
            'Docker': 'Docker',
            'Kubernetes': 'Kubernetes',
            'DevOps': 'DevOps',
            'CI/CD': 'CI/CD',
            'Material Design': 'Material Design',
            'MkDocs': 'MkDocs',
            'Markdown': 'Markdown',
            'AI': 'ì¸ê³µì§€ëŠ¥',
            'Machine Learning': 'ë¨¸ì‹ ëŸ¬ë‹',
            'Deep Learning': 'ë”¥ëŸ¬ë‹',
            'Database': 'ë°ì´í„°ë² ì´ìŠ¤',
            'Frontend': 'í”„ë¡ íŠ¸ì—”ë“œ',
            'Backend': 'ë°±ì—”ë“œ',
            'Full Stack': 'í’€ìŠ¤íƒ'
          },
          'japanese': {
            'API': 'API',
            'JavaScript': 'JavaScript',
            'TypeScript': 'TypeScript',
            'React': 'React',
            'Vue': 'Vue',
            'Node.js': 'Node.js',
            'GitHub': 'GitHub',
            'Docker': 'Docker',
            'Kubernetes': 'Kubernetes',
            'DevOps': 'DevOps',
            'CI/CD': 'CI/CD',
            'Material Design': 'Material Design',
            'MkDocs': 'MkDocs',
            'Markdown': 'Markdown',
            'AI': 'äººå·¥çŸ¥èƒ½',
            'Machine Learning': 'æ©Ÿæ¢°å­¦ç¿’',
            'Deep Learning': 'ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°',
            'Database': 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹',
            'Frontend': 'ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰',
            'Backend': 'ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰',
            'Full Stack': 'ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯'
          }
        };
        
        // å…¨å±€çŠ¶æ€ç®¡ç†
        let currentLanguage = 'chinese_simplified';
        let originalTexts = new Map();
        let translationCache = new Map();
        let isTranslating = false;
        let activeRequests = 0;
        let lastUrl = window.location.href;
        let pageTranslationStates = new Map();
        let globalTranslationPreference = null;
        let navigationDialogShown = false; // é˜²æ­¢å¯¼èˆªå¼¹çª—é‡å¤æ˜¾ç¤º
        
        // ç¿»è¯‘ä¸­æ–­æ§åˆ¶
        let translationAbortController = null;
        let shouldCancelTranslation = false;
        
        // ç¿»è¯‘ä¸­æ–­å‡½æ•° - è¿”å›Promiseç¡®ä¿ä¸­æ–­å®Œæˆ
        function cancelCurrentTranslation(reason = 'ç”¨æˆ·å–æ¶ˆ') {
          return new Promise((resolve) => {
            console.log(`ğŸ›‘ ä¸­æ–­ç¿»è¯‘: ${reason}`);
            
            // è®¾ç½®ä¸­æ–­æ ‡å¿—
            shouldCancelTranslation = true;
            
            // ä¸­æ–­AbortController
            if (translationAbortController) {
              translationAbortController.abort();
              translationAbortController = null;
            }
            
            // ä¸­æ–­Web Workers
            if (TranslationWorkerManager && TranslationWorkerManager.workers) {
              TranslationWorkerManager.workers.forEach(({ worker }) => {
                try {
                  worker.terminate();
                } catch (e) {
                  console.warn('ä¸­æ–­Workerå¤±è´¥:', e);
                }
              });
              // é‡æ–°åˆå§‹åŒ–Workers
              setTimeout(() => {
                try {
                  TranslationWorkerManager.init();
                } catch (e) {
                  console.warn('é‡æ–°åˆå§‹åŒ–Workerså¤±è´¥:', e);
                }
              }, 100);
            }
            
            // å¦‚æœæ˜¯å› ä¸ºç”¨æˆ·åˆ‡æ¢åˆ°ä¸­æ–‡è€Œä¸­æ–­ï¼Œç«‹å³æ¢å¤åŸæ–‡
            if (reason.includes('ç”¨æˆ·åˆ‡æ¢åˆ°ä¸­æ–‡') || reason.includes('ç”¨æˆ·æ‰‹åŠ¨ä¸­æ–­')) {
              console.log('ğŸ”„ ä¸­æ–­æ—¶ç«‹å³æ¢å¤åŸæ–‡');
              
              // å°è¯•ä½¿ç”¨åŸå§‹æ–‡æœ¬æ˜ å°„æ¢å¤
              if (originalTexts.size > 0) {
                let restoredCount = 0;
                originalTexts.forEach((originalText, node) => {
                  if (node && node.parentNode && originalText && document.contains(node)) {
                    try {
                      node.textContent = originalText;
                      // æ¸…ç†ç¿»è¯‘æ ‡è®°
                      node.removeAttribute('data-translated');
                      node.removeAttribute('data-original-text');
                      node.removeAttribute('data-target-lang');
                      restoredCount++;
                    } catch (e) {
                      console.warn('æ¢å¤å•ä¸ªèŠ‚ç‚¹å¤±è´¥:', e);
                    }
                  }
                });
                console.log(`âœ… ä¸­æ–­æ—¶æ¢å¤äº† ${restoredCount}/${originalTexts.size} ä¸ªæ–‡æœ¬èŠ‚ç‚¹`);
              }
              
              // æ¸…ç†æ‰€æœ‰å‰©ä½™çš„ç¿»è¯‘æ ‡è®°
              const translatedElements = document.querySelectorAll('[data-translated]');
              if (translatedElements.length > 0) {
                let cleanedCount = 0;
                translatedElements.forEach(element => {
                  try {
                    const originalText = element.getAttribute('data-original-text');
                    if (originalText) {
                      element.textContent = originalText;
                      cleanedCount++;
                    }
                    element.removeAttribute('data-translated');
                    element.removeAttribute('data-original-text');
                    element.removeAttribute('data-target-lang');
                  } catch (e) {
                    console.warn('æ¸…ç†å•ä¸ªå…ƒç´ å¤±è´¥:', e);
                  }
                });
                console.log(`ğŸ§¹ ä¸­æ–­æ—¶æ¸…ç†äº† ${cleanedCount} ä¸ªç¿»è¯‘æ ‡è®°`);
              }
            }
            
            // æ¸…é™¤çŠ¶æ€æ˜¾ç¤º
            const existingStatus = document.getElementById('translate-status');
            if (existingStatus) {
              existingStatus.remove();
            }
            
            // é‡ç½®ç¿»è¯‘çŠ¶æ€
            isTranslating = false;
            activeRequests = 0;
            
            console.log('âœ… ç¿»è¯‘å·²ä¸­æ–­');
            
            // ç¡®ä¿çŠ¶æ€é‡ç½®å®Œæˆåå†ç»§ç»­
            setTimeout(resolve, 50);
          });
        }
        let contextCache = new Map();
        let semanticCache = new Map();
        
        // ç¿»è¯‘è´¨é‡åˆ†æå™¨
        const TranslationQualityAnalyzer = {
          // è®¡ç®—æ–‡æœ¬ç›¸ä¼¼åº¦
          calculateSimilarity: function(text1, text2) {
            const words1 = text1.toLowerCase().split(/\s+/);
            const words2 = text2.toLowerCase().split(/\s+/);
            const allWords = new Set([...words1, ...words2]);
            
            let matches = 0;
            for (const word of allWords) {
              if (words1.includes(word) && words2.includes(word)) {
                matches++;
              }
            }
            
            return matches / allWords.size;
          },
          
          // æ£€æŸ¥æ˜¯å¦å­˜åœ¨è¯­ä¹‰ç›¸ä¼¼çš„ç¿»è¯‘
          findSimilarTranslation: function(text, targetLang) {
            const cacheKey = `${targetLang}_semantic`;
            if (!semanticCache.has(cacheKey)) {
              return null;
            }
            
            const similarTranslations = semanticCache.get(cacheKey);
            for (const [originalText, translatedText] of similarTranslations) {
              const similarity = this.calculateSimilarity(text, originalText);
              if (similarity > 0.8) { // 80%ç›¸ä¼¼åº¦é˜ˆå€¼
                console.log(`ğŸ”„ æ‰¾åˆ°è¯­ä¹‰ç›¸ä¼¼ç¿»è¯‘ (ç›¸ä¼¼åº¦: ${(similarity * 100).toFixed(1)}%):`, originalText, '->', translatedText);
                return translatedText;
              }
            }
            
            return null;
          },
          
          // ä¿å­˜è¯­ä¹‰ç¿»è¯‘
          saveSimilarTranslation: function(originalText, translatedText, targetLang) {
            const cacheKey = `${targetLang}_semantic`;
            if (!semanticCache.has(cacheKey)) {
              semanticCache.set(cacheKey, new Map());
            }
            
            const similarTranslations = semanticCache.get(cacheKey);
            similarTranslations.set(originalText, translatedText);
            
            // é™åˆ¶è¯­ä¹‰ç¼“å­˜å¤§å°
            if (similarTranslations.size > 500) {
              const entries = Array.from(similarTranslations.entries());
              similarTranslations.clear();
              entries.slice(-400).forEach(([key, value]) => {
                similarTranslations.set(key, value);
              });
            }
          },
          
          // ä¸“ä¸šæœ¯è¯­æ›¿æ¢
          replaceTechnicalTerms: function(text, sourceLang, targetLang) {
            if (!TECHNICAL_TERMS[sourceLang] || !TECHNICAL_TERMS[targetLang]) {
              return text;
            }
            
            let processedText = text;
            const sourceTerms = TECHNICAL_TERMS[sourceLang];
            const targetTerms = TECHNICAL_TERMS[targetLang];
            
            // æ›¿æ¢ä¸“ä¸šæœ¯è¯­
            for (const [sourceTerm, standardTerm] of Object.entries(sourceTerms)) {
              if (targetTerms[standardTerm]) {
                const regex = new RegExp(`\\b${sourceTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')}\\b`, 'gi');
                processedText = processedText.replace(regex, targetTerms[standardTerm]);
              }
            }
            
            return processedText;
          }
        };
        
        // ç²¾ç¡®çš„å¿½ç•¥é€‰æ‹©å™¨ - é˜²æ­¢ç¿»è¯‘ç•Œé¢å…ƒç´ 
        const IGNORE_SELECTORS = [
          '.footer-highlight', '.md-footer-copyright', '.hljs', 'code', 'pre',
          'script', 'style', '[data-no-translate]', '.icp-link', '.runtime-info',
          // MkDocsç•Œé¢å…ƒç´ 
          '.md-header__option', '.md-select', '.md-select__inner', '.md-select__list',
          '.md-select__item', '.md-select__link', '.md-header__button[for="__select"]',
          '.md-header__source', '[data-md-component="palette"]', '[data-md-component="search"]',
          '[data-md-component="select"]', '[data-md-component="header"] .md-header__option',
          '.md-header__title', '[data-md-component="source"]', '.md-source',
          // é¡µè„šä¸“ç”¨é€‰æ‹©å™¨
          '.footer-visit-count', '.footer-visit-count-mobile', '.footer-social',
          '#finicount_views', '#finicount_views_mobile', '#box1', '#box1_mobile'
        ];
        
        // æ™ºèƒ½ç¼“å­˜ç®¡ç†
        const CACHE_MAX_SIZE = 2000;
        const CACHE_MAX_AGE = 14 * 24 * 60 * 60 * 1000; // 14å¤©è¿‡æœŸ
        const STORAGE_PREFIX = 'glm_translate_';
        
        // åˆå§‹åŒ–æŒä¹…åŒ–ç¼“å­˜
        function initPersistentCache() {
          try {
            console.log('ğŸš€ åˆå§‹åŒ–GLMç¿»è¯‘ç¼“å­˜ç³»ç»Ÿ...');
            
            // åŠ è½½ç¿»è¯‘ç¼“å­˜
            const cached = localStorage.getItem(STORAGE_PREFIX + 'cache');
            if (cached) {
              try {
                const parsedCache = JSON.parse(cached);
                if (parsedCache && typeof parsedCache === 'object') {
                  const now = Date.now();
                  
                  Object.entries(parsedCache).forEach(([key, value]) => {
                    if (key && typeof key === 'string') {
                      if (typeof value === 'object' && value.timestamp && value.text) {
                        if (now - value.timestamp < CACHE_MAX_AGE) {
                          translationCache.set(key, value.text);
                        }
                      } else if (typeof value === 'string') {
                        translationCache.set(key, value);
                      }
                    }
                  });
                  console.log(`ğŸ“¦ å·²åŠ è½½ ${translationCache.size} æ¡ç¿»è¯‘ç¼“å­˜`);
                }
              } catch (e) {
                console.warn('ç¼“å­˜è§£æå¤±è´¥:', e);
                localStorage.removeItem(STORAGE_PREFIX + 'cache');
              }
            }
            
            // æ¢å¤å…¨å±€ç¿»è¯‘åå¥½
            const savedPreference = localStorage.getItem(STORAGE_PREFIX + 'preference');
            if (savedPreference) {
              try {
                let preference = savedPreference;
                if (savedPreference.startsWith('"') && savedPreference.endsWith('"')) {
                  preference = JSON.parse(savedPreference);
                }
                
                if (preference && typeof preference === 'string' && LANGUAGE_MAP[preference]) {
                  globalTranslationPreference = preference;
                  console.log(`ğŸŒ å·²åŠ è½½å…¨å±€ç¿»è¯‘åå¥½: ${LANGUAGE_MAP[preference]}`);
                } else {
                  localStorage.removeItem(STORAGE_PREFIX + 'preference');
                }
              } catch (e) {
                console.warn('å…¨å±€åå¥½è§£æå¤±è´¥:', e);
                localStorage.removeItem(STORAGE_PREFIX + 'preference');
              }
            }
            
            // æ¢å¤é¡µé¢ç¿»è¯‘çŠ¶æ€
            const savedStates = localStorage.getItem(STORAGE_PREFIX + 'states');
            if (savedStates) {
              try {
                const states = JSON.parse(savedStates);
                if (states && typeof states === 'object') {
                  const now = Date.now();
                  let validStatesCount = 0;
                  
                  Object.entries(states).forEach(([url, state]) => {
                    if (url && state && typeof url === 'string' && 
                        state.language && state.timestamp && 
                        LANGUAGE_MAP[state.language]) {
                      if (now - state.timestamp < CACHE_MAX_AGE) {
                        pageTranslationStates.set(url, state);
                        validStatesCount++;
                      }
                    }
                  });
                  
                  console.log(`ğŸ“„ å·²åŠ è½½ ${validStatesCount} ä¸ªé¡µé¢ç¿»è¯‘çŠ¶æ€`);
                  
                  if (validStatesCount === 0 && Object.keys(states).length > 0) {
                    localStorage.removeItem(STORAGE_PREFIX + 'states');
                  }
                }
              } catch (e) {
                console.warn('é¡µé¢çŠ¶æ€è§£æå¤±è´¥:', e);
                localStorage.removeItem(STORAGE_PREFIX + 'states');
              }
            }
            
          } catch (error) {
            console.warn('ç¼“å­˜åˆå§‹åŒ–å¤±è´¥:', error);
            translationCache.clear();
            pageTranslationStates.clear();
            globalTranslationPreference = null;
            try {
              [STORAGE_PREFIX + 'cache', STORAGE_PREFIX + 'preference', STORAGE_PREFIX + 'states'].forEach(key => {
                localStorage.removeItem(key);
              });
            } catch (e) {
              console.warn('æ¸…ç†ç¼“å­˜å¤±è´¥:', e);
            }
          }
        }
        
        // ä¿å­˜æŒä¹…åŒ–ç¼“å­˜
        function savePersistentCache() {
          try {
            if (translationCache.size > CACHE_MAX_SIZE) {
              const entries = Array.from(translationCache.entries());
              translationCache.clear();
              const keepCount = Math.floor(CACHE_MAX_SIZE * 0.8);
              entries.slice(-keepCount).forEach(([key, value]) => {
                translationCache.set(key, value);
              });
              console.log(`ğŸ§¹ ç¼“å­˜å·²æ¸…ç†ï¼Œä¿ç•™ ${translationCache.size} æ¡è®°å½•`);
            }
            
            // ä¿å­˜ç¿»è¯‘ç¼“å­˜
            if (translationCache.size > 0) {
              const cacheObj = {};
              const now = Date.now();
              translationCache.forEach((value, key) => {
                if (key && value && typeof key === 'string' && typeof value === 'string') {
                  cacheObj[key] = { text: value, timestamp: now };
                }
              });
              
              if (Object.keys(cacheObj).length > 0) {
                localStorage.setItem(STORAGE_PREFIX + 'cache', JSON.stringify(cacheObj));
              }
            } else {
              localStorage.removeItem(STORAGE_PREFIX + 'cache');
            }
            
            // ä¿å­˜å…¨å±€ç¿»è¯‘åå¥½
            if (globalTranslationPreference && LANGUAGE_MAP[globalTranslationPreference]) {
              localStorage.setItem(STORAGE_PREFIX + 'preference', JSON.stringify(globalTranslationPreference));
            } else {
              localStorage.removeItem(STORAGE_PREFIX + 'preference');
            }
            
            // ä¿å­˜é¡µé¢ç¿»è¯‘çŠ¶æ€
            if (pageTranslationStates.size > 0) {
              const statesData = {};
              const now = Date.now();
              
              pageTranslationStates.forEach((state, url) => {
                if (url && state && typeof url === 'string' && 
                    state.language && LANGUAGE_MAP[state.language] &&
                    now - state.timestamp < CACHE_MAX_AGE) {
                  statesData[url] = state;
                }
              });
              
              if (Object.keys(statesData).length > 0) {
                localStorage.setItem(STORAGE_PREFIX + 'states', JSON.stringify(statesData));
              } else {
                localStorage.removeItem(STORAGE_PREFIX + 'states');
              }
            } else {
              localStorage.removeItem(STORAGE_PREFIX + 'states');
            }
            
          } catch (error) {
            if (error.name === 'QuotaExceededError') {
              console.warn('å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œæ‰§è¡Œæ¸…ç†æ“ä½œ');
              try {
                translationCache.clear();
                localStorage.removeItem(STORAGE_PREFIX + 'cache');
                
                const now = Date.now();
                const validStates = new Map();
                pageTranslationStates.forEach((state, url) => {
                  if (now - state.timestamp < CACHE_MAX_AGE / 2) {
                    validStates.set(url, state);
                  }
                });
                pageTranslationStates.clear();
                validStates.forEach((state, url) => pageTranslationStates.set(url, state));
                
                if (pageTranslationStates.size > 0) {
                  const statesData = Object.fromEntries(pageTranslationStates);
                  localStorage.setItem(STORAGE_PREFIX + 'states', JSON.stringify(statesData));
                } else {
                  localStorage.removeItem(STORAGE_PREFIX + 'states');
                }
                
                console.log('âœ… å­˜å‚¨ç©ºé—´æ¸…ç†å®Œæˆ');
              } catch (cleanupError) {
                console.warn('æ¸…ç†æ“ä½œå¤±è´¥:', cleanupError);
              }
            } else {
              console.warn('ç¼“å­˜ä¿å­˜å¤±è´¥:', error);
            }
          }
        }
        
        // æ™ºèƒ½æ–‡æœ¬æ£€æµ‹ - æå‡ç¿»è¯‘ç²¾åº¦ï¼Œå‡å°‘å¤±è´¥
        function shouldTranslateText(text) {
          if (!text || text.length < 2 || text.length > 800) return false;
          
          // å¿«é€Ÿè·³è¿‡æ˜æ˜¾ä¸éœ€è¦ç¿»è¯‘çš„å†…å®¹
          if (/^[\d\s\-_.,!?()\[\]{}:;"'`~#$%^&*+=|\\\/<>]+$/.test(text)) return false;
          
          // è·³è¿‡URLã€é‚®ç®±ã€æ—¥æœŸæ ¼å¼
          if (/^https?:\/\/|@.*\.|\d{4}-\d{2}-\d{2}|\d{1,2}[:\/]\d{1,2}/.test(text)) return false;
          
          // è·³è¿‡ç‰ˆæœ¬å·å’ŒæŠ€æœ¯æ ‡è¯†ç¬¦
          if (/^v?\d+\.\d+(\.\d+)?(-\w+)?$/.test(text)) return false;
          if (/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(text) && text.length < 30) return false;
          if (/^[A-Z_][A-Z0-9_]*$/.test(text)) return false; // å¸¸é‡å
          
          // è·³è¿‡å¸¸è§æŠ€æœ¯æœ¯è¯­å’Œç¼–ç¨‹æ ‡è¯†ç¬¦
          const technicalTerms = [
            'GitHub', 'API', 'JSON', 'HTML', 'CSS', 'JavaScript', 'Python', 'Material', 'MkDocs',
            'React', 'Vue', 'Docker', 'npm', 'yarn', 'webpack', 'TypeScript', 'Markdown',
            'Git', 'Linux', 'Windows', 'macOS', 'iOS', 'Android', 'Chrome', 'Firefox',
            'UTF-8', 'HTTP', 'HTTPS', 'URL', 'SEO', 'RSS', 'XML', 'YAML', 'OK', 'ERROR'
          ];
          
          if (technicalTerms.includes(text.trim())) return false;
          
          // è·³è¿‡çº¯è‹±æ–‡å•è¯ï¼ˆå¯èƒ½æ˜¯å·²ç»ç¿»è¯‘çš„å†…å®¹æˆ–ä¸“ä¸šæœ¯è¯­ï¼‰
          if (/^[a-zA-Z\s]+$/.test(text) && text.split(/\s+/).every(word => 
            word.length < 20 && !/[\u4e00-\u9fff]/.test(word)
          )) {
            // ä½†ä¿ç•™æ˜æ˜¾çš„ä¸­å¼è‹±æ–‡æˆ–éœ€è¦ç¿»è¯‘çš„çŸ­è¯­
            const commonChineseEnglish = ['Hello', 'Welcome', 'About', 'Contact', 'Home', 'Blog'];
            if (!commonChineseEnglish.some(term => text.includes(term)) && text.length < 50) {
              return false;
            }
          }
          
          // è·³è¿‡çº¯æ•°å­—å’Œç¬¦å·ç»„åˆ
          if (/^[\d\s\-+*/=().,]+$/.test(text)) return false;
          
          // è·³è¿‡æ–‡ä»¶è·¯å¾„å’Œä»£ç ç‰‡æ®µ
          if (/^[\w\-/.]+\.(js|css|html|py|md|txt|json|yml|yaml)$/i.test(text)) return false;
          if (/^import\s|^from\s|^class\s|^function\s|^const\s|^let\s|^var\s/.test(text)) return false;
          
          // æ£€æŸ¥æ˜¯å¦åŒ…å«ä¸­æ–‡å­—ç¬¦ï¼ˆä¸»è¦ç¿»è¯‘ç›®æ ‡ï¼‰
          const hasChinese = /[\u4e00-\u9fff]/.test(text);
          
          // åŒ…å«ä¸­æ–‡çš„å†…å®¹ä¼˜å…ˆç¿»è¯‘
          if (hasChinese) return true;
          
          // è‹±æ–‡å†…å®¹çš„è¿›ä¸€æ­¥ç­›é€‰
          if (/^[a-zA-Z\s\-'.,!?]+$/.test(text)) {
            // è·³è¿‡è¿‡çŸ­çš„è‹±æ–‡ï¼ˆå¯èƒ½æ˜¯æ ‡ç­¾æˆ–æŒ‰é’®ï¼‰
            if (text.length < 6) return false;
            
            // ä¿ç•™åŒ…å«å¤šä¸ªå•è¯çš„æœ‰æ„ä¹‰å¥å­
            const words = text.trim().split(/\s+/);
            if (words.length >= 3 && text.length >= 10) return true;
            
            // è·³è¿‡å…¶ä»–è‹±æ–‡å†…å®¹
            return false;
          }
          
          return true;
        }
        
        // ç¿»è¯‘è´¨é‡éªŒè¯å’Œæ¸…ç† - å¢å¼ºç‰ˆ
        function validateAndCleanTranslation(originalText, translatedText, targetLang) {
          let cleanedText = translatedText
            .replace(/^["'`]+|["'`]+$/g, '')
            .replace(/\n+/g, ' ')
            .replace(/^\s+|\s+$/g, '')
            .trim();
          
          if (!cleanedText || cleanedText.trim() === '') {
            console.warn('âŒ ç¿»è¯‘ç»“æœä¸ºç©º');
            return originalText;
          }
          
          // é•¿åº¦åˆç†æ€§æ£€æŸ¥ - æ›´ä¸¥æ ¼
          const lengthRatio = cleanedText.length / originalText.length;
          if (lengthRatio > 12 || lengthRatio < 0.05) {
            console.warn(`âŒ ç¿»è¯‘é•¿åº¦å¼‚å¸¸: åŸæ–‡${originalText.length}å­—ç¬¦, è¯‘æ–‡${cleanedText.length}å­—ç¬¦, æ¯”ä¾‹${lengthRatio.toFixed(2)}`);
            return originalText;
          }
          
          // æ£€æŸ¥æ˜¯å¦åŒ…å«æ˜æ˜¾çš„é”™è¯¯æ ‡è®°
          const errorPatterns = [
            /\[ç¿»è¯‘é”™è¯¯\]/i, /\[ERROR\]/i, /\[TRANSLATION[_\s]ERROR\]/i,
            /^(Sorry|æŠ±æ­‰|æ— æ³•ç¿»è¯‘|Cannot translate)/i,
            /^(I cannot|I'm unable|Unable to)/i,
            /^(ä½œä¸ºAI|ä½œä¸ºè¯­è¨€æ¨¡å‹|As an AI)/i,
            /\[æ³¨ï¼š/, /\[Note:/i, /\[æç¤ºï¼š/i,
            /^(Translation|ç¿»è¯‘)[:ï¼š]/i,
            /^(Here is|è¿™æ˜¯)/i
          ];
          
          for (const pattern of errorPatterns) {
            if (pattern.test(cleanedText)) {
              console.warn('âŒ æ£€æµ‹åˆ°ç¿»è¯‘é”™è¯¯æ ‡è®°ï¼Œè¿”å›åŸæ–‡');
              return originalText;
            }
          }
          
          // æ£€æŸ¥æ˜¯å¦åŒ…å«è¿‡å¤šåŸæ–‡å†…å®¹
          if (originalText.length > 10) {
            const originalWords = originalText.toLowerCase().split(/\s+/);
            const translatedWords = cleanedText.toLowerCase().split(/\s+/);
            let commonWords = 0;
            
            originalWords.forEach(word => {
              if (word.length > 2 && translatedWords.includes(word)) {
                commonWords++;
              }
            });
            
            const commonRatio = commonWords / Math.max(originalWords.length, 1);
            if (commonRatio > 0.7 && cleanedText.length < originalText.length * 1.3) {
              console.warn(`âŒ ç¿»è¯‘åŒ…å«è¿‡å¤šåŸæ–‡å†…å®¹ (${(commonRatio * 100).toFixed(1)}%)`);
              return originalText;
            }
          }
          
          // ç‰¹å®šè¯­è¨€çš„è´¨é‡æ£€æŸ¥
          if (targetLang === 'english') {
            // æ£€æŸ¥è‹±æ–‡ç¿»è¯‘è´¨é‡
            if (!/[a-zA-Z]/.test(cleanedText)) {
              console.warn('âŒ è‹±æ–‡ç¿»è¯‘ä¸åŒ…å«è‹±æ–‡å­—ç¬¦');
              return originalText;
            }
            
            // æ£€æŸ¥æ˜¯å¦è¿˜åŒ…å«å¤§é‡ä¸­æ–‡å­—ç¬¦
            const chineseChars = (cleanedText.match(/[\u4e00-\u9fff]/g) || []).length;
            if (chineseChars > cleanedText.length * 0.3) {
              console.warn('âŒ è‹±æ–‡ç¿»è¯‘åŒ…å«è¿‡å¤šä¸­æ–‡å­—ç¬¦');
              return originalText;
            }
          } else if (targetLang === 'korean') {
            // æ£€æŸ¥éŸ©æ–‡ç¿»è¯‘è´¨é‡
            if (!/[ã„±-ã…ê°€-í£]/.test(cleanedText)) {
              console.warn('âŒ éŸ©æ–‡ç¿»è¯‘ä¸åŒ…å«éŸ©æ–‡å­—ç¬¦');
              return originalText;
            }
          } else if (targetLang === 'japanese') {
            // æ£€æŸ¥æ—¥æ–‡ç¿»è¯‘è´¨é‡
            if (!/[ã²ã‚‰ãŒãªã‚«ã‚¿ã‚«ãƒŠä¸€-é¾¯]/.test(cleanedText)) {
              console.warn('âŒ æ—¥æ–‡ç¿»è¯‘ä¸åŒ…å«æ—¥æ–‡å­—ç¬¦');
              return originalText;
            }
          }
          
          // æ£€æŸ¥ç¿»è¯‘æ˜¯å¦åˆç† - é¿å…è¿‡äºç®€å•çš„é‡å¤
          if (cleanedText.length < 3 && originalText.length > 10) {
            console.warn('âŒ ç¿»è¯‘ç»“æœè¿‡äºç®€çŸ­');
            return originalText;
          }
          
          // æœ€ç»ˆéªŒè¯é€šè¿‡
          console.log(`âœ… ç¿»è¯‘è´¨é‡éªŒè¯é€šè¿‡: "${originalText.substring(0, 30)}..." -> "${cleanedText.substring(0, 30)}..."`);
          return cleanedText;
        }
        
        // é«˜è´¨é‡GLMç¿»è¯‘å‡½æ•° - å¢å¼ºç‰ˆï¼ˆæ”¯æŒä¸­æ–­ï¼‰
        async function translateWithGLM(text, targetLang, context = null) {
          // å‚æ•°éªŒè¯
          if (!text || typeof text !== 'string' || text.trim().length === 0) {
            console.warn('âŒ ç¿»è¯‘æ–‡æœ¬ä¸ºç©ºæˆ–æ— æ•ˆ');
            return text || '';
          }
          
          if (!targetLang || !LANGUAGE_MAP[targetLang]) {
            console.warn(`âŒ ç›®æ ‡è¯­è¨€æ— æ•ˆ: ${targetLang}`);
            return text;
          }
          
          // æ£€æŸ¥æ˜¯å¦åº”è¯¥ä¸­æ–­
          if (shouldCancelTranslation || translationAbortController?.signal?.aborted) {
            console.log('ğŸ›‘ ç¿»è¯‘è¯·æ±‚è¢«ä¸­æ–­');
            return text;
          }
          
          // é¦–å…ˆæ£€æŸ¥æ ‡å‡†ç¼“å­˜
          const cacheKey = `${text.trim()}_${targetLang}`;
          if (translationCache.has(cacheKey)) {
            return translationCache.get(cacheKey);
          }
          
          // æ£€æŸ¥è¯­ä¹‰ç›¸ä¼¼ç¿»è¯‘
          const similarTranslation = TranslationQualityAnalyzer.findSimilarTranslation(text, targetLang);
          if (similarTranslation) {
            translationCache.set(cacheKey, similarTranslation);
            return similarTranslation;
          }
          
          if (!shouldTranslateText(text)) {
            translationCache.set(cacheKey, text);
            return text;
          }
          
          // ä¸“ä¸šæœ¯è¯­é¢„å¤„ç†
          const processedText = TranslationQualityAnalyzer.replaceTechnicalTerms(text, 'chinese_simplified', targetLang);
          if (processedText !== text) {
            console.log(`ğŸ”§ ä¸“ä¸šæœ¯è¯­æ›¿æ¢: "${text}" -> "${processedText}"`);
            translationCache.set(cacheKey, processedText);
            return processedText;
          }
          
          while (activeRequests >= GLM_CONFIG.maxConcurrent) {
            // åœ¨ç­‰å¾…æ—¶ä¹Ÿæ£€æŸ¥ä¸­æ–­
            if (shouldCancelTranslation || translationAbortController?.signal?.aborted) {
              console.log('ğŸ›‘ ç­‰å¾…æœŸé—´ç¿»è¯‘è¢«ä¸­æ–­');
              return text;
            }
            await new Promise(resolve => setTimeout(resolve, 10));
          }
          
          activeRequests++;
          
          const targetLanguage = LANGUAGE_MAP[targetLang] || targetLang;
          const textLength = text.length;
          
          // æ„å»ºä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„æç¤ºè¯
          let prompt;
          let contextInfo = '';
          
          if (context && context.previousText) {
            contextInfo = `\nä¸Šä¸‹æ–‡ï¼šå‰æ–‡æåˆ°"${context.previousText}"`;
          }
          
          if (targetLang === 'english') {
            prompt = textLength < 30 
              ? `Translate to natural English: "${text}"`
              : `Translate this Chinese text to natural, fluent English. Consider the context and maintain consistency with technical terms.${contextInfo}\n\nText to translate: ${text}`;
          } else if (targetLang === 'korean') {
            prompt = textLength < 30
              ? `ìì—°ìŠ¤ëŸ¬ìš´ í•œêµ­ì–´ë¡œ ë²ˆì—­: "${text}"`
              : `ë‹¤ìŒ ì¤‘êµ­ì–´ í…ìŠ¤íŠ¸ë¥¼ ìì—°ìŠ¤ëŸ½ê³  ìœ ì°½í•œ í•œêµ­ì–´ë¡œ ë²ˆì—­í•´ì£¼ì„¸ìš”. ë§¥ë½ì„ ê³ ë ¤í•˜ê³  ì „ë¬¸ ìš©ì–´ì˜ ì¼ê´€ì„±ì„ ìœ ì§€í•´ì£¼ì„¸ìš”.${contextInfo}\n\në²ˆì—­í•  í…ìŠ¤íŠ¸: ${text}`;
          } else if (targetLang === 'japanese') {
            prompt = textLength < 30
              ? `è‡ªç„¶ãªæ—¥æœ¬èªã«ç¿»è¨³: "${text}"`
              : `ä»¥ä¸‹ã®ä¸­å›½èªãƒ†ã‚­ã‚¹ãƒˆã‚’è‡ªç„¶ã§æµæš¢ãªæ—¥æœ¬èªã«ç¿»è¨³ã—ã¦ãã ã•ã„ã€‚æ–‡è„ˆã‚’è€ƒæ…®ã—ã€å°‚é–€ç”¨èªã®ä¸€è²«æ€§ã‚’ä¿ã£ã¦ãã ã•ã„ã€‚${contextInfo}\n\nç¿»è¨³ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆï¼š${text}`;
          } else {
            prompt = `è¯·å°†ä»¥ä¸‹ä¸­æ–‡ç¿»è¯‘ä¸ºè‡ªç„¶æµç•…çš„${targetLanguage}ã€‚è€ƒè™‘ä¸Šä¸‹æ–‡ï¼Œä¿æŒä¸“ä¸šæœ¯è¯­çš„ä¸€è‡´æ€§ã€‚${contextInfo}\n\nå¾…ç¿»è¯‘æ–‡æœ¬ï¼š${text}`;
          }
          
          // æ™ºèƒ½é‡è¯•æœºåˆ¶ï¼ˆæ”¯æŒä¸­æ–­ï¼‰
          for (let attempt = 0; attempt < GLM_CONFIG.maxRetries; attempt++) {
            try {
              // æ£€æŸ¥ä¸­æ–­
              if (shouldCancelTranslation || translationAbortController?.signal?.aborted) {
                console.log('ğŸ›‘ ç¿»è¯‘é‡è¯•è¿‡ç¨‹ä¸­è¢«ä¸­æ–­');
                activeRequests--;
                return text;
              }
              
              // ä½¿ç”¨å…¨å±€ä¸­æ–­æ§åˆ¶å™¨ï¼Œå¦‚æœå­˜åœ¨çš„è¯
              const controller = translationAbortController || new AbortController();
              const timeoutId = setTimeout(() => controller.abort(), GLM_CONFIG.timeout);
              
              const requestBody = {
                model: GLM_CONFIG.model,
                messages: [{ role: 'user', content: prompt }],
                temperature: 0.1,
                max_tokens: Math.min(Math.max(textLength * 2, 50), 500),
                top_p: 0.95,
                frequency_penalty: 0.0,
                presence_penalty: 0.0,
                stream: false
              };
              
              const response = await fetch(GLM_CONFIG.endpoint, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  'Authorization': `Bearer ${GLM_CONFIG.apiKey}`
                },
                body: JSON.stringify(requestBody),
                signal: controller.signal
              });
              
              clearTimeout(timeoutId);
              
              if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`API error ${response.status}: ${errorText}`);
              }
              
              const data = await response.json();
              const translatedText = data.choices?.[0]?.message?.content?.trim();
              
              if (translatedText) {
                const cleanedText = validateAndCleanTranslation(text, translatedText, targetLang);
                
                if (cleanedText && cleanedText !== text) {
                  // ä¿å­˜åˆ°æ ‡å‡†ç¼“å­˜
                  translationCache.set(cacheKey, cleanedText);
                  
                  // ä¿å­˜åˆ°è¯­ä¹‰ç¼“å­˜
                  TranslationQualityAnalyzer.saveSimilarTranslation(text, cleanedText, targetLang);
                  
                  if (translationCache.size % 100 === 0) {
                    setTimeout(savePersistentCache, 1000);
                  }
                  
                  activeRequests--;
                  return cleanedText;
                }
              }
              
              throw new Error('ç©ºç¿»è¯‘ç»“æœ');
              
            } catch (error) {
              // å¦‚æœæ˜¯ä¸­æ–­é”™è¯¯ï¼Œç›´æ¥è¿”å›
              if (error.name === 'AbortError' || shouldCancelTranslation) {
                console.log('ğŸ›‘ ç¿»è¯‘APIè¯·æ±‚è¢«ä¸­æ–­');
                activeRequests--;
                return text;
              }
              
              console.warn(`ç¿»è¯‘å°è¯• ${attempt + 1}/${GLM_CONFIG.maxRetries} å¤±è´¥:`, error.message);
              
              if (attempt === GLM_CONFIG.maxRetries - 1) {
                activeRequests--;
                return text;
              }
              
              await new Promise(resolve => setTimeout(resolve, 500 * Math.pow(2, attempt)));
            }
          }
          
          activeRequests--;
          return text;
        }
        
        // Web Worker ç¿»è¯‘ç®¡ç†å™¨
        const TranslationWorkerManager = {
          workers: [],
          taskQueue: [],
          maxWorkers: Math.min(navigator.hardwareConcurrency || 4, 4),
          workerScript: null,
          
          // åˆå§‹åŒ– Worker
          init: function() {
            if (this.workers.length > 0) return;
            
            // åˆ›å»º Worker è„šæœ¬
            const workerCode = `
              let translationCache = new Map();
              let activeRequests = 0;
              const maxConcurrent = 2;
              
              const GLM_CONFIG = {
                endpoint: 'https://open.bigmodel.cn/api/paas/v4/chat/completions',
                model: 'glm-4-flash',
                maxRetries: 3,
                timeout: 8000,
                apiKey: '46ad7781e9fa44cb9b31d11a9696da89.GCUpkep25U5Y6vBg'
              };
              
              async function translateText(text, targetLang, context) {
                const cacheKey = \`\${text}_\${targetLang}\`;
                if (translationCache.has(cacheKey)) {
                  return translationCache.get(cacheKey);
                }
                
                while (activeRequests >= maxConcurrent) {
                  await new Promise(resolve => setTimeout(resolve, 10));
                }
                
                activeRequests++;
                
                try {
                  const controller = new AbortController();
                  const timeoutId = setTimeout(() => controller.abort(), GLM_CONFIG.timeout);
                  
                  let prompt;
                  const targetLanguageMap = {
                    'english': 'English',
                    'korean': 'í•œêµ­ì–´',
                    'japanese': 'æ—¥æœ¬èª'
                  };
                  
                  const targetLanguage = targetLanguageMap[targetLang] || targetLang;
                  let contextInfo = context ? \`\\nä¸Šä¸‹æ–‡ï¼šå‰æ–‡æåˆ°"\${context}"\` : '';
                  
                  if (targetLang === 'english') {
                    prompt = \`Translate this Chinese text to natural, fluent English. Consider the context and maintain consistency.\${contextInfo}\\n\\nText: \${text}\`;
                  } else if (targetLang === 'korean') {
                    prompt = \`ë‹¤ìŒ ì¤‘êµ­ì–´ í…ìŠ¤íŠ¸ë¥¼ ìì—°ìŠ¤ëŸ½ê³  ìœ ì°½í•œ í•œêµ­ì–´ë¡œ ë²ˆì—­í•´ì£¼ì„¸ìš”.\${contextInfo}\\n\\ní…ìŠ¤íŠ¸: \${text}\`;
                  } else if (targetLang === 'japanese') {
                    prompt = \`ä»¥ä¸‹ã®ä¸­å›½èªãƒ†ã‚­ã‚¹ãƒˆã‚’è‡ªç„¶ã§æµæš¢ãªæ—¥æœ¬èªã«ç¿»è¨³ã—ã¦ãã ã•ã„ã€‚\${contextInfo}\\n\\nãƒ†ã‚­ã‚¹ãƒˆï¼š\${text}\`;
                  }
                  
                  const response = await fetch(GLM_CONFIG.endpoint, {
                    method: 'POST',
                    headers: {
                      'Content-Type': 'application/json',
                      'Authorization': \`Bearer \${GLM_CONFIG.apiKey}\`
                    },
                    body: JSON.stringify({
                      model: GLM_CONFIG.model,
                      messages: [{ role: 'user', content: prompt }],
                      temperature: 0.1,
                      max_tokens: Math.min(Math.max(text.length * 2, 50), 500),
                      top_p: 0.95
                    }),
                    signal: controller.signal
                  });
                  
                  clearTimeout(timeoutId);
                  
                  if (response.ok) {
                    const data = await response.json();
                    const translated = data.choices?.[0]?.message?.content?.trim();
                    if (translated) {
                      translationCache.set(cacheKey, translated);
                      return translated;
                    }
                  }
                  
                  return text;
                } catch (error) {
                  return text;
                } finally {
                  activeRequests--;
                }
              }
              
              self.onmessage = async function(e) {
                const { id, text, targetLang, context } = e.data;
                try {
                  const result = await translateText(text, targetLang, context);
                  self.postMessage({ id, success: true, result });
                } catch (error) {
                  self.postMessage({ id, success: false, error: error.message, result: text });
                }
              };
            `;
            
            this.workerScript = new Blob([workerCode], { type: 'application/javascript' });
            
            // åˆ›å»º Workers
            for (let i = 0; i < this.maxWorkers; i++) {
              try {
                const workerUrl = URL.createObjectURL(this.workerScript);
                const worker = new Worker(workerUrl);
                worker.onmessage = (e) => this.handleWorkerMessage(e);
                worker.onerror = (error) => console.warn('Worker é”™è¯¯:', error);
                this.workers.push({
                  worker,
                  workerUrl, // ä¿å­˜URLå¼•ç”¨ä»¥ä¾¿æ¸…ç†
                  busy: false,
                  taskId: null
                });
              } catch (error) {
                console.warn('åˆ›å»º Worker å¤±è´¥:', error);
                break;
              }
            }
            
            console.log(`ğŸš€ åˆ›å»ºäº† ${this.workers.length} ä¸ªç¿»è¯‘ Workers`);
          },
          
          // å¤„ç† Worker æ¶ˆæ¯
          handleWorkerMessage: function(e) {
            const { id, success, result, error } = e.data;
            const task = this.taskQueue.find(t => t.id === id);
            
            if (task) {
              // æ ‡è®° Worker ä¸ºç©ºé—²
              const workerInfo = this.workers.find(w => w.taskId === id);
              if (workerInfo) {
                workerInfo.busy = false;
                workerInfo.taskId = null;
              }
              
              // ç§»é™¤ä»»åŠ¡
              const taskIndex = this.taskQueue.findIndex(t => t.id === id);
              if (taskIndex > -1) {
                this.taskQueue.splice(taskIndex, 1);
              }
              
              // æ‰§è¡Œå›è°ƒ
              if (success) {
                task.resolve(result);
              } else {
                console.warn('Worker ç¿»è¯‘å¤±è´¥:', error);
                task.resolve(result || task.text); // å¤±è´¥æ—¶è¿”å›åŸæ–‡
              }
              
              // å¤„ç†é˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªä»»åŠ¡
              this.processQueue();
            }
          },
          
          // å¤„ç†ä»»åŠ¡é˜Ÿåˆ—
          processQueue: function() {
            const pendingTasks = this.taskQueue.filter(t => !t.assigned);
            const availableWorkers = this.workers.filter(w => !w.busy);
            
            const tasksToProcess = Math.min(pendingTasks.length, availableWorkers.length);
            
            for (let i = 0; i < tasksToProcess; i++) {
              const task = pendingTasks[i];
              const workerInfo = availableWorkers[i];
              
              task.assigned = true;
              workerInfo.busy = true;
              workerInfo.taskId = task.id;
              
              workerInfo.worker.postMessage({
                id: task.id,
                text: task.text,
                targetLang: task.targetLang,
                context: task.context
              });
            }
          },
          
          // ç¿»è¯‘ä»»åŠ¡
          translate: function(text, targetLang, context = null) {
            return new Promise((resolve) => {
              if (this.workers.length === 0) {
                // å¦‚æœæ²¡æœ‰ Workersï¼Œå›é€€åˆ°ä¸»çº¿ç¨‹
                translateWithGLM(text, targetLang, context ? { previousText: context } : null)
                  .then(resolve)
                  .catch(() => resolve(text));
                return;
              }
              
              const taskId = Date.now() + Math.random();
              
              this.taskQueue.push({
                id: taskId,
                text,
                targetLang,
                context,
                resolve,
                assigned: false
              });
              
              this.processQueue();
            });
          },
          
          // é”€æ¯ Workers
          destroy: function() {
            this.workers.forEach(({ worker, workerUrl }) => {
              try {
                worker.terminate();
              } catch (e) {
                console.warn('é”€æ¯Workerå¤±è´¥:', e);
              }
              
              // æ¸…ç†Worker URL
              if (workerUrl) {
                try {
                  URL.revokeObjectURL(workerUrl);
                } catch (e) {
                  console.warn('æ¸…ç†Worker URLå¤±è´¥:', e);
                }
              }
            });
            this.workers = [];
            this.taskQueue = [];
            
            // æ¸…ç†è„šæœ¬Blob
            if (this.workerScript) {
              this.workerScript = null;
            }
            
            console.log('ğŸ§¹ Web Workers å·²æ¸…ç†');
          }
        };
        
        // è™šæ‹Ÿæ»šåŠ¨ç¿»è¯‘ä¼˜åŒ–å™¨
        const VirtualScrollOptimizer = {
          visibleElements: new Set(),
          observer: null,
          pendingTranslations: new Map(),
          
          // åˆå§‹åŒ–è™šæ‹Ÿæ»šåŠ¨
          init: function() {
            if (this.observer) return;
            
            this.observer = new IntersectionObserver((entries) => {
              entries.forEach(entry => {
                const element = entry.target;
                
                if (entry.isIntersecting) {
                  // å…ƒç´ è¿›å…¥è§†å£
                  this.visibleElements.add(element);
                  
                  // æ£€æŸ¥æ˜¯å¦æœ‰å¾…å¤„ç†çš„ç¿»è¯‘
                  if (this.pendingTranslations.has(element)) {
                    const { text, targetLang, context } = this.pendingTranslations.get(element);
                    this.performTranslation(element, text, targetLang, context);
                    this.pendingTranslations.delete(element);
                  }
                } else {
                  // å…ƒç´ ç¦»å¼€è§†å£
                  this.visibleElements.delete(element);
                }
              });
            }, {
              rootMargin: '100px', // æå‰100pxå¼€å§‹åŠ è½½
              threshold: 0.1
            });
            
            console.log('ğŸ“± è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–å™¨å·²åˆå§‹åŒ–');
          },
          
          // è§‚å¯Ÿå…ƒç´ 
          observe: function(element) {
            if (this.observer && element) {
              this.observer.observe(element);
            }
          },
          
          // å–æ¶ˆè§‚å¯Ÿ
          unobserve: function(element) {
            if (this.observer && element) {
              this.observer.unobserve(element);
              this.visibleElements.delete(element);
              this.pendingTranslations.delete(element);
            }
          },
          
          // è°ƒåº¦ç¿»è¯‘ï¼ˆä¼˜å…ˆå¤„ç†å¯è§å…ƒç´ ï¼‰
          scheduleTranslation: function(element, text, targetLang, context = null) {
            if (this.visibleElements.has(element)) {
              // å¯è§å…ƒç´ ç«‹å³ç¿»è¯‘
              return this.performTranslation(element, text, targetLang, context);
            } else {
              // ä¸å¯è§å…ƒç´ å»¶è¿Ÿç¿»è¯‘
              this.pendingTranslations.set(element, { text, targetLang, context });
              return Promise.resolve(text);
            }
          },
          
          // æ‰§è¡Œç¿»è¯‘
          performTranslation: async function(element, text, targetLang, context) {
            try {
              const result = await TranslationWorkerManager.translate(text, targetLang, context);
              
              // æ£€æŸ¥å…ƒç´ æ˜¯å¦ä»ç„¶å­˜åœ¨ä¸”å¯è§
              if (element.isConnected && this.visibleElements.has(element)) {
                element.textContent = result;
                element.setAttribute('data-translated', 'true');
                element.setAttribute('data-original-text', text);
              }
              
              return result;
            } catch (error) {
              console.warn('è™šæ‹Ÿæ»šåŠ¨ç¿»è¯‘å¤±è´¥:', error);
              return text;
            }
          },
          
          // é”€æ¯
          destroy: function() {
            if (this.observer) {
              this.observer.disconnect();
              this.observer = null;
            }
            this.visibleElements.clear();
            this.pendingTranslations.clear();
          }
        };
        
        // å…ƒç´ å¿½ç•¥æ£€æŸ¥
        function shouldIgnoreElement(element) {
          if (!element || !element.tagName) return true;
          
          const tagName = element.tagName.toLowerCase();
          if (['script', 'style', 'noscript', 'iframe', 'svg', 'canvas'].includes(tagName)) {
            return true;
          }
          
          for (const selector of IGNORE_SELECTORS) {
            try {
              if (element.matches(selector)) return true;
            } catch (e) {}
          }
          
          if (element.hasAttribute('data-no-translate') || 
              element.hasAttribute('data-translated') ||
              element.contentEditable === 'true') {
            return true;
          }
          
          return false;
        }
        
        // è·å–å¯ç¿»è¯‘æ–‡æœ¬èŠ‚ç‚¹
        function getTextNodes(element) {
          const textNodes = [];
          
          const walker = document.createTreeWalker(
            element,
            NodeFilter.SHOW_TEXT,
            {
              acceptNode: (node) => {
                const text = node.textContent.trim();
                
                if (!text || text.length < 2) {
                  return NodeFilter.FILTER_REJECT;
                }
                
                if (shouldIgnoreElement(node.parentElement)) {
                  return NodeFilter.FILTER_REJECT;
                }
                
                if (!shouldTranslateText(text)) {
                  return NodeFilter.FILTER_REJECT;
                }
                
                return NodeFilter.FILTER_ACCEPT;
              }
            }
          );
          
          let node;
          while (node = walker.nextNode()) {
            textNodes.push({ 
              node, 
              text: node.textContent.trim()
            });
          }
          
          return textNodes;
        }
        
        // æ˜¾ç¤ºç¿»è¯‘çŠ¶æ€ - æ”¯æŒå¤šè¯­è¨€é€šçŸ¥å’Œè¿›åº¦å¯è§†åŒ–
        function showTranslateStatus(message, duration = 0, forceLanguage = null, progress = null) {
          // è·å–é€šçŸ¥æ–‡æœ¬çš„å¤šè¯­è¨€ç‰ˆæœ¬
          const getLocalizedMessage = (msg, lang) => {
            const translations = {
              'chinese_simplified': {
                'ä¸æ”¯æŒçš„è¯­è¨€': 'ä¸æ”¯æŒçš„è¯­è¨€',
                'ç¿»è¯‘è¿›è¡Œä¸­ï¼Œè¯·ç¨å€™': 'ç¿»è¯‘è¿›è¡Œä¸­ï¼Œè¯·ç¨å€™',
                'é¡µé¢æ— éœ€ç¿»è¯‘': 'é¡µé¢æ— éœ€ç¿»è¯‘',
                'æ²¡æœ‰æ‰¾åˆ°éœ€è¦ç¿»è¯‘çš„å†…å®¹': 'æ²¡æœ‰æ‰¾åˆ°éœ€è¦ç¿»è¯‘çš„å†…å®¹',
                'ç¿»è¯‘å¤±è´¥ï¼Œè¯·é‡è¯•': 'ç¿»è¯‘å¤±è´¥ï¼Œè¯·é‡è¯•',
                'å·²æ¢å¤ä¸­æ–‡': 'å·²æ¢å¤ä¸­æ–‡',
                'å·²æ¸…é™¤æ‰€æœ‰ç¿»è¯‘è®¾ç½®': 'å·²æ¸…é™¤æ‰€æœ‰ç¿»è¯‘è®¾ç½®',  
                'å·²æ¢å¤å½“å‰é¡µé¢ï¼Œå…¶ä»–é¡µé¢ä¿æŒç¿»è¯‘çŠ¶æ€': 'å·²æ¢å¤å½“å‰é¡µé¢ï¼Œå…¶ä»–é¡µé¢ä¿æŒç¿»è¯‘çŠ¶æ€',
                'ç¼“å­˜å·²æ¸…é™¤ï¼Œé‡ç½®ä¸ºä¸­æ–‡': 'ç¼“å­˜å·²æ¸…é™¤ï¼Œé‡ç½®ä¸ºä¸­æ–‡',
                'æ¸…é™¤ç¼“å­˜å¤±è´¥': 'æ¸…é™¤ç¼“å­˜å¤±è´¥'
              },
              'english': {
                'ä¸æ”¯æŒçš„è¯­è¨€': 'Unsupported language',
                'ç¿»è¯‘è¿›è¡Œä¸­ï¼Œè¯·ç¨å€™': 'Translation in progress, please wait',
                'é¡µé¢æ— éœ€ç¿»è¯‘': 'Page does not need translation',
                'æ²¡æœ‰æ‰¾åˆ°éœ€è¦ç¿»è¯‘çš„å†…å®¹': 'No content found for translation',
                'ç¿»è¯‘å¤±è´¥ï¼Œè¯·é‡è¯•': 'Translation failed, please try again',
                'å·²æ¢å¤ä¸­æ–‡': 'Restored to Chinese',
                'å·²æ¸…é™¤æ‰€æœ‰ç¿»è¯‘è®¾ç½®': 'All translation settings cleared',
                'å·²æ¢å¤å½“å‰é¡µé¢ï¼Œå…¶ä»–é¡µé¢ä¿æŒç¿»è¯‘çŠ¶æ€': 'Current page restored, other pages keep translation',
                'ç¼“å­˜å·²æ¸…é™¤ï¼Œé‡ç½®ä¸ºä¸­æ–‡': 'Cache cleared, reset to Chinese',
                'æ¸…é™¤ç¼“å­˜å¤±è´¥': 'Failed to clear cache'
              },
              'korean': {
                'ä¸æ”¯æŒçš„è¯­è¨€': 'ì§€ì›ë˜ì§€ ì•ŠëŠ” ì–¸ì–´',
                'ç¿»è¯‘è¿›è¡Œä¸­ï¼Œè¯·ç¨å€™': 'ë²ˆì—­ ì§„í–‰ ì¤‘, ì ì‹œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”',
                'é¡µé¢æ— éœ€ç¿»è¯‘': 'í˜ì´ì§€ì— ë²ˆì—­ì´ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤',
                'æ²¡æœ‰æ‰¾åˆ°éœ€è¦ç¿»è¯‘çš„å†…å®¹': 'ë²ˆì—­í•  ë‚´ìš©ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤',
                'ç¿»è¯‘å¤±è´¥ï¼Œè¯·é‡è¯•': 'ë²ˆì—­ ì‹¤íŒ¨, ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”',
                'å·²æ¢å¤ä¸­æ–‡': 'ì¤‘êµ­ì–´ë¡œ ë³µì›ë¨',
                'å·²æ¸…é™¤æ‰€æœ‰ç¿»è¯‘è®¾ç½®': 'ëª¨ë“  ë²ˆì—­ ì„¤ì •ì´ ì§€ì›Œì¡ŒìŠµë‹ˆë‹¤',
                'å·²æ¢å¤å½“å‰é¡µé¢ï¼Œå…¶ä»–é¡µé¢ä¿æŒç¿»è¯‘çŠ¶æ€': 'í˜„ì¬ í˜ì´ì§€ ë³µì›, ë‹¤ë¥¸ í˜ì´ì§€ëŠ” ë²ˆì—­ ìƒíƒœ ìœ ì§€',
                'ç¼“å­˜å·²æ¸…é™¤ï¼Œé‡ç½®ä¸ºä¸­æ–‡': 'ìºì‹œ ì§€ì›Œì§, ì¤‘êµ­ì–´ë¡œ ì¬ì„¤ì •',
                'æ¸…é™¤ç¼“å­˜å¤±è´¥': 'ìºì‹œ ì§€ìš°ê¸° ì‹¤íŒ¨'
              },
              'japanese': {
                'ä¸æ”¯æŒçš„è¯­è¨€': 'ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„è¨€èª',
                'ç¿»è¯‘è¿›è¡Œä¸­ï¼Œè¯·ç¨å€™': 'ç¿»è¨³ä¸­ã§ã™ã€ãŠå¾…ã¡ãã ã•ã„',
                'é¡µé¢æ— éœ€ç¿»è¯‘': 'ãƒšãƒ¼ã‚¸ã¯ç¿»è¨³ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã›ã‚“',
                'æ²¡æœ‰æ‰¾åˆ°éœ€è¦ç¿»è¯‘çš„å†…å®¹': 'ç¿»è¨³ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
                'ç¿»è¯‘å¤±è´¥ï¼Œè¯·é‡è¯•': 'ç¿»è¨³ã«å¤±æ•—ã—ã¾ã—ãŸã€å†è©¦è¡Œã—ã¦ãã ã•ã„',
                'å·²æ¢å¤ä¸­æ–‡': 'ä¸­å›½èªã«å¾©å…ƒã•ã‚Œã¾ã—ãŸ',
                'å·²æ¸…é™¤æ‰€æœ‰ç¿»è¯‘è®¾ç½®': 'ã™ã¹ã¦ã®ç¿»è¨³è¨­å®šã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ',
                'å·²æ¢å¤å½“å‰é¡µé¢ï¼Œå…¶ä»–é¡µé¢ä¿æŒç¿»è¯‘çŠ¶æ€': 'ç¾åœ¨ã®ãƒšãƒ¼ã‚¸ã‚’å¾©å…ƒã€ä»–ã®ãƒšãƒ¼ã‚¸ã¯ç¿»è¨³çŠ¶æ…‹ã‚’ç¶­æŒ',
                'ç¼“å­˜å·²æ¸…é™¤ï¼Œé‡ç½®ä¸ºä¸­æ–‡': 'ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã€ä¸­å›½èªã«ãƒªã‚»ãƒƒãƒˆ',
                'æ¸…é™¤ç¼“å­˜å¤±è´¥': 'ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ã‚¯ãƒªã‚¢ã«å¤±æ•—'
              }
            };
            
            const langTranslations = translations[lang] || translations['chinese_simplified'];
            
            // å¤„ç†åŠ¨æ€æ¶ˆæ¯ï¼ˆåŒ…å«å˜é‡çš„æ¶ˆæ¯ï¼‰
            if (msg.includes('ç¿»è¯‘ä¸­...') || msg.includes('Translation...') || msg.includes('ë²ˆì—­ ì¤‘...') || msg.includes('ç¿»è¨³ä¸­...')) {
              // ä¿æŒè¿›åº¦æ¶ˆæ¯çš„åŸæ ·ï¼Œå› ä¸ºå®ƒä»¬åŒ…å«åŠ¨æ€å†…å®¹
              return msg;
            }
            
            if (msg.includes('ç¿»è¯‘å®Œæˆ') || msg.includes('Translation completed') || msg.includes('ë²ˆì—­ ì™„ë£Œ') || msg.includes('ç¿»è¨³å®Œäº†')) {
              // ä¿æŒå®Œæˆæ¶ˆæ¯çš„åŸæ ·ï¼Œå› ä¸ºå®ƒä»¬åŒ…å«ç»Ÿè®¡ä¿¡æ¯
              return msg;
            }
            
            if (msg.includes('âœ…') && lang !== 'chinese_simplified') {
              // å¤„ç†åŒ…å«ç›®æ ‡è¯­è¨€åç§°çš„æ¶ˆæ¯
              if (lang === 'english' && msg.includes('English')) return msg;
              if (lang === 'korean' && msg.includes('í•œêµ­ì–´')) return msg;
              if (lang === 'japanese' && msg.includes('æ—¥æœ¬èª')) return msg;
            }
            
            // æŸ¥æ‰¾å®Œå…¨åŒ¹é…çš„ç¿»è¯‘
            for (const [key, value] of Object.entries(langTranslations)) {
              if (msg === key) {
                return value;
              }
            }
            
            return msg; // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç¿»è¯‘ï¼Œè¿”å›åŸæ–‡
          };
          
          // ç¡®å®šä½¿ç”¨çš„è¯­è¨€
          const displayLanguage = forceLanguage || currentLanguage || 'chinese_simplified';
          const localizedMessage = getLocalizedMessage(message, displayLanguage);
          
          let statusEl = document.getElementById('translate-status');
          
          // å¦‚æœå·²æœ‰çŠ¶æ€å…ƒç´ ï¼Œå…ˆç§»é™¤é¿å…å†²çª
          if (statusEl) {
            statusEl.remove();
            statusEl = null;
          }
          
          // åˆ›å»ºæ–°çš„çŠ¶æ€å…ƒç´ 
          if (!statusEl) {
            statusEl = document.createElement('div');
            statusEl.id = 'translate-status';
            statusEl.style.cssText = `
              position: fixed;
              top: 20px;
              right: 20px;
              background: rgba(0, 0, 0, 0.9);
              color: white;
              padding: 16px 20px;
              border-radius: 12px;
              font-size: 14px;
              z-index: 10000;
              transition: all 0.3s ease;
              backdrop-filter: blur(10px);
              border: 1px solid rgba(255, 255, 255, 0.2);
              box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
              min-width: 200px;
              max-width: 350px;
            `;
            document.body.appendChild(statusEl);
          }
          
          // åˆ›å»ºçŠ¶æ€å†…å®¹
          let statusContent = `<div style="display: flex; align-items: center; gap: 12px;">`;
          
          // æ·»åŠ å›¾æ ‡
          if (message.includes('ç¿»è¯‘ä¸­') || message.includes('Translation') || message.includes('ë²ˆì—­') || message.includes('ç¿»è¨³')) {
            statusContent += `<div class="translate-spinner" style="
              width: 20px;
              height: 20px;
              border: 2px solid rgba(255, 255, 255, 0.3);
              border-top: 2px solid white;
              border-radius: 50%;
              animation: translateSpin 1s linear infinite;
            "></div>`;
          } else if (message.includes('âœ…') || message.includes('å®Œæˆ') || message.includes('æˆåŠŸ')) {
            statusContent += `<span style="font-size: 18px;">âœ…</span>`;
          } else if (message.includes('âŒ') || message.includes('å¤±è´¥') || message.includes('é”™è¯¯')) {
            statusContent += `<span style="font-size: 18px;">âŒ</span>`;
          } else {
            statusContent += `<span style="font-size: 18px;">ğŸŒ</span>`;
          }
          
          statusContent += `<div style="flex: 1;">
            <div style="font-weight: 600; margin-bottom: 4px;">${localizedMessage}</div>`;
          
          // æ·»åŠ è¿›åº¦æ¡
          if (progress !== null && progress.current && progress.total) {
            const percentage = Math.round((progress.current / progress.total) * 100);
            statusContent += `
              <div style="margin-bottom: 6px;">
                <div style="
                  width: 100%;
                  height: 4px;
                  background: rgba(255, 255, 255, 0.2);
                  border-radius: 2px;
                  overflow: hidden;
                ">
                  <div style="
                    width: ${percentage}%;
                    height: 100%;
                    background: linear-gradient(90deg, #4CAF50, #8BC34A);
                    transition: width 0.3s ease;
                  "></div>
                </div>
              </div>
              <div style="
                font-size: 12px;
                color: rgba(255, 255, 255, 0.8);
                text-align: center;
              ">${progress.current}/${progress.total} (${percentage}%)</div>`;
          }
          
          statusContent += `</div></div>`;
          
          statusEl.innerHTML = statusContent;
          statusEl.style.opacity = '1';
          statusEl.style.transform = 'translateY(0)';
          
          // æ·»åŠ åŠ¨ç”»æ ·å¼
          if (!document.getElementById('translate-status-styles')) {
            const style = document.createElement('style');
            style.id = 'translate-status-styles';
            style.textContent = `
              @keyframes translateSpin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
              }
            `;
            document.head.appendChild(style);
          }
          
          if (duration > 0) {
            setTimeout(() => {
              statusEl.style.opacity = '0';
              statusEl.style.transform = 'translateY(-10px)';
              setTimeout(() => {
                if (statusEl.parentNode) {
                  statusEl.parentNode.removeChild(statusEl);
                }
              }, 300);
            }, duration);
          }
        }
        
        // å¿«æ·é”®ç®¡ç†å™¨
        const ShortcutManager = {
          shortcuts: new Map(),
          isInitialized: false,
          
          // åˆå§‹åŒ–å¿«æ·é”®
          init: function() {
            if (this.isInitialized) return;
            
            // å®šä¹‰å¿«æ·é”®
            this.shortcuts.set('Ctrl+Shift+T', () => this.showTranslationMenu());
            this.shortcuts.set('Ctrl+Shift+E', () => window.translateTo('english'));
            this.shortcuts.set('Ctrl+Shift+K', () => window.translateTo('korean'));
            this.shortcuts.set('Ctrl+Shift+J', () => window.translateTo('japanese'));
            this.shortcuts.set('Ctrl+Shift+C', () => window.translateTo('chinese_simplified'));
            this.shortcuts.set('Ctrl+Shift+R', () => window.clearTranslateCache());
            this.shortcuts.set('Ctrl+Shift+X', async () => {
              if (isTranslating) {
                await cancelCurrentTranslation('ç”¨æˆ·æ‰‹åŠ¨ä¸­æ–­');
                showTranslateStatus('ç¿»è¯‘å·²ä¸­æ–­', 2000);
              }
            });
            this.shortcuts.set('Escape', () => this.hideTranslationMenu());
            
            // ç›‘å¬é”®ç›˜äº‹ä»¶
            document.addEventListener('keydown', (e) => this.handleKeydown(e));
            
            this.isInitialized = true;
            console.log('âŒ¨ï¸ ç¿»è¯‘å¿«æ·é”®å·²åˆå§‹åŒ–');
            console.log('å¿«æ·é”®åˆ—è¡¨ï¼š');
            console.log('- Ctrl+Shift+T: æ˜¾ç¤ºç¿»è¯‘èœå•');
            console.log('- Ctrl+Shift+E: ç¿»è¯‘ä¸ºEnglish');
            console.log('- Ctrl+Shift+K: ç¿»è¯‘ä¸ºí•œêµ­ì–´');
            console.log('- Ctrl+Shift+J: ç¿»è¯‘ä¸ºæ—¥æœ¬èª');
            console.log('- Ctrl+Shift+C: æ¢å¤ä¸­æ–‡');
            console.log('- Ctrl+Shift+R: æ¸…é™¤ç¿»è¯‘ç¼“å­˜');
            console.log('- Ctrl+Shift+X: ä¸­æ–­å½“å‰ç¿»è¯‘');
          },
          
          // å¤„ç†é”®ç›˜äº‹ä»¶
          handleKeydown: function(e) {
            // å¿½ç•¥åœ¨è¾“å…¥æ¡†ä¸­çš„æŒ‰é”®
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.isContentEditable) {
              return;
            }
            
            const key = this.getKeyString(e);
            const handler = this.shortcuts.get(key);
            
            if (handler) {
              e.preventDefault();
              e.stopPropagation();
              handler();
            }
          },
          
          // è·å–æŒ‰é”®å­—ç¬¦ä¸²
          getKeyString: function(e) {
            const parts = [];
            
            if (e.ctrlKey) parts.push('Ctrl');
            if (e.shiftKey) parts.push('Shift');
            if (e.altKey) parts.push('Alt');
            if (e.metaKey) parts.push('Meta');
            
            if (e.key && e.key !== 'Control' && e.key !== 'Shift' && e.key !== 'Alt' && e.key !== 'Meta') {
              parts.push(e.key);
            }
            
            return parts.join('+');
          },
          
          // æ˜¾ç¤ºç¿»è¯‘èœå•
          showTranslationMenu: function() {
            let menu = document.getElementById('translation-shortcut-menu');
            
            if (menu) {
              menu.remove();
            }
            
            menu = document.createElement('div');
            menu.id = 'translation-shortcut-menu';
            menu.style.cssText = `
              position: fixed;
              top: 50%;
              left: 50%;
              transform: translate(-50%, -50%);
              background: rgba(0, 0, 0, 0.95);
              color: white;
              border-radius: 16px;
              padding: 24px;
              font-size: 14px;
              z-index: 10001;
              backdrop-filter: blur(20px);
              border: 1px solid rgba(255, 255, 255, 0.2);
              box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
              min-width: 300px;
              animation: menuFadeIn 0.3s ease-out;
            `;
            
            // æ·»åŠ åŠ¨ç”»æ ·å¼
            if (!document.getElementById('shortcut-menu-styles')) {
              const style = document.createElement('style');
              style.id = 'shortcut-menu-styles';
              style.textContent = `
                @keyframes menuFadeIn {
                  from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
                  to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                }
                .menu-item {
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                  padding: 12px 16px;
                  border-radius: 8px;
                  cursor: pointer;
                  transition: all 0.2s ease;
                  margin: 4px 0;
                }
                .menu-item:hover {
                  background: rgba(255, 255, 255, 0.1);
                  transform: translateX(4px);
                }
                .menu-shortcut {
                  font-family: monospace;
                  background: rgba(255, 255, 255, 0.1);
                  padding: 4px 8px;
                  border-radius: 4px;
                  font-size: 12px;
                }
              `;
              document.head.appendChild(style);
            }
            
            const currentLang = window.getCurrentLanguageName();
            
            menu.innerHTML = `
              <div style="text-align: center; margin-bottom: 20px;">
                <h3 style="margin: 0 0 8px 0; font-size: 18px; font-weight: 700;">ğŸŒ ç¿»è¯‘å¿«æ·èœå•</h3>
                <p style="margin: 0; color: rgba(255, 255, 255, 0.7); font-size: 12px;">å½“å‰è¯­è¨€: ${currentLang}</p>
              </div>
              
              <div class="menu-item" onclick="window.translateTo('english'); this.parentElement.remove();">
                <span>ğŸ‡ºğŸ‡¸ ç¿»è¯‘ä¸º English</span>
                <span class="menu-shortcut">Ctrl+Shift+E</span>
              </div>
              
              <div class="menu-item" onclick="window.translateTo('korean'); this.parentElement.remove();">
                <span>ğŸ‡°ğŸ‡· ç¿»è¯‘ä¸º í•œêµ­ì–´</span>
                <span class="menu-shortcut">Ctrl+Shift+K</span>
              </div>
              
              <div class="menu-item" onclick="window.translateTo('japanese'); this.parentElement.remove();">
                <span>ğŸ‡¯ğŸ‡µ ç¿»è¯‘ä¸º æ—¥æœ¬èª</span>
                <span class="menu-shortcut">Ctrl+Shift+J</span>
              </div>
              
              <div class="menu-item" onclick="window.translateTo('chinese_simplified'); this.parentElement.remove();">
                <span>ğŸ‡¨ğŸ‡³ æ¢å¤ä¸­æ–‡</span>
                <span class="menu-shortcut">Ctrl+Shift+C</span>
              </div>
              
              <div style="border-top: 1px solid rgba(255, 255, 255, 0.1); margin: 12px 0; padding-top: 12px;">
                ${isTranslating ? `
                <div class="menu-item" onclick="(async () => { await cancelCurrentTranslation('ç”¨æˆ·æ‰‹åŠ¨ä¸­æ–­'); showTranslateStatus('ç¿»è¯‘å·²ä¸­æ–­', 2000); this.parentElement.parentElement.remove(); })();">
                  <span>â¹ï¸ ä¸­æ–­å½“å‰ç¿»è¯‘</span>
                  <span class="menu-shortcut">Ctrl+Shift+X</span>
                </div>
                ` : ''}
                <div class="menu-item" onclick="window.clearTranslateCache(); this.parentElement.parentElement.remove();">
                  <span>ğŸ—‘ï¸ æ¸…é™¤ç¿»è¯‘ç¼“å­˜</span>
                  <span class="menu-shortcut">Ctrl+Shift+R</span>
                </div>
              </div>
              
              <div style="text-align: center; margin-top: 16px;">
                <div style="font-size: 12px; color: rgba(255, 255, 255, 0.5);">
                  æŒ‰ ESC å…³é—­èœå•
                </div>
              </div>
            `;
            
            document.body.appendChild(menu);
            
            // ç‚¹å‡»å¤–éƒ¨å…³é—­
            setTimeout(() => {
              const closeOnClickOutside = (e) => {
                if (!menu.contains(e.target)) {
                  menu.remove();
                  document.removeEventListener('click', closeOnClickOutside);
                }
              };
              document.addEventListener('click', closeOnClickOutside);
            }, 100);
          },
          
          // éšè—ç¿»è¯‘èœå•
          hideTranslationMenu: function() {
            const menu = document.getElementById('translation-shortcut-menu');
            if (menu) {
              menu.remove();
            }
          }
        };
        
        // è·å–å½“å‰é¡µé¢æ ‡è¯†
        function getCurrentPageKey() {
          const url = new URL(window.location.href);
          return url.pathname + url.search;
        }
        
        // ä¿å­˜å½“å‰é¡µé¢çŠ¶æ€
        function saveCurrentPageState() {
          const pageKey = getCurrentPageKey();
          
          // ä¿æŒç°æœ‰çš„explicitæ ‡è®°ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
          const existingState = pageTranslationStates.get(pageKey);
          const newState = {
            language: currentLanguage,
            timestamp: Date.now(),
            url: window.location.href
          };
          
          // å¦‚æœä¹‹å‰æœ‰explicitæ ‡è®°ï¼Œä¿ç•™å®ƒ
          if (existingState && existingState.explicit) {
            newState.explicit = true;
          }
          
          pageTranslationStates.set(pageKey, newState);
          savePersistentCache();
        }
        
        // é¡µé¢ç¿»è¯‘ä¸»å‡½æ•° - æ”¯æŒä¸­æ–­çš„å¢å¼ºç‰ˆ
        async function translatePage(targetLang, isAutoTranslate = false) {
          // å¦‚æœæ­£åœ¨ç¿»è¯‘ä¸”ç”¨æˆ·ä¸»åŠ¨åˆ‡æ¢åˆ°ä¸­æ–‡ï¼Œç«‹å³ä¸­æ–­å½“å‰ç¿»è¯‘
          if (isTranslating && targetLang === 'chinese_simplified' && !isAutoTranslate) {
            console.log('ğŸ›‘ ç”¨æˆ·åˆ‡æ¢åˆ°ä¸­æ–‡ï¼Œä¸­æ–­å½“å‰ç¿»è¯‘');
            await cancelCurrentTranslation('ç”¨æˆ·åˆ‡æ¢åˆ°ä¸­æ–‡');
          }
          
          // å¦‚æœæ­£åœ¨ç¿»è¯‘ä¸”ä¸æ˜¯è‡ªåŠ¨ç¿»è¯‘ï¼Œæ ¹æ®æƒ…å†µå¤„ç†
          if (isTranslating && !isAutoTranslate) {
            if (targetLang === 'chinese_simplified') {
              // å·²ç»åœ¨ä¸Šé¢å¤„ç†äº†ä¸­æ–­
            } else {
              console.log('ğŸ”„ ä¸­æ–­å¹¶åˆ‡æ¢ç¿»è¯‘è¯­è¨€');
              await cancelCurrentTranslation('åˆ‡æ¢ç¿»è¯‘è¯­è¨€');
            }
          } else if (isTranslating && isAutoTranslate) {
            console.log('â¸ï¸ ç¿»è¯‘è¿›è¡Œä¸­ï¼Œè·³è¿‡è‡ªåŠ¨ç¿»è¯‘è¯·æ±‚');
            return;
          }
          
          if (!targetLang || !LANGUAGE_MAP[targetLang]) {
            console.warn(`âŒ ä¸æ”¯æŒçš„è¯­è¨€: ${targetLang}`);
            showTranslateStatus('ä¸æ”¯æŒçš„è¯­è¨€', 2000);
            return;
          }
          
          // é‡ç½®ä¸­æ–­æ ‡å¿—
          shouldCancelTranslation = false;
          isTranslating = true;
          
          // åˆ›å»ºæ–°çš„AbortController
          translationAbortController = new AbortController();
          
          console.log(`ğŸ¯ å¼€å§‹ç¿»è¯‘é¡µé¢: ${LANGUAGE_MAP[currentLanguage]} -> ${LANGUAGE_MAP[targetLang]}`);
          
          try {
            // ä¸åœ¨è¿™é‡Œæ˜¾ç¤ºåˆå§‹ç¿»è¯‘çŠ¶æ€ï¼Œå› ä¸ºåé¢ä¼šæœ‰è¯¦ç»†çš„è¿›åº¦æ˜¾ç¤º
            
            if (targetLang === 'chinese_simplified') {
              // æ¢å¤ä¸­æ–‡ - å§‹ç»ˆæ¢å¤åˆ°åŸå§‹ä¸­æ–‡çŠ¶æ€
              console.log('ğŸ”„ æ¢å¤ä¸­æ–‡çŠ¶æ€');
              
              // ä¼˜å…ˆä½¿ç”¨åŸå§‹æ–‡æœ¬æ˜ å°„æ¢å¤
              if (originalTexts.size > 0) {
                let restoredCount = 0;
                originalTexts.forEach((originalText, node) => {
                  if (node && node.parentNode && originalText) {
                    try {
                      node.textContent = originalText;
                      restoredCount++;
                    } catch (e) {
                      console.warn('æ¢å¤å•ä¸ªèŠ‚ç‚¹å¤±è´¥:', e);
                    }
                  }
                });
                console.log(`âœ… å·²æ¢å¤ ${restoredCount}/${originalTexts.size} ä¸ªæ–‡æœ¬èŠ‚ç‚¹`);
              }
              
              // æ¸…ç†æ‰€æœ‰ç¿»è¯‘æ ‡è®° - ä½œä¸ºå¤‡ç”¨æ¢å¤æœºåˆ¶
              const translatedElements = document.querySelectorAll('[data-translated]');
              if (translatedElements.length > 0) {
                let cleanedCount = 0;
                translatedElements.forEach(element => {
                  try {
                    const originalText = element.getAttribute('data-original-text');
                    if (originalText) {
                      element.textContent = originalText;
                      cleanedCount++;
                    }
                    element.removeAttribute('data-translated');
                    element.removeAttribute('data-original-text');
                  } catch (e) {
                    console.warn('æ¸…ç†å•ä¸ªå…ƒç´ å¤±è´¥:', e);
                  }
                });
                console.log(`ğŸ§¹ æ¸…ç†äº† ${cleanedCount} ä¸ªç¿»è¯‘æ ‡è®°`);
              }
              
              currentLanguage = targetLang;
              
              // ä¿ç•™originalTextsç”¨äºåç»­ç¿»è¯‘
              console.log(`ğŸ“ ä¿ç•™ ${originalTexts.size} ä¸ªåŸå§‹æ–‡æœ¬æ˜ å°„ä¾›åç»­ä½¿ç”¨`);
              
              saveCurrentPageState();
              
              // æ¸…é™¤ä»»ä½•æ­£åœ¨æ˜¾ç¤ºçš„çŠ¶æ€
              const existingStatus = document.getElementById('translate-status');
              if (existingStatus) {
                existingStatus.remove();
              }
              
              showTranslateStatus('å·²æ¢å¤ä¸­æ–‡', 2000);
              return;
            }
            
            // ç¿»è¯‘åˆ°å…¶ä»–è¯­è¨€
            console.log('ğŸŒ å¼€å§‹ç¿»è¯‘åˆ°å…¶ä»–è¯­è¨€');
            
            // æ™ºèƒ½çŠ¶æ€æ£€æŸ¥å’Œé‡ç½®
            if (currentLanguage !== 'chinese_simplified') {
              console.log('ğŸ”„ å…ˆæ¢å¤ä¸­æ–‡çŠ¶æ€ä»¥è·å–æ­£ç¡®çš„åŸå§‹æ–‡æœ¬');
              
              // æ¢å¤ä¸­æ–‡
              if (originalTexts.size > 0) {
                let restoredCount = 0;
                originalTexts.forEach((originalText, node) => {
                  if (node && node.parentNode && originalText) {
                    try {
                      node.textContent = originalText;
                      restoredCount++;
                    } catch (e) {
                      console.warn('æ¢å¤å•ä¸ªèŠ‚ç‚¹å¤±è´¥:', e);
                    }
                  }
                });
                console.log(`âœ… æ¢å¤äº† ${restoredCount} ä¸ªæ–‡æœ¬èŠ‚ç‚¹`);
              }
              
              // æ¸…ç†ç¿»è¯‘æ ‡è®°
              const translatedElements = document.querySelectorAll('[data-translated]');
              if (translatedElements.length > 0) {
                translatedElements.forEach(element => {
                  try {
                    const originalText = element.getAttribute('data-original-text');
                    if (originalText) {
                      element.textContent = originalText;
                    }
                    element.removeAttribute('data-translated');
                    element.removeAttribute('data-original-text');
                  } catch (e) {
                    console.warn('æ¸…ç†å•ä¸ªå…ƒç´ å¤±è´¥:', e);
                  }
                });
              }
              
              currentLanguage = 'chinese_simplified';
              
              // ç­‰å¾…DOMæ›´æ–°
              await new Promise(resolve => setTimeout(resolve, 100));
            }
            
            // è·å–å½“å‰é¡µé¢çš„æ–‡æœ¬èŠ‚ç‚¹
            const textNodeData = getTextNodes(document.body);
            
            // ç¡®ä¿åœ¨ç¿»è¯‘å¼€å§‹å‰å»ºç«‹å®Œæ•´çš„åŸå§‹æ–‡æœ¬æ˜ å°„
            console.log('ğŸ“ ç¡®ä¿åŸå§‹æ–‡æœ¬æ˜ å°„å®Œæ•´å»ºç«‹');
            
            // ä¸ºæ‰€æœ‰å¯ç¿»è¯‘çš„æ–‡æœ¬èŠ‚ç‚¹å»ºç«‹æ˜ å°„ï¼Œç¡®ä¿ä¸­æ–­æ—¶èƒ½æ­£ç¡®æ¢å¤
            let mappingUpdated = false;
            textNodeData.forEach(({ node, text }) => {
              if (text && text.length > 1 && text.trim()) {
                if (!originalTexts.has(node)) {
                  // è·å–èŠ‚ç‚¹çš„å½“å‰åŸå§‹æ–‡æœ¬ï¼ˆæœªç¿»è¯‘çŠ¶æ€ï¼‰
                  const currentText = node.textContent.trim();
                  if (currentText && currentText === text) {
                    originalTexts.set(node, text);
                    mappingUpdated = true;
                  }
                }
              }
            });
            
            if (mappingUpdated) {
              console.log(`ğŸ“ åŸå§‹æ–‡æœ¬æ˜ å°„å·²å®Œå–„ï¼Œæ€»è®¡ ${originalTexts.size} ä¸ªèŠ‚ç‚¹`);
            } else {
              console.log(`ğŸ“ åŸå§‹æ–‡æœ¬æ˜ å°„å·²å­˜åœ¨ï¼Œæ€»è®¡ ${originalTexts.size} ä¸ªèŠ‚ç‚¹`);
            }
            
            // å‡†å¤‡ç¿»è¯‘çš„æ–‡æœ¬ - ä½¿ç”¨åŸå§‹æ–‡æœ¬ç¡®ä¿è´¨é‡
            const textsToTranslate = [];
            textNodeData.forEach(({ node, text }) => {
              if (text && text.length > 1 && text.trim()) {
                // ä¼˜å…ˆä½¿ç”¨æ˜ å°„ä¸­çš„åŸå§‹æ–‡æœ¬ï¼Œç¡®ä¿ç¿»è¯‘è´¨é‡
                const originalText = originalTexts.get(node) || text;
                textsToTranslate.push({ node, text: originalText });
              }
            });
            
            if (textsToTranslate.length === 0) {
              console.log('âš ï¸ æ²¡æœ‰æ‰¾åˆ°éœ€è¦ç¿»è¯‘çš„å†…å®¹');
              showTranslateStatus('æ²¡æœ‰æ‰¾åˆ°éœ€è¦ç¿»è¯‘çš„å†…å®¹', 2000);
              currentLanguage = targetLang;
              return;
            }
            
            console.log(`ğŸ“Š æ‰¾åˆ° ${textsToTranslate.length} ä¸ªæ–‡æœ¬èŠ‚ç‚¹éœ€è¦ç¿»è¯‘`);
            let translatedCount = 0;
            let skippedCount = 0;
            let failedCount = 0;
            
            // å¢å¼ºçš„åˆ†æ‰¹ç¿»è¯‘å¤„ç† - æ”¯æŒä¸­æ–­æ£€æŸ¥
            for (let i = 0; i < textsToTranslate.length; i += GLM_CONFIG.batchSize) {
              // æ£€æŸ¥æ˜¯å¦åº”è¯¥ä¸­æ–­ç¿»è¯‘
              if (shouldCancelTranslation || translationAbortController?.signal?.aborted) {
                console.log('ğŸ›‘ ç¿»è¯‘è¢«ä¸­æ–­ï¼Œåœæ­¢å¤„ç†');
                return;
              }
              
              const batch = textsToTranslate.slice(i, i + GLM_CONFIG.batchSize);
              
              const promises = batch.map(async ({ node, text }) => {
                try {
                  // å¢å¼ºçš„èŠ‚ç‚¹æœ‰æ•ˆæ€§æ£€æŸ¥
                  if (!node || !node.parentNode || !node.isConnected || !document.contains(node)) {
                    console.warn('âš ï¸ èŠ‚ç‚¹å·²å¤±æ•ˆï¼Œè·³è¿‡ç¿»è¯‘');
                    skippedCount++;
                    return { success: false, reason: 'invalid_node' };
                  }
                  
                  // å¢å¼ºçš„æ–‡æœ¬æœ‰æ•ˆæ€§æ£€æŸ¥
                  if (!text || !text.trim() || text.length < 2) {
                    skippedCount++;
                    return { success: false, reason: 'invalid_text' };
                  }
                  
                  // æ£€æŸ¥æ˜¯å¦åº”è¯¥è·³è¿‡ç¿»è¯‘
                  if (!shouldTranslateText(text)) {
                    skippedCount++;
                    return { success: false, reason: 'should_not_translate' };
                  }
                  
                  console.log(`ğŸ”„ ç¿»è¯‘æ–‡æœ¬: "${text.substring(0, 50)}${text.length > 50 ? '...' : ''}"`);
                  
                  const translatedText = await translateWithGLM(text, targetLang);
                  
                  // å¢å¼ºçš„ç¿»è¯‘ç»“æœéªŒè¯
                  if (translatedText && translatedText.trim() && translatedText !== text) {
                    // éªŒè¯ç¿»è¯‘è´¨é‡
                    const cleanedTranslation = validateAndCleanTranslation(text, translatedText, targetLang);
                    
                    if (cleanedTranslation !== text && node.isConnected && node.parentNode) {
                      // åŒé‡æ£€æŸ¥èŠ‚ç‚¹çŠ¶æ€ï¼Œç¡®ä¿å®‰å…¨æ›´æ–°
                      try {
                        node.textContent = cleanedTranslation;
                        node.setAttribute('data-translated', 'true');
                        node.setAttribute('data-original-text', text);
                        node.setAttribute('data-target-lang', targetLang);
                        translatedCount++;
                        return { success: true, original: text, translated: cleanedTranslation };
                      } catch (updateError) {
                        console.warn('âŒ æ›´æ–°èŠ‚ç‚¹å†…å®¹å¤±è´¥:', updateError);
                        skippedCount++; // æ”¹ä¸ºè·³è¿‡ï¼Œå› ä¸ºè¿™é€šå¸¸æ˜¯DOMå˜åŒ–å¯¼è‡´çš„
                        return { success: false, reason: 'update_failed', error: updateError };
                      }
                    } else if (cleanedTranslation === text) {
                      console.log('âšª ç¿»è¯‘ç»“æœä¸åŸæ–‡ç›¸åŒï¼Œå¯èƒ½æ— éœ€ç¿»è¯‘');
                      skippedCount++;
                      return { success: false, reason: 'same_as_original' };
                    } else {
                      console.warn('âŒ èŠ‚ç‚¹çŠ¶æ€å¼‚å¸¸ï¼Œè·³è¿‡æ›´æ–°');
                      skippedCount++; // æ”¹ä¸ºè·³è¿‡ï¼Œå› ä¸ºè¿™é€šå¸¸æ˜¯DOMçŠ¶æ€é—®é¢˜
                      return { success: false, reason: 'node_state_invalid' };
                    }
                  } else {
                    // ç¿»è¯‘ç»“æœæ— æ•ˆ - è¿™å¯èƒ½æ˜¯å› ä¸ºå†…å®¹ä¸éœ€è¦ç¿»è¯‘
                    console.log('âšª ç¿»è¯‘ç»“æœæ— æ•ˆæˆ–ä¸åŸæ–‡ç›¸åŒï¼Œè·³è¿‡');
                    skippedCount++;
                    return { success: false, reason: 'invalid_translation_result' };
                  }
                } catch (error) {
                  // åŒºåˆ†ä¸åŒç±»å‹çš„é”™è¯¯
                  if (error.name === 'AbortError' || shouldCancelTranslation) {
                    console.log('ğŸ›‘ ç¿»è¯‘è¢«ä¸­æ–­');
                    return { success: false, reason: 'translation_cancelled' };
                  } else if (error.message && error.message.includes('API')) {
                    console.warn('âš ï¸ APIè°ƒç”¨å¤±è´¥:', error.message);
                    failedCount++;
                    return { success: false, reason: 'api_error', error: error };
                  } else {
                    console.warn('âš ï¸ ç¿»è¯‘å¼‚å¸¸ï¼Œè·³è¿‡è¯¥é¡¹:', error.message || error);
                    skippedCount++; // å¤§å¤šæ•°å¼‚å¸¸æ”¹ä¸ºè·³è¿‡è€Œä¸æ˜¯å¤±è´¥
                    return { success: false, reason: 'translation_skipped', error: error };
                  }
                }
              });
              
              // ç­‰å¾…æ‰¹æ¬¡å®Œæˆå¹¶æ”¶é›†ç»“æœ
              const batchResults = await Promise.allSettled(promises);
              
              // åˆ†ææ‰¹æ¬¡ç»“æœ
              const successfulResults = batchResults.filter(result => 
                result.status === 'fulfilled' && result.value?.success
              );
              
              const failedResults = batchResults.filter(result => 
                result.status === 'rejected' || (result.status === 'fulfilled' && !result.value?.success)
              );
              
              if (failedResults.length > 0) {
                const failureReasons = failedResults.map(result => {
                  if (result.status === 'rejected') {
                    return `promise_rejected: ${result.reason}`;
                  } else {
                    return result.value?.reason || 'unknown';
                  }
                });
                console.log(`âš ï¸ æ‰¹æ¬¡ ${Math.floor(i / GLM_CONFIG.batchSize) + 1} å¤±è´¥ç»Ÿè®¡:`, failureReasons);
              }
              
              // æ›´æ–°è¿›åº¦ - ä¼˜åŒ–ç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤º
              const progress = Math.round(((i + GLM_CONFIG.batchSize) / textsToTranslate.length) * 100);
              const currentProgress = Math.min(progress, 100);
              
              // è®¡ç®—æˆåŠŸç‡å’Œè¯¦ç»†ç»Ÿè®¡
              const totalProcessed = translatedCount + skippedCount + failedCount;
              const successRate = totalProcessed > 0 ? Math.round((translatedCount / totalProcessed) * 100) : 0;
              
              // ä¼˜åŒ–çš„çŠ¶æ€æ¶ˆæ¯
              let statusMessage = `ç¿»è¯‘ä¸­... ${currentProgress}%`;
              
              if (totalProcessed > 0) {
                if (translatedCount > 0) {
                  statusMessage += ` (âœ…${translatedCount}`;
                  if (skippedCount > 0) statusMessage += ` â­ï¸${skippedCount}`;
                  if (failedCount > 0) statusMessage += ` âŒ${failedCount}`;
                  statusMessage += `)`;
                } else if (skippedCount > 0 && failedCount === 0) {
                  // ç¿»è¯‘è¿›è¡Œä¸­æ—¶ï¼Œä¸è¦æ˜¾ç¤º"å†…å®¹å·²æ˜¯ç›®æ ‡è¯­è¨€"ï¼Œè€Œæ˜¯æ˜¾ç¤ºå¤„ç†çŠ¶æ€
                  statusMessage += ` (åˆ†æå†…å®¹...)`;
                } else if (failedCount > 0) {
                  statusMessage += ` (å¤„ç†ä¸­...)`;
                } else {
                  statusMessage += ` (å‡†å¤‡ä¸­...)`;
                }
              }
              
              // æ˜¾ç¤ºå¸¦è¿›åº¦æ¡çš„çŠ¶æ€ï¼ˆè®¾ç½®è¾ƒçŸ­çš„æ˜¾ç¤ºæ—¶é—´ï¼Œé¿å…ä¸å®Œæˆæ¶ˆæ¯å†²çªï¼‰
              const progressInfo = {
                current: Math.min(i + GLM_CONFIG.batchSize, textsToTranslate.length),
                total: textsToTranslate.length
              };
              
              // å¦‚æœä¸æ˜¯æœ€åä¸€æ‰¹ï¼Œæ˜¾ç¤ºè¿›åº¦ï¼›å¦‚æœæ˜¯æœ€åä¸€æ‰¹ï¼Œä¸æ˜¾ç¤ºé¿å…ä¸å®Œæˆæ¶ˆæ¯å†²çª
              if (i + GLM_CONFIG.batchSize < textsToTranslate.length) {
                showTranslateStatus(statusMessage, 0, null, progressInfo);
              }
              
              // æ‰¹æ¬¡é—´å»¶è¿Ÿï¼Œé¿å…APIé™åˆ¶
              if (i + GLM_CONFIG.batchSize < textsToTranslate.length) {
                await new Promise(resolve => setTimeout(resolve, GLM_CONFIG.batchDelay));
              }
            }
            
            currentLanguage = targetLang;
            console.log(`ğŸ¯ å½“å‰è¯­è¨€å·²æ›´æ–°ä¸º: ${LANGUAGE_MAP[targetLang]}`);
            
            try {
              saveCurrentPageState();
              savePersistentCache();
            } catch (saveError) {
              console.warn('âš ï¸ ä¿å­˜çŠ¶æ€å¤±è´¥:', saveError);
            }
            
            const totalProcessed = translatedCount + skippedCount + failedCount;
            
            // ç«‹å³æ¸…é™¤ä»»ä½•æ­£åœ¨æ˜¾ç¤ºçš„è¿›åº¦çŠ¶æ€
            const existingStatus = document.getElementById('translate-status');
            if (existingStatus) {
              existingStatus.remove();
            }
            
            if (totalProcessed === 0) {
              showTranslateStatus('é¡µé¢æ— éœ€ç¿»è¯‘', 2000);
            } else if (translatedCount === 0 && skippedCount > 0 && failedCount === 0) {
              // åªæœ‰è·³è¿‡ï¼Œæ²¡æœ‰å¤±è´¥ - è¯´æ˜å†…å®¹å·²ç»æ˜¯ç›®æ ‡è¯­è¨€
              showTranslateStatus(`é¡µé¢å†…å®¹å·²æ˜¯${LANGUAGE_MAP[targetLang]} âœ…`, 2500);
            } else if (translatedCount === 0 && failedCount > 0) {
              // æ²¡æœ‰æˆåŠŸç¿»è¯‘ï¼Œä½†æœ‰å¤±è´¥é¡¹ç›® - æ™ºèƒ½æ˜¾ç¤º
              const failureRatio = failedCount / totalProcessed;
              if (skippedCount > failedCount * 5) {
                // è·³è¿‡çš„è¿œå¤šäºå¤±è´¥çš„ï¼Œè¯´æ˜å¤§éƒ¨åˆ†å†…å®¹ä¸éœ€è¦ç¿»è¯‘
                showTranslateStatus(`é¡µé¢å†…å®¹å·²æ˜¯${LANGUAGE_MAP[targetLang]} âœ…`, 2500);
              } else if (failureRatio < 0.3) {
                // å¤±è´¥ç‡ä½äº30%ï¼Œè®¤ä¸ºç¿»è¯‘åŸºæœ¬æˆåŠŸ
                showTranslateStatus(`ç¿»è¯‘å®Œæˆ âœ…`, 2500);
              } else {
                // å¤±è´¥è¾ƒå¤šï¼Œæ˜¾ç¤ºå‹å¥½çš„å¤±è´¥æ¶ˆæ¯
                showTranslateStatus('éƒ¨åˆ†å†…å®¹ç¿»è¯‘å¤±è´¥ï¼Œè¯·é‡è¯•', 3000);
              }
            } else if (translatedCount > 0) {
              const successRate = Math.round((translatedCount / totalProcessed) * 100);
              let finalMessage = `ç¿»è¯‘å®Œæˆ! âœ…${translatedCount}`;
              
              if (skippedCount > 0) finalMessage += ` â­ï¸${skippedCount}`;
              if (failedCount > 0) finalMessage += ` âŒ${failedCount}`;
              
              if (successRate >= 90) {
                finalMessage += ` ğŸ‰`;
              } else if (successRate >= 70) {
                finalMessage += ` âœ¨`;
              } else if (failedCount > translatedCount) {
                finalMessage += ` âš ï¸`;
              }
              
              showTranslateStatus(finalMessage, 3000);
            } else {
              // å…œåº•æƒ…å†µ - åº”è¯¥å¾ˆå°‘è§¦å‘
              showTranslateStatus('ç¿»è¯‘å¤„ç†å®Œæˆ', 2000);
            }
            
            console.log(`âœ… ç¿»è¯‘å®Œæˆ - æˆåŠŸ: ${translatedCount}, è·³è¿‡: ${skippedCount}, å¤±è´¥: ${failedCount}`);
            
          } catch (error) {
            console.error('ğŸ’¥ ç¿»è¯‘è¿‡ç¨‹å‘ç”Ÿé”™è¯¯:', error);
            
            // æ¸…é™¤ä»»ä½•æ­£åœ¨æ˜¾ç¤ºçš„è¿›åº¦çŠ¶æ€
            const existingStatus = document.getElementById('translate-status'); 
            if (existingStatus) {
              existingStatus.remove();
            }
            
            showTranslateStatus('ç¿»è¯‘å¤±è´¥ï¼Œè¯·é‡è¯•', 3000);
            
            // é”™è¯¯æ—¶é‡ç½®ä¸ºä¸­æ–‡çŠ¶æ€
            if (originalTexts.size > 0) {
              originalTexts.forEach((originalText, node) => {
                if (node.parentNode) {
                  node.textContent = originalText;
                }
              });
            }
            currentLanguage = 'chinese_simplified';
          } finally {
            // é‡ç½®ç¿»è¯‘çŠ¶æ€å’Œä¸­æ–­æ§åˆ¶
            isTranslating = false;
            shouldCancelTranslation = false;
            translationAbortController = null;
          }
        }
        
        // åˆ›å»ºæ™ºèƒ½ç”¨æˆ·é€‰æ‹©å¼¹çª— - ä¿®å¤è¯­è¨€ä¸€è‡´æ€§å’Œé€»è¾‘
        function createTranslationChoiceDialog() {
          return new Promise((resolve) => {
            // è·å–å½“å‰çŠ¶æ€ä¿¡æ¯
            const hasGlobalPreference = globalTranslationPreference && 
                                      globalTranslationPreference !== 'chinese_simplified' &&
                                      LANGUAGE_MAP[globalTranslationPreference];
            
            const otherPageCount = Array.from(pageTranslationStates.values()).filter(state => 
              state.language && 
              state.language !== 'chinese_simplified' &&
              LANGUAGE_MAP[state.language] &&
              state.timestamp &&
              (Date.now() - state.timestamp < CACHE_MAX_AGE)
            ).length;
            
            // å¦‚æœæ²¡æœ‰å…¨å±€åå¥½ä¹Ÿæ²¡æœ‰å…¶ä»–é¡µé¢çŠ¶æ€ï¼Œç›´æ¥è¿”å›ä»…å½“å‰é¡µé¢
            if (!hasGlobalPreference && otherPageCount === 0) {
              resolve('currentPageOnly');
              return;
            }
            
            // åˆ›å»ºå¼¹çª—å®¹å™¨
            const dialog = document.createElement('div');
            dialog.style.cssText = `
              position: fixed;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background: rgba(0, 0, 0, 0.6);
              display: flex;
              justify-content: center;
              align-items: center;
              z-index: 10000;
              font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
              backdrop-filter: blur(4px);
              animation: dialogBackdropFadeIn 0.3s ease-out;
            `;
            
            // åˆ›å»ºå¼¹çª—å†…å®¹
            const content = document.createElement('div');
            content.style.cssText = `
              background: white;
              border-radius: 16px;
              padding: 32px;
              max-width: 480px;
              width: 90%;
              box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
              text-align: center;
              animation: dialogContentFadeIn 0.4s ease-out;
              border: 1px solid rgba(0, 0, 0, 0.1);
            `;
            
            // æ·»åŠ åŠ¨ç”»æ ·å¼
            const style = document.createElement('style');
            style.textContent = `
              @keyframes dialogBackdropFadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
              }
              @keyframes dialogContentFadeIn {
                from {
                  opacity: 0;
                  transform: scale(0.9) translateY(-20px);
                }
                to {
                  opacity: 1;
                  transform: scale(1) translateY(0);
                }
              }
              .dialog-button {
                transition: all 0.2s ease;
              }
              .dialog-button:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
              }
            `;
            document.head.appendChild(style);
            
            // æ ¹æ®å½“å‰è¯­è¨€è·å–å¼¹çª—æ–‡æœ¬ - ä¿®å¤è¯­è¨€ä¸€è‡´æ€§
            const getDialogTexts = (lang) => {
              const texts = {
                'chinese_simplified': {
                  title: 'ç¿»è¯‘è®¾ç½®é€‰æ‹©',
                  question: 'æ‚¨å¸Œæœ›å¦‚ä½•å¤„ç†ç¿»è¯‘çŠ¶æ€ï¼Ÿ',
                  currentPageBtn: 'ä»…æ¢å¤å½“å‰é¡µé¢',
                  currentPageDesc: 'ä¿ç•™å…¶ä»–é¡µé¢çš„ç¿»è¯‘è®¾ç½®',
                  clearAllBtn: 'æ¸…é™¤æ‰€æœ‰ç¿»è¯‘è®¾ç½®',
                  clearAllDesc: 'æ‰€æœ‰é¡µé¢éƒ½å°†æ¢å¤ä¸­æ–‡',
                  tip: 'ğŸ’¡ æç¤ºï¼šæ‚¨å¯ä»¥éšæ—¶é‡æ–°è®¾ç½®ç¿»è¯‘åå¥½',
                  globalPref: 'å½“å‰å…¨å±€ç¿»è¯‘åå¥½',
                  pagesCount: 'ä¸ªé¡µé¢ä¿å­˜äº†ç¿»è¯‘çŠ¶æ€',
                  hasPages: 'æœ‰',
                  and: 'ï¼Œè¿˜æœ‰'
                },
                'english': {
                  title: 'Translation Settings',
                  question: 'How would you like to handle the translation state?',
                  currentPageBtn: 'Restore Current Page Only',
                  currentPageDesc: 'Keep translation settings for other pages',
                  clearAllBtn: 'Clear All Translation Settings',
                  clearAllDesc: 'All pages will be restored to Chinese',
                  tip: 'ğŸ’¡ Tip: You can reset translation preferences anytime',
                  globalPref: 'Current global translation preference',
                  pagesCount: 'pages have saved translation states',
                  hasPages: '',
                  and: ', and '
                },
                'korean': {
                  title: 'ë²ˆì—­ ì„¤ì •',
                  question: 'ë²ˆì—­ ìƒíƒœë¥¼ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
                  currentPageBtn: 'í˜„ì¬ í˜ì´ì§€ë§Œ ë³µì›',
                  currentPageDesc: 'ë‹¤ë¥¸ í˜ì´ì§€ì˜ ë²ˆì—­ ì„¤ì • ìœ ì§€',
                  clearAllBtn: 'ëª¨ë“  ë²ˆì—­ ì„¤ì • ì§€ìš°ê¸°',
                  clearAllDesc: 'ëª¨ë“  í˜ì´ì§€ê°€ ì¤‘êµ­ì–´ë¡œ ë³µì›ë©ë‹ˆë‹¤',
                  tip: 'ğŸ’¡ íŒ: ì–¸ì œë“ ì§€ ë²ˆì—­ ê¸°ë³¸ ì„¤ì •ì„ ì¬ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤',
                  globalPref: 'í˜„ì¬ ì „ì—­ ë²ˆì—­ ê¸°ë³¸ ì„¤ì •',
                  pagesCount: 'ê°œ í˜ì´ì§€ì— ë²ˆì—­ ìƒíƒœê°€ ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤',
                  hasPages: '',
                  and: ', ê·¸ë¦¬ê³  '
                },
                'japanese': {
                  title: 'ç¿»è¨³è¨­å®š',
                  question: 'ç¿»è¨³çŠ¶æ…‹ã‚’ã©ã®ã‚ˆã†ã«å‡¦ç†ã—ã¾ã™ã‹ï¼Ÿ',
                  currentPageBtn: 'ç¾åœ¨ã®ãƒšãƒ¼ã‚¸ã®ã¿å¾©å…ƒ',
                  currentPageDesc: 'ä»–ã®ãƒšãƒ¼ã‚¸ã®ç¿»è¨³è¨­å®šã‚’ä¿æŒ',
                  clearAllBtn: 'ã™ã¹ã¦ã®ç¿»è¨³è¨­å®šã‚’ã‚¯ãƒªã‚¢',
                  clearAllDesc: 'ã™ã¹ã¦ã®ãƒšãƒ¼ã‚¸ãŒä¸­å›½èªã«å¾©å…ƒã•ã‚Œã¾ã™',
                  tip: 'ğŸ’¡ ãƒ’ãƒ³ãƒˆï¼šã„ã¤ã§ã‚‚ç¿»è¨³è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆã§ãã¾ã™',
                  globalPref: 'ç¾åœ¨ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ç¿»è¨³è¨­å®š',
                  pagesCount: 'ãƒšãƒ¼ã‚¸ã«ç¿»è¨³çŠ¶æ…‹ãŒä¿å­˜ã•ã‚Œã¦ã„ã¾ã™',
                  hasPages: '',
                  and: 'ã€ãŠã‚ˆã³'
                }
              };
              return texts[lang] || texts['chinese_simplified'];
            };
            
            // ä½¿ç”¨å½“å‰è¯­è¨€æ˜¾ç¤ºå¼¹çª— - å…³é”®ä¿®å¤
            const dialogTexts = getDialogTexts(currentLanguage);
            
            // æ™ºèƒ½ç”Ÿæˆæç¤ºä¿¡æ¯
            let statusInfo = '';
            if (hasGlobalPreference && otherPageCount > 0) {
              statusInfo = `${dialogTexts.globalPref}ï¼š${LANGUAGE_MAP[globalTranslationPreference]}${dialogTexts.and}${otherPageCount} ${dialogTexts.pagesCount}`;
            } else if (hasGlobalPreference) {
              statusInfo = `${dialogTexts.globalPref}ï¼š${LANGUAGE_MAP[globalTranslationPreference]}`;
            } else if (otherPageCount > 0) {
              statusInfo = `${dialogTexts.hasPages} ${otherPageCount} ${dialogTexts.pagesCount}`;
            }
            
            content.innerHTML = `
              <div style="margin-bottom: 24px;">
                <div style="width: 56px; height: 56px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);">
                  <span style="font-size: 28px; color: white;">ğŸŒ</span>
                </div>
                <h3 style="margin: 0 0 12px 0; color: #2d3748; font-size: 20px; font-weight: 700;">${dialogTexts.title}</h3>
                ${statusInfo ? `<div style="margin: 0 0 20px 0; padding: 12px 16px; background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%); border-radius: 8px; border-left: 4px solid #4299e1;"><p style="margin: 0; color: #2d3748; font-size: 13px; font-weight: 500;">${statusInfo}</p></div>` : ''}
                <p style="margin: 0 0 28px 0; color: #4a5568; line-height: 1.6; font-size: 15px;">${dialogTexts.question}</p>
              </div>
              <div style="display: flex; flex-direction: column; gap: 16px;">
                <button id="currentPageOnly" class="dialog-button" style="
                  background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
                  border: 2px solid #e2e8f0;
                  border-radius: 12px;
                  padding: 16px 24px;
                  cursor: pointer;
                  font-size: 14px;
                  color: #2d3748;
                  font-weight: 600;
                  text-align: left;
                ">
                  <div style="font-weight: 700; margin-bottom: 6px; color: #1a202c;">${dialogTexts.currentPageBtn}</div>
                  <div style="font-size: 12px; color: #718096; font-weight: 500;">${dialogTexts.currentPageDesc}</div>
                </button>
                <button id="clearGlobalPreference" class="dialog-button" style="
                  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                  border: none;
                  border-radius: 12px;
                  padding: 16px 24px;
                  cursor: pointer;
                  font-size: 14px;
                  color: white;
                  font-weight: 600;
                  text-align: left;
                  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
                ">
                  <div style="font-weight: 700; margin-bottom: 6px;">${dialogTexts.clearAllBtn}</div>
                  <div style="font-size: 12px; opacity: 0.9; font-weight: 500;">${dialogTexts.clearAllDesc}</div>
                </button>
              </div>
              <p style="margin: 24px 0 0 0; font-size: 12px; color: #a0aec0; line-height: 1.5; font-weight: 500;">${dialogTexts.tip}</p>
            `;
            
            dialog.appendChild(content);
            document.body.appendChild(dialog);
            
            // æ·»åŠ æŒ‰é’®äº‹ä»¶
            const currentPageBtn = content.querySelector('#currentPageOnly');
            const clearGlobalBtn = content.querySelector('#clearGlobalPreference');
            
            // å¢å¼ºçš„æŒ‰é’®äº¤äº’æ•ˆæœ
            currentPageBtn.addEventListener('mouseenter', () => {
              currentPageBtn.style.background = 'linear-gradient(135deg, #edf2f7 0%, #e2e8f0 100%)';
              currentPageBtn.style.borderColor = '#cbd5e0';
            });
            currentPageBtn.addEventListener('mouseleave', () => {
              currentPageBtn.style.background = 'linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%)';
              currentPageBtn.style.borderColor = '#e2e8f0';
            });
            
            clearGlobalBtn.addEventListener('mouseenter', () => {
              clearGlobalBtn.style.background = 'linear-gradient(135deg, #5a67d8 0%, #667eea 100%)';
            });
            clearGlobalBtn.addEventListener('mouseleave', () => {
              clearGlobalBtn.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            });
            
            // å®‰å…¨çš„å¼¹çª—å…³é—­å‡½æ•°
            const closeDialog = (choice) => {
              try {
                dialog.style.animation = 'dialogBackdropFadeOut 0.2s ease-in forwards';
                content.style.animation = 'dialogContentFadeOut 0.2s ease-in forwards';
                
                // æ·»åŠ é€€å‡ºåŠ¨ç”»
                const exitStyle = document.createElement('style');
                exitStyle.textContent = `
                  @keyframes dialogBackdropFadeOut {
                    from { opacity: 1; }
                    to { opacity: 0; }
                  }
                  @keyframes dialogContentFadeOut {
                    from {
                      opacity: 1;
                      transform: scale(1) translateY(0);
                    }
                    to {
                      opacity: 0;
                      transform: scale(0.9) translateY(-20px);
                    }
                  }
                `;
                document.head.appendChild(exitStyle);
                
                setTimeout(() => {
                  if (document.body.contains(dialog)) {
                    document.body.removeChild(dialog);
                  }
                  if (document.head.contains(style)) {
                    document.head.removeChild(style);
                  }
                  if (document.head.contains(exitStyle)) {
                    document.head.removeChild(exitStyle);
                  }
                  resolve(choice);
                }, 200);
              } catch (error) {
                console.warn('âš ï¸ å…³é—­å¼¹çª—æ—¶å‡ºé”™:', error);
                resolve(choice);
              }
            };
            
            // ç‚¹å‡»äº‹ä»¶ï¼ˆå¢åŠ é˜²æŠ–å¤„ç†ï¼‰
            let isClosing = false;
            
            currentPageBtn.addEventListener('click', () => {
              if (!isClosing) {
                isClosing = true;
                closeDialog('currentPageOnly');
              }
            });
            
            clearGlobalBtn.addEventListener('click', () => {
              if (!isClosing) {
                isClosing = true;
                closeDialog('clearGlobalPreference');
              }
            });
            
            // ç‚¹å‡»èƒŒæ™¯å…³é—­ï¼ˆé»˜è®¤é€‰æ‹©ä»…æ¢å¤å½“å‰é¡µé¢ï¼‰
            dialog.addEventListener('click', (e) => {
              if (e.target === dialog && !isClosing) {
                isClosing = true;
                closeDialog('currentPageOnly');
              }
            });
            
            // ESCé”®å…³é—­
            const handleKeyDown = (e) => {
              if (e.key === 'Escape' && !isClosing) {
                isClosing = true;
                document.removeEventListener('keydown', handleKeyDown);
                closeDialog('currentPageOnly');
              }
            };
            document.addEventListener('keydown', handleKeyDown);
          });
        }
        
        // åˆ›å»ºé¡µé¢å¯¼èˆªé€‰æ‹©å¼¹çª— - å½“åˆ‡æ¢åˆ°ä¸­æ–‡é¡µé¢ä½†å­˜åœ¨å…¨å±€ç¿»è¯‘åå¥½æ—¶ä½¿ç”¨
        function createNavigationChoiceDialog(globalLanguage) {
          return new Promise((resolve) => {
            // åˆ›å»ºå¼¹çª—å®¹å™¨
            const dialog = document.createElement('div');
            dialog.style.cssText = `
              position: fixed;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background: rgba(0, 0, 0, 0.5);
              display: flex;
              justify-content: center;
              align-items: center;
              z-index: 10000;
              font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
              backdrop-filter: blur(2px);
            `;
            
            // åˆ›å»ºå¼¹çª—å†…å®¹
            const content = document.createElement('div');
            content.style.cssText = `
              background: white;
              border-radius: 12px;
              padding: 24px;
              max-width: 420px;
              width: 90%;
              box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
              text-align: center;
              animation: dialogFadeIn 0.3s ease-out;
            `;
            
            // æ·»åŠ åŠ¨ç”»æ ·å¼
            const style = document.createElement('style');
            style.textContent = `
              @keyframes dialogFadeIn {
                from {
                  opacity: 0;
                  transform: scale(0.9) translateY(-20px);
                }
                to {
                  opacity: 1;
                  transform: scale(1) translateY(0);
                }
              }
            `;
            document.head.appendChild(style);
            
            // æ ¹æ®å…¨å±€ç¿»è¯‘è¯­è¨€è·å–å¼¹çª—æ–‡æœ¬
            const getNavigationDialogTexts = (lang) => {
              const texts = {
                'chinese_simplified': {
                  title: 'é¡µé¢ç¿»è¯‘é€‰æ‹©',
                  question: 'æ£€æµ‹åˆ°å½“å‰é¡µé¢ä¸ºä¸­æ–‡ï¼Œæ‚¨å¸Œæœ›å¦‚ä½•å¤„ç†ï¼Ÿ',
                  keepChineseBtn: 'ä¿æŒå½“å‰é¡µé¢ä¸ºä¸­æ–‡',
                  keepChineseDesc: 'æ­¤é¡µé¢å°†ä¿æŒä¸­æ–‡çŠ¶æ€',
                  applyGlobalBtn: 'åº”ç”¨å…¨å±€ç¿»è¯‘è®¾ç½®',
                  applyGlobalDesc: 'ç¿»è¯‘æ­¤é¡µé¢ä¸º{language}',
                  tip: 'ğŸ’¡ æç¤ºï¼šæ‚¨çš„é€‰æ‹©å°†è¢«è®°ä½ï¼Œä¸‹æ¬¡è®¿é—®æ­¤é¡µé¢æ—¶ä¼šè‡ªåŠ¨åº”ç”¨'
                },
                'english': {
                  title: 'Page Translation Choice',
                  question: 'This page is in Chinese. How would you like to proceed?',
                  keepChineseBtn: 'Keep Page in Chinese',
                  keepChineseDesc: 'This page will remain in Chinese',
                  applyGlobalBtn: 'Apply Global Translation',
                  applyGlobalDesc: 'Translate this page to {language}',
                  tip: 'ğŸ’¡ Tip: Your choice will be remembered for future visits to this page'
                },
                'korean': {
                  title: 'í˜ì´ì§€ ë²ˆì—­ ì„ íƒ',
                  question: 'í˜„ì¬ í˜ì´ì§€ê°€ ì¤‘êµ­ì–´ì…ë‹ˆë‹¤. ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
                  keepChineseBtn: 'ì¤‘êµ­ì–´ë¡œ ìœ ì§€',
                  keepChineseDesc: 'ì´ í˜ì´ì§€ëŠ” ì¤‘êµ­ì–´ë¡œ ìœ ì§€ë©ë‹ˆë‹¤',
                  applyGlobalBtn: 'ì „ì—­ ë²ˆì—­ ì ìš©',
                  applyGlobalDesc: 'ì´ í˜ì´ì§€ë¥¼ {language}ë¡œ ë²ˆì—­',
                  tip: 'ğŸ’¡ íŒ: ì„ íƒì‚¬í•­ì´ ê¸°ì–µë˜ì–´ ë‹¤ìŒì— ì´ í˜ì´ì§€ë¥¼ ë°©ë¬¸í•  ë•Œ ìë™ ì ìš©ë©ë‹ˆë‹¤'
                },
                'japanese': {
                  title: 'ãƒšãƒ¼ã‚¸ç¿»è¨³ã®é¸æŠ',
                  question: 'ç¾åœ¨ã®ãƒšãƒ¼ã‚¸ã¯ä¸­å›½èªã§ã™ã€‚ã©ã®ã‚ˆã†ã«å‡¦ç†ã—ã¾ã™ã‹ï¼Ÿ',
                  keepChineseBtn: 'ä¸­å›½èªã®ã¾ã¾ä¿æŒ',
                  keepChineseDesc: 'ã“ã®ãƒšãƒ¼ã‚¸ã¯ä¸­å›½èªã®ã¾ã¾ã«ãªã‚Šã¾ã™',
                  applyGlobalBtn: 'ã‚°ãƒ­ãƒ¼ãƒãƒ«ç¿»è¨³ã‚’é©ç”¨',
                  applyGlobalDesc: 'ã“ã®ãƒšãƒ¼ã‚¸ã‚’{language}ã«ç¿»è¨³',
                  tip: 'ğŸ’¡ ãƒ’ãƒ³ãƒˆ: é¸æŠå†…å®¹ãŒè¨˜æ†¶ã•ã‚Œã€æ¬¡å›ã“ã®ãƒšãƒ¼ã‚¸ã‚’è¨ªå•æ™‚ã«è‡ªå‹•é©ç”¨ã•ã‚Œã¾ã™'
                }
              };
              return texts[lang] || texts['chinese_simplified'];
            };
            
            const dialogTexts = getNavigationDialogTexts(globalLanguage);
            const targetLanguageName = LANGUAGE_MAP[globalLanguage] || globalLanguage;
            
            content.innerHTML = `
              <div style="margin-bottom: 20px;">
                <div style="width: 48px; height: 48px; background: #e8f4f8; border-radius: 50%; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center;">
                  <span style="font-size: 24px;">ğŸŒ</span>
                </div>
                <h3 style="margin: 0 0 8px 0; color: #333; font-size: 18px; font-weight: 600;">${dialogTexts.title}</h3>
                <p style="margin: 0 0 16px 0; color: #666; font-size: 13px; background: #f0f8ff; padding: 8px 12px; border-radius: 6px; border-left: 3px solid #3498db;">
                  å½“å‰å…¨å±€ç¿»è¯‘è®¾ç½®ï¼š${targetLanguageName}
                </p>
                <p style="margin: 0 0 24px 0; color: #666; line-height: 1.5; font-size: 14px;">${dialogTexts.question}</p>
              </div>
              <div style="display: flex; flex-direction: column; gap: 12px;">
                <button id="keepChinese" style="
                  background: #f8f9fa;
                  border: 1px solid #dee2e6;
                  border-radius: 8px;
                  padding: 14px 20px;
                  cursor: pointer;
                  font-size: 14px;
                  color: #495057;
                  transition: all 0.2s;
                  font-weight: 500;
                ">
                  <div style="font-weight: 600; margin-bottom: 4px;">${dialogTexts.keepChineseBtn}</div>
                  <div style="font-size: 12px; color: #6c757d;">${dialogTexts.keepChineseDesc}</div>
                </button>
                <button id="applyGlobal" style="
                  background: #3498db;
                  border: none;
                  border-radius: 8px;
                  padding: 14px 20px;
                  cursor: pointer;
                  font-size: 14px;
                  color: white;
                  transition: all 0.2s;
                  font-weight: 500;
                ">
                  <div style="font-weight: 600; margin-bottom: 4px;">${dialogTexts.applyGlobalBtn}</div>
                  <div style="font-size: 12px; opacity: 0.9;">${dialogTexts.applyGlobalDesc.replace('{language}', targetLanguageName)}</div>
                </button>
              </div>
              <p style="margin: 20px 0 0 0; font-size: 12px; color: #999; line-height: 1.4;">${dialogTexts.tip}</p>
            `;
            
            dialog.appendChild(content);
            document.body.appendChild(dialog);
            
            // æ·»åŠ æŒ‰é’®äº‹ä»¶
            const keepChineseBtn = content.querySelector('#keepChinese');
            const applyGlobalBtn = content.querySelector('#applyGlobal');
            
            // å¢å¼ºçš„æŒ‰é’®æ‚¬åœæ•ˆæœ
            keepChineseBtn.addEventListener('mouseenter', () => {
              keepChineseBtn.style.background = '#e9ecef';
              keepChineseBtn.style.borderColor = '#adb5bd';
              keepChineseBtn.style.transform = 'translateY(-1px)';
            });
            keepChineseBtn.addEventListener('mouseleave', () => {
              keepChineseBtn.style.background = '#f8f9fa';
              keepChineseBtn.style.borderColor = '#dee2e6';
              keepChineseBtn.style.transform = 'translateY(0)';
            });
            
            applyGlobalBtn.addEventListener('mouseenter', () => {
              applyGlobalBtn.style.background = '#2980b9';
              applyGlobalBtn.style.transform = 'translateY(-1px)';
            });
            applyGlobalBtn.addEventListener('mouseleave', () => {
              applyGlobalBtn.style.background = '#3498db';
              applyGlobalBtn.style.transform = 'translateY(0)';
            });
            
            // å®‰å…¨çš„å¼¹çª—å…³é—­å‡½æ•°
            const closeDialog = (choice) => {
              try {
                if (document.body.contains(dialog)) {
                  document.body.removeChild(dialog);
                }
                if (document.head.contains(style)) {
                  document.head.removeChild(style);
                }
                resolve(choice);
              } catch (error) {
                console.warn('âš ï¸ å…³é—­å¯¼èˆªé€‰æ‹©å¼¹çª—æ—¶å‡ºé”™:', error);
                resolve(choice);
              }
            };
            
            // ç‚¹å‡»äº‹ä»¶ï¼ˆå¢åŠ é˜²æŠ–å¤„ç†ï¼‰
            let isClosing = false;
            
            keepChineseBtn.addEventListener('click', () => {
              if (!isClosing) {
                isClosing = true;
                closeDialog('keepChinese');
              }
            });
            
            applyGlobalBtn.addEventListener('click', () => {
              if (!isClosing) {
                isClosing = true;
                closeDialog('applyGlobal');
              }
            });
            
            // ç‚¹å‡»èƒŒæ™¯å…³é—­ï¼ˆé»˜è®¤ä¿æŒä¸­æ–‡ï¼‰
            dialog.addEventListener('click', (e) => {
              if (e.target === dialog && !isClosing) {
                isClosing = true;
                closeDialog('keepChinese');
              }
            });
            
            // ESCé”®å…³é—­
            const handleKeyDown = (e) => {
              if (e.key === 'Escape' && !isClosing) {
                isClosing = true;
                document.removeEventListener('keydown', handleKeyDown);
                closeDialog('keepChinese');
              }
            };
            document.addEventListener('keydown', handleKeyDown);
          });
        }
        
        // å¤„ç†å¯¼èˆªé€‰æ‹©çš„ç»“æœ
        async function handleNavigationChoice(choice, globalLanguage, pageKey) {
          try {
            if (choice === 'keepChinese') {
              // ç”¨æˆ·é€‰æ‹©ä¿æŒä¸­æ–‡
              console.log('ğŸ“ ç”¨æˆ·é€‰æ‹©ä¿æŒå½“å‰é¡µé¢ä¸ºä¸­æ–‡');
              
              // è®¾ç½®é¡µé¢æ˜ç¡®çš„ä¸­æ–‡çŠ¶æ€
              pageTranslationStates.set(pageKey, {
                language: 'chinese_simplified',
                timestamp: Date.now(),
                url: window.location.href,
                explicit: true // æ ‡è®°ä¸ºç”¨æˆ·æ˜ç¡®é€‰æ‹©
              });
              
              currentLanguage = 'chinese_simplified';
              savePersistentCache();
              
              // ä½¿ç”¨å½“å‰è¯­è¨€æ˜¾ç¤ºçŠ¶æ€ä¿¡æ¯
              const statusMessages = {
                'english': 'Page kept in Chinese',
                'korean': 'í˜ì´ì§€ë¥¼ ì¤‘êµ­ì–´ë¡œ ìœ ì§€',
                'japanese': 'ãƒšãƒ¼ã‚¸ã¯ä¸­å›½èªã®ã¾ã¾',
                'chinese_simplified': 'é¡µé¢ä¿æŒä¸­æ–‡'
              };
              const message = statusMessages[globalLanguage] || statusMessages['chinese_simplified'];
              showTranslateStatus(message, 2000);
              
            } else if (choice === 'applyGlobal') {
              // ç”¨æˆ·é€‰æ‹©åº”ç”¨å…¨å±€ç¿»è¯‘
              console.log(`ğŸŒ ç”¨æˆ·é€‰æ‹©åº”ç”¨å…¨å±€ç¿»è¯‘: ${LANGUAGE_MAP[globalLanguage]}`);
              
              // æ‰§è¡Œç¿»è¯‘
              await translatePage(globalLanguage, true);
              
              // éªŒè¯ç¿»è¯‘æ˜¯å¦æˆåŠŸ
              if (currentLanguage === globalLanguage) {
                // ä¿å­˜ç¿»è¯‘çŠ¶æ€
                saveCurrentPageState();
                
                // ä½¿ç”¨ç›®æ ‡è¯­è¨€æ˜¾ç¤ºçŠ¶æ€ä¿¡æ¯
                const statusMessages = {
                  'english': `Translated to English`,
                  'korean': `í•œêµ­ì–´ë¡œ ë²ˆì—­ë¨`,
                  'japanese': `æ—¥æœ¬èªã«ç¿»è¨³ã•ã‚Œã¾ã—ãŸ`,
                  'chinese_simplified': `å·²ç¿»è¯‘ä¸º${LANGUAGE_MAP[globalLanguage]}`
                };
                const message = statusMessages[globalLanguage] || `å·²ç¿»è¯‘ä¸º${LANGUAGE_MAP[globalLanguage]}`;
                showTranslateStatus(message, 2000);
                
                console.log('âœ… é¡µé¢å¯¼èˆªç¿»è¯‘å®Œæˆ');
              } else {
                throw new Error('ç¿»è¯‘éªŒè¯å¤±è´¥');
              }
            }
          } catch (error) {
            console.error('ğŸ’¥ å¤„ç†å¯¼èˆªé€‰æ‹©å¤±è´¥:', error);
            // å‡ºé”™æ—¶ä¿æŒä¸­æ–‡çŠ¶æ€
            currentLanguage = 'chinese_simplified';
            showTranslateStatus('å¤„ç†å¤±è´¥ï¼Œä¿æŒä¸­æ–‡çŠ¶æ€', 2000);
          }
        }
        
        // å¢å¼ºç‰ˆç¿»è¯‘å‡½æ•° - ä¿®å¤æ¢å¤é€»è¾‘å’Œè¯­è¨€ä¸€è‡´æ€§ï¼Œæ”¯æŒä¸­æ–­
        window.translateTo = async (language) => {
          if (!LANGUAGE_MAP[language]) {
            console.warn(`âŒ ä¸æ”¯æŒçš„è¯­è¨€: ${language}`);
            showTranslateStatus('ä¸æ”¯æŒçš„è¯­è¨€', 2000);
            return false;
          }
          
          // ä¼˜åŒ–çš„ä¸­æ–­å¤„ç†é€»è¾‘
          if (isTranslating) {
            if (language === 'chinese_simplified') {
              // ç”¨æˆ·åˆ‡æ¢åˆ°ä¸­æ–‡ï¼Œç«‹å³ä¸­æ–­å¹¶æ¢å¤
              console.log('ğŸ›‘ ç”¨æˆ·åˆ‡æ¢åˆ°ä¸­æ–‡ï¼Œä¸­æ–­å½“å‰ç¿»è¯‘å¹¶ç«‹å³æ¢å¤');
              await cancelCurrentTranslation('ç”¨æˆ·åˆ‡æ¢åˆ°ä¸­æ–‡');
              
              // ç¡®ä¿è¯­è¨€çŠ¶æ€æ­£ç¡®è®¾ç½®
              currentLanguage = 'chinese_simplified';
              
              // ä¿å­˜å½“å‰é¡µé¢çŠ¶æ€
              const pageKey = getCurrentPageKey();
              pageTranslationStates.set(pageKey, {
                language: 'chinese_simplified',
                timestamp: Date.now(),
                url: window.location.href,
                explicit: true // æ ‡è®°ä¸ºç”¨æˆ·æ˜ç¡®é€‰æ‹©çš„çŠ¶æ€
              });
              
              try {
                savePersistentCache();
              } catch (error) {
                console.warn('âš ï¸ ä¿å­˜çŠ¶æ€å¤±è´¥:', error);
              }
              
              showTranslateStatus('å·²æ¢å¤ä¸­æ–‡', 2000);
              console.log('âœ… ç¿»è¯‘ä¸­æ–­å¹¶æ¢å¤ä¸­æ–‡å®Œæˆ');
              return true;
              
            } else if (language !== currentLanguage) {
              // ç”¨æˆ·åˆ‡æ¢åˆ°å…¶ä»–è¯­è¨€ï¼Œä¸­æ–­å½“å‰ç¿»è¯‘å¹¶åˆ‡æ¢
              console.log('ğŸ”„ ç”¨æˆ·åˆ‡æ¢ç¿»è¯‘è¯­è¨€ï¼Œä¸­æ–­å½“å‰ç¿»è¯‘');
              await cancelCurrentTranslation('åˆ‡æ¢ç¿»è¯‘è¯­è¨€');
            } else {
              console.log('ğŸ¯ ç›®æ ‡è¯­è¨€ä¸å½“å‰è¯­è¨€ç›¸åŒï¼Œè·³è¿‡å¤„ç†');
              showTranslateStatus(`å½“å‰å·²æ˜¯${LANGUAGE_MAP[language]}`, 2000);
              return true;
            }
          }
          
          try {
            console.log(`ğŸ¯ å¼€å§‹ç¿»è¯‘: ${LANGUAGE_MAP[currentLanguage]} -> ${LANGUAGE_MAP[language]}`);
            
            // å¦‚æœç›®æ ‡è¯­è¨€ä¸å½“å‰è¯­è¨€ç›¸åŒï¼Œè·³è¿‡å¤„ç†
            if (language === currentLanguage) {
              console.log('ğŸ¯ ç›®æ ‡è¯­è¨€ä¸å½“å‰è¯­è¨€ç›¸åŒï¼Œè·³è¿‡å¤„ç†');
              showTranslateStatus(`å½“å‰å·²æ˜¯${LANGUAGE_MAP[language]}`, 2000);
              return true;
            }
            
            if (language === 'chinese_simplified') {
              // æ¢å¤ä¸­æ–‡ - ä¿®å¤å¼¹çª—é€»è¾‘
              console.log('ğŸ”„ æ¢å¤ä¸­æ–‡çŠ¶æ€ï¼Œæ£€æŸ¥æ˜¯å¦éœ€è¦ç”¨æˆ·é€‰æ‹©');
              
              // å…³é”®ä¿®å¤ï¼šæ£€æŸ¥å½“å‰è¯­è¨€æ˜¯å¦ä¸ºä¸­æ–‡ï¼Œå¦‚æœå·²ç»æ˜¯ä¸­æ–‡åˆ™æ— éœ€å¼¹çª—
              if (currentLanguage === 'chinese_simplified') {
                console.log('ğŸ¯ å½“å‰å·²æ˜¯ä¸­æ–‡ï¼Œæ— éœ€å¤„ç†');
                showTranslateStatus('å½“å‰å·²æ˜¯ä¸­æ–‡', 2000);
                return true;
              }
              
              const hasGlobalPreference = globalTranslationPreference && 
                                        globalTranslationPreference !== 'chinese_simplified' &&
                                        LANGUAGE_MAP[globalTranslationPreference];
              
              const otherPagesCount = Array.from(pageTranslationStates.values()).filter(state => 
                state.language && 
                state.language !== 'chinese_simplified' &&
                LANGUAGE_MAP[state.language] &&
                state.timestamp &&
                (Date.now() - state.timestamp < CACHE_MAX_AGE)
              ).length;
              
              let userChoice = 'currentPageOnly';
              
              // ä¿®å¤å¼¹çª—æ˜¾ç¤ºé€»è¾‘ï¼šåªæœ‰åœ¨æœ‰å…¶ä»–ç¿»è¯‘çŠ¶æ€æ—¶æ‰æ˜¾ç¤ºå¼¹çª—
              if (hasGlobalPreference || otherPagesCount > 0) {
                console.log('ğŸ”„ æ˜¾ç¤ºç”¨æˆ·é€‰æ‹©å¼¹çª—');
                try {
                  userChoice = await createTranslationChoiceDialog();
                  console.log(`ğŸ‘¤ ç”¨æˆ·é€‰æ‹©: ${userChoice}`);
                } catch (error) {
                  console.warn('âš ï¸ ç”¨æˆ·é€‰æ‹©å¼¹çª—å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤é€‰æ‹©:', error);
                  userChoice = 'currentPageOnly';
                }
              }
              
              // æ¢å¤å½“å‰é¡µé¢ä¸ºä¸­æ–‡
              await translatePage(language, false);
              
              if (userChoice === 'clearGlobalPreference') {
                // æ¸…é™¤æ‰€æœ‰ç¿»è¯‘è®¾ç½®
                console.log('ğŸ§¹ æ¸…é™¤æ‰€æœ‰ç¿»è¯‘è®¾ç½®');
                globalTranslationPreference = null;
                pageTranslationStates.clear();
                
                showTranslateStatus('å·²æ¸…é™¤æ‰€æœ‰ç¿»è¯‘è®¾ç½®', 2500);
              } else {
                // ä»…æ¢å¤å½“å‰é¡µé¢ï¼Œä¿ç•™å…¶ä»–è®¾ç½®
                console.log('ğŸ“ ä»…æ¢å¤å½“å‰é¡µé¢ï¼Œä¿ç•™å…¶ä»–ç¿»è¯‘è®¾ç½®');
                
                // æ˜ç¡®ä¿å­˜å½“å‰é¡µé¢çš„ä¸­æ–‡çŠ¶æ€ï¼Œç¡®ä¿ä¸å—å…¨å±€åå¥½å½±å“
                const pageKey = getCurrentPageKey();
                pageTranslationStates.set(pageKey, {
                  language: 'chinese_simplified',
                  timestamp: Date.now(),
                  url: window.location.href,
                  explicit: true // æ ‡è®°ä¸ºç”¨æˆ·æ˜ç¡®é€‰æ‹©çš„çŠ¶æ€
                });
                
                console.log(`ğŸ“„ å·²æ˜ç¡®è®¾ç½®é¡µé¢ ${pageKey} ä¸ºä¸­æ–‡çŠ¶æ€ï¼Œä¸å—å…¨å±€åå¥½å½±å“`);
                showTranslateStatus('å·²æ¢å¤å½“å‰é¡µé¢ï¼Œå…¶ä»–é¡µé¢ä¿æŒç¿»è¯‘çŠ¶æ€', 2500);
              }
              
              currentLanguage = 'chinese_simplified';
              
            } else {
              // ç¿»è¯‘åˆ°å…¶ä»–è¯­è¨€
              console.log(`ğŸŒ ç¿»è¯‘åˆ°: ${LANGUAGE_MAP[language]}`);
              
              await translatePage(language, false);
              
              // éªŒè¯ç¿»è¯‘æ˜¯å¦æˆåŠŸ
              if (currentLanguage === language && originalTexts.size > 0) {
                // è®¾ç½®å…¨å±€ç¿»è¯‘åå¥½
                globalTranslationPreference = language;
                console.log(`ğŸŒ å…¨å±€ç¿»è¯‘åå¥½å·²è®¾ç½®ä¸º: ${LANGUAGE_MAP[language]}`);
                
                // ä¿å­˜å½“å‰é¡µé¢çŠ¶æ€
                saveCurrentPageState();
                
                // ä½¿ç”¨ç›®æ ‡è¯­è¨€æ˜¾ç¤ºé€šçŸ¥
                const successMessages = {
                  'english': `å·²ç¿»è¯‘ä¸ºEnglish`,
                  'korean': `ì´ë¯¸ í•œêµ­ì–´ë¡œ ë²ˆì—­ë¨`,
                  'japanese': `æ—¥æœ¬èªã«ç¿»è¨³ã•ã‚Œã¾ã—ãŸ`
                };
                const message = successMessages[language] || `å·²ç¿»è¯‘ä¸º${LANGUAGE_MAP[language]}`;
                showTranslateStatus(message, 2000, language);
              } else {
                throw new Error('ç¿»è¯‘éªŒè¯å¤±è´¥ - çŠ¶æ€ä¸åŒ¹é…');
              }
            }
            
            // ä¿å­˜æŒä¹…åŒ–ç¼“å­˜
            try {
              savePersistentCache();
            } catch (error) {
              console.warn('âš ï¸ ä¿å­˜çŠ¶æ€å¤±è´¥:', error);
            }
            
            console.log(`âœ… ç¿»è¯‘å®Œæˆ: ${LANGUAGE_MAP[currentLanguage]}`);
            return true;
            
          } catch (error) {
            console.error('ğŸ’¥ ç¿»è¯‘å¤±è´¥:', error);
            showTranslateStatus('ç¿»è¯‘å¤±è´¥ï¼Œè¯·é‡è¯•', 3000);
            
            // é”™è¯¯æ¢å¤ - é‡ç½®ä¸ºå®‰å…¨çŠ¶æ€
            try {
              if (originalTexts.size > 0) {
                originalTexts.forEach((originalText, node) => {
                  if (node.parentNode) {
                    node.textContent = originalText;
                  }
                });
              }
              
              // æ¸…ç†ç¿»è¯‘æ ‡è®°
              const translatedElements = document.querySelectorAll('[data-translated]');
              translatedElements.forEach(element => {
                const originalText = element.getAttribute('data-original-text');
                if (originalText) {
                  element.textContent = originalText;
                }
                element.removeAttribute('data-translated');
                element.removeAttribute('data-original-text');
              });
              
              currentLanguage = 'chinese_simplified';
              console.log('ğŸ”„ å·²æ¢å¤ä¸ºä¸­æ–‡çŠ¶æ€');
            } catch (recoveryError) {
              console.error('ğŸ’¥ é”™è¯¯æ¢å¤å¤±è´¥:', recoveryError);
            }
            
            return false;
          } finally {
            // ç¡®ä¿æ€»æ˜¯é‡ç½®ä¸­æ–­æ§åˆ¶çŠ¶æ€
            shouldCancelTranslation = false;
            if (translationAbortController) {
              translationAbortController = null;
            }
          }
        };
        
        // é¡µé¢å¯¼èˆªå¤„ç†
        async function handlePageNavigation() {
          if (isTranslating) {
            console.log('â¸ï¸ ç¿»è¯‘è¿›è¡Œä¸­ï¼Œè·³è¿‡é¡µé¢å¯¼èˆªå¤„ç†');
            return;
          }
          
          // é‡ç½®å¯¼èˆªå¼¹çª—æ ‡å¿—ï¼Œå…è®¸æ–°é¡µé¢æ˜¾ç¤ºé€‰æ‹©å¼¹çª—
          navigationDialogShown = false;
          
          console.log('ğŸš€ å¼€å§‹å¤„ç†é¡µé¢å¯¼èˆª...');
          
          try {
            if (originalTexts.size > 0) {
              saveCurrentPageState();
            }
            
            originalTexts.clear();
            
            const pageKey = getCurrentPageKey();
            const savedState = pageTranslationStates.get(pageKey);
            
            let targetLanguage = 'chinese_simplified';
            let shouldTranslate = false;
            
            const isValidGlobalPreference = globalTranslationPreference && 
                                          globalTranslationPreference !== 'chinese_simplified' && 
                                          LANGUAGE_MAP[globalTranslationPreference];
            
            const isValidPageState = savedState && 
                                    savedState.language && 
                                    LANGUAGE_MAP[savedState.language] &&
                                    savedState.timestamp && 
                                    (Date.now() - savedState.timestamp < CACHE_MAX_AGE);
            
            // ä¿®å¤ï¼šæ­£ç¡®å¤„ç†é¡µé¢ç‹¬ç«‹çŠ¶æ€ï¼Œé¿å…"ä»…æ¢å¤å½“å‰é¡µé¢"å½±å“å…¶ä»–é¡µé¢
            if (isValidPageState) {
              if (savedState.language === 'chinese_simplified') {
                // è¯¥é¡µé¢è¢«æ˜ç¡®è®¾ç½®ä¸ºä¸­æ–‡çŠ¶æ€ï¼Œä¸åº”ç”¨å…¨å±€ç¿»è¯‘åå¥½
                targetLanguage = 'chinese_simplified';
                currentLanguage = 'chinese_simplified';
                shouldTranslate = false;
                
                const translatedElements = document.querySelectorAll('[data-translated]');
                if (translatedElements.length > 0) {
                  translatedElements.forEach(element => {
                    const originalText = element.getAttribute('data-original-text');
                    if (originalText) {
                      element.textContent = originalText;
                      element.removeAttribute('data-translated');
                      element.removeAttribute('data-original-text');
                    }
                  });
                }
                
                const isExplicit = savedState.explicit ? 'ï¼ˆç”¨æˆ·æ˜ç¡®è®¾ç½®ï¼‰' : '';
                console.log(`ğŸ“ é¡µé¢å¯¼èˆªå¤„ç†å®Œæˆï¼Œä¿æŒä¸­æ–‡çŠ¶æ€${isExplicit}`);
                return;
              } else {
                // è¯¥é¡µé¢æœ‰æœ‰æ•ˆçš„ç¿»è¯‘çŠ¶æ€
                targetLanguage = savedState.language;
                shouldTranslate = true;
                console.log(`ğŸ“„ ä½¿ç”¨é¡µé¢ä¿å­˜çš„ç¿»è¯‘çŠ¶æ€: ${LANGUAGE_MAP[targetLanguage]}`);
              }
            } else {
              // é¡µé¢æ²¡æœ‰ä¿å­˜çŠ¶æ€ï¼Œæ£€æŸ¥æ˜¯å¦åº”ç”¨å…¨å±€åå¥½
              if (isValidGlobalPreference) {
                // æ£€æµ‹æ˜¯å¦éœ€è¦å¼¹å‡ºç”¨æˆ·é€‰æ‹©æ¡†
                // æ¡ä»¶ï¼šå­˜åœ¨å…¨å±€ç¿»è¯‘åå¥½ï¼Œä¸”å½“å‰é¡µé¢ä¸ºä¸­æ–‡çŠ¶æ€ï¼ˆæ— ç¿»è¯‘å†…å®¹ï¼‰
                const hasTranslatedContent = document.querySelectorAll('[data-translated]').length > 0;
                
                if (!hasTranslatedContent && !navigationDialogShown) {
                  // é¡µé¢ä¸ºä¸­æ–‡çŠ¶æ€ï¼Œä½†æœ‰å…¨å±€ç¿»è¯‘åå¥½ï¼Œå¼¹å‡ºé€‰æ‹©æ¡†
                  console.log(`ğŸ¤” é¡µé¢ä¸ºä¸­æ–‡ä½†å­˜åœ¨å…¨å±€ç¿»è¯‘åå¥½${LANGUAGE_MAP[globalTranslationPreference]}ï¼Œå¼¹å‡ºç”¨æˆ·é€‰æ‹©æ¡†`);
                  
                  navigationDialogShown = true; // è®¾ç½®æ ‡å¿—é˜²æ­¢é‡å¤æ˜¾ç¤º
                  
                  setTimeout(async () => {
                    try {
                      const userChoice = await createNavigationChoiceDialog(globalTranslationPreference);
                      await handleNavigationChoice(userChoice, globalTranslationPreference, pageKey);
                    } catch (error) {
                      console.warn('âš ï¸ å¤„ç†å¯¼èˆªé€‰æ‹©å¤±è´¥:', error);
                      // é»˜è®¤ä¿æŒä¸­æ–‡çŠ¶æ€
                      currentLanguage = 'chinese_simplified';
                    } finally {
                      // é‡ç½®æ ‡å¿—ï¼Œå…è®¸ä¸‹æ¬¡é¡µé¢å¯¼èˆªæ—¶å†æ¬¡æ˜¾ç¤º
                      setTimeout(() => {
                        navigationDialogShown = false;
                      }, 2000);
                    }
                  }, 300); // å»¶è¿Ÿä»¥ç¡®ä¿é¡µé¢å†…å®¹åŠ è½½å®Œæˆ
                  
                  return; // ç­‰å¾…ç”¨æˆ·é€‰æ‹©ï¼Œä¸æ‰§è¡Œåç»­é€»è¾‘
                } else {
                  // é¡µé¢å·²æœ‰ç¿»è¯‘å†…å®¹ï¼Œç›´æ¥åº”ç”¨å…¨å±€åå¥½
                  targetLanguage = globalTranslationPreference;
                  shouldTranslate = true;
                  console.log(`ğŸŒ åº”ç”¨å…¨å±€ç¿»è¯‘åå¥½: ${LANGUAGE_MAP[targetLanguage]} (é¡µé¢æ— æ˜ç¡®çŠ¶æ€)`);
                }
              } else {
                // æ²¡æœ‰å…¨å±€åå¥½ï¼Œä¿æŒä¸­æ–‡
                targetLanguage = 'chinese_simplified';
                shouldTranslate = false;
                console.log('ğŸ“ é¡µé¢æ— çŠ¶æ€ä¸”æ— å…¨å±€åå¥½ï¼Œä¿æŒä¸­æ–‡');
              }
            }
            
            currentLanguage = targetLanguage;
            
            if (shouldTranslate) {
              console.log(`ğŸ”„ å¼€å§‹è‡ªåŠ¨ç¿»è¯‘åˆ°: ${LANGUAGE_MAP[targetLanguage]}`);
              
              setTimeout(async () => {
                try {
                  await translatePage(targetLanguage, true);
                  console.log('âœ… ç¿»è¯‘çŠ¶æ€è‡ªåŠ¨æ¢å¤æˆåŠŸ');
                } catch (error) {
                  console.warn('âš ï¸ è‡ªåŠ¨æ¢å¤ç¿»è¯‘å¤±è´¥:', error);
                  currentLanguage = 'chinese_simplified';
                }
              }, 500);
            }
            
            try {
              savePersistentCache();
            } catch (error) {
              console.warn('âš ï¸ ä¿å­˜çŠ¶æ€å¤±è´¥:', error);
            }
            
            console.log('ğŸ‰ é¡µé¢å¯¼èˆªå¤„ç†å®Œæˆï¼Œå½“å‰è¯­è¨€:', LANGUAGE_MAP[currentLanguage]);
            
          } catch (error) {
            console.error('ğŸ’¥ é¡µé¢å¯¼èˆªå¤„ç†å¤±è´¥:', error);
            currentLanguage = 'chinese_simplified';
            globalTranslationPreference = null;
            originalTexts.clear();
            
            try {
              savePersistentCache();
            } catch (saveError) {
              console.warn('âš ï¸ ä¿å­˜é‡ç½®çŠ¶æ€å¤±è´¥:', saveError);
            }
          }
        }
        
        // é¡µé¢å¯¼èˆªç›‘å¬å™¨
        function setupNavigationObserver() {
          let navigationTimeout = null;
          let isNavigating = false;
          
          const handlePageChange = async () => {
            if (isNavigating) return;
            isNavigating = true;
            
            try {
              const currentUrl = window.location.href;
              if (currentUrl !== lastUrl) {
                console.log('ğŸ”„ é¡µé¢å¯¼èˆªæ£€æµ‹:', lastUrl, '->', currentUrl);
                lastUrl = currentUrl;
                
                await new Promise(resolve => {
                  if (document.readyState === 'complete') {
                    resolve();
                  } else {
                    const onReady = () => {
                      if (document.readyState === 'complete') {
                        document.removeEventListener('readystatechange', onReady);
                        resolve();
                      }
                    };
                    document.addEventListener('readystatechange', onReady);
                  }
                });
                
                await new Promise(resolve => setTimeout(resolve, 200));
                await handlePageNavigation();
              }
            } catch (error) {
              console.error('é¡µé¢å˜åŒ–å¤„ç†å¤±è´¥:', error);
            } finally {
              isNavigating = false;
            }
          };
          
          const debouncedPageChange = () => {
            if (navigationTimeout) {
              clearTimeout(navigationTimeout);
            }
            navigationTimeout = setTimeout(handlePageChange, 100);
          };
          
          window.addEventListener('popstate', debouncedPageChange);
          
          const originalPushState = history.pushState;
          const originalReplaceState = history.replaceState;
          
          history.pushState = function(...args) {
            originalPushState.apply(this, args);
            setTimeout(debouncedPageChange, 50);
          };
          
          history.replaceState = function(...args) {
            originalReplaceState.apply(this, args);
            setTimeout(debouncedPageChange, 50);
          };
          
          if (window.document$ && typeof window.document$.subscribe === 'function') {
            window.document$.subscribe(() => {
              console.log('ğŸ“„ Material for MkDocs é¡µé¢å˜åŒ–äº‹ä»¶');
              setTimeout(debouncedPageChange, 150);
            });
          }
          
          window.addEventListener('beforeunload', () => {
            if (navigationTimeout) clearTimeout(navigationTimeout);
          });
        }
        
        // å·¥å…·æ–¹æ³•
        window.getCurrentLanguage = () => {
          if (!currentLanguage || !LANGUAGE_MAP[currentLanguage]) {
            currentLanguage = 'chinese_simplified';
          }
          return currentLanguage;
        };
        
        window.getCurrentLanguageName = () => LANGUAGE_MAP[window.getCurrentLanguage()] || 'ä¸­æ–‡';
        
        window.clearTranslateCache = () => {
          try {
            translationCache.clear();
            pageTranslationStates.clear();
            originalTexts.clear();
            globalTranslationPreference = null;
            currentLanguage = 'chinese_simplified';
            
            [STORAGE_PREFIX + 'cache', STORAGE_PREFIX + 'preference', STORAGE_PREFIX + 'states'].forEach(key => {
              try { localStorage.removeItem(key); } catch (e) {}
            });
            
            console.log('âœ… æ‰€æœ‰ç¿»è¯‘ç¼“å­˜å’ŒçŠ¶æ€å·²æ¸…é™¤');
            showTranslateStatus('ç¼“å­˜å·²æ¸…é™¤ï¼Œé‡ç½®ä¸ºä¸­æ–‡', 2000);
            
          } catch (error) {
            console.error('ğŸ’¥ æ¸…é™¤ç¼“å­˜æ—¶å‘ç”Ÿé”™è¯¯:', error);
            showTranslateStatus('æ¸…é™¤ç¼“å­˜å¤±è´¥', 2000);
          }
        };
        
        // åˆå§‹åŒ–å‡½æ•°
        function initGLMTranslate() {
          try {
            console.log('ğŸš€ å¼€å§‹åˆå§‹åŒ–GLMç¿»è¯‘åŠŸèƒ½...');
            
            initPersistentCache();
            console.log('ğŸ’¾ ç¼“å­˜åˆå§‹åŒ–å®Œæˆ');
            
            // åˆå§‹åŒ–æ€§èƒ½ä¼˜åŒ–ç»„ä»¶
            try {
              TranslationWorkerManager.init();
              console.log('ğŸ‘¨â€ğŸ’» Web Workers åˆå§‹åŒ–å®Œæˆ');
            } catch (workerError) {
              console.warn('âš ï¸ Web Workers åˆå§‹åŒ–å¤±è´¥ï¼Œå°†ä½¿ç”¨ä¸»çº¿ç¨‹ç¿»è¯‘:', workerError);
            }
            
            try {
              VirtualScrollOptimizer.init();
              console.log('ğŸ“± è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–å™¨åˆå§‹åŒ–å®Œæˆ');
            } catch (scrollError) {
              console.warn('âš ï¸ è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–å™¨åˆå§‹åŒ–å¤±è´¥:', scrollError);
            }
            
            // åˆå§‹åŒ–å¿«æ·é”®æ”¯æŒ
            try {
              ShortcutManager.init();
              console.log('âŒ¨ï¸ å¿«æ·é”®ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ');
            } catch (shortcutError) {
              console.warn('âš ï¸ å¿«æ·é”®ç®¡ç†å™¨åˆå§‹åŒ–å¤±è´¥:', shortcutError);
            }
            
            setupNavigationObserver();
            console.log('ğŸ‘ï¸ å¯¼èˆªç›‘å¬å™¨è®¾ç½®å®Œæˆ');
            
            const pageKey = getCurrentPageKey();
            const savedState = pageTranslationStates.get(pageKey);
            
            const isValidPageState = savedState && 
                                    savedState.language && 
                                    LANGUAGE_MAP[savedState.language] &&
                                    savedState.timestamp && 
                                    (Date.now() - savedState.timestamp < CACHE_MAX_AGE);
            
            const isValidGlobalPreference = globalTranslationPreference && 
                                          globalTranslationPreference !== 'chinese_simplified' && 
                                          LANGUAGE_MAP[globalTranslationPreference];
            
            let shouldAutoTranslate = false;
            let targetLanguage = 'chinese_simplified';
            
            if (isValidPageState) {
              if (savedState.language === 'chinese_simplified') {
                const isExplicit = savedState.explicit ? 'ï¼ˆç”¨æˆ·æ˜ç¡®è®¾ç½®ï¼‰' : '';
                console.log(`ğŸ“ æ£€æµ‹åˆ°é¡µé¢æ˜ç¡®è®¾ç½®ä¸ºä¸­æ–‡çŠ¶æ€${isExplicit}`);
                targetLanguage = 'chinese_simplified';
                currentLanguage = 'chinese_simplified';
                shouldAutoTranslate = false;
                
                originalTexts.clear();
                
                const translatedElements = document.querySelectorAll('[data-translated]');
                if (translatedElements.length > 0) {
                  console.log('ğŸ”„ åˆå§‹åŒ–æ—¶æ£€æµ‹åˆ°ç¿»è¯‘å†…å®¹ï¼Œæ¢å¤ä¸ºä¸­æ–‡');
                  translatedElements.forEach(element => {
                    const originalText = element.getAttribute('data-original-text');
                    if (originalText) {
                      element.textContent = originalText;
                      element.removeAttribute('data-translated');
                      element.removeAttribute('data-original-text');
                    }
                  });
                }
                
                window.glmTranslateInitialized = true;
                console.log(`âœ… GLMç¿»è¯‘åŠŸèƒ½åˆå§‹åŒ–å®Œæˆï¼ˆä¸­æ–‡çŠ¶æ€${isExplicit}ï¼‰`);
                return;
              } else {
                console.log(`ğŸ”„ æ£€æµ‹åˆ°æœ‰æ•ˆé¡µé¢ç¿»è¯‘çŠ¶æ€: ${LANGUAGE_MAP[savedState.language]}`);
                targetLanguage = savedState.language;
                currentLanguage = savedState.language;
                shouldAutoTranslate = true;
              }
            } else if (isValidGlobalPreference) {
              console.log(`ğŸŒ æ£€æµ‹åˆ°æœ‰æ•ˆå…¨å±€ç¿»è¯‘åå¥½: ${LANGUAGE_MAP[globalTranslationPreference]}`);
              targetLanguage = globalTranslationPreference;
              currentLanguage = globalTranslationPreference;
              shouldAutoTranslate = true;
            } else {
              console.log('ğŸ“ æ— æœ‰æ•ˆç¿»è¯‘çŠ¶æ€æˆ–å…¨å±€åå¥½ï¼Œä¿æŒä¸­æ–‡çŠ¶æ€');
              currentLanguage = 'chinese_simplified';
              
              if (globalTranslationPreference && !LANGUAGE_MAP[globalTranslationPreference]) {
                globalTranslationPreference = null;
                savePersistentCache();
              }
            }
            
            if (shouldAutoTranslate) {
              setTimeout(async () => {
                try {
                  console.log(`ğŸ”„ é™é»˜æ¢å¤ç¿»è¯‘çŠ¶æ€: ${LANGUAGE_MAP[targetLanguage]}`);
                  await translatePage(targetLanguage, true);
                  console.log('âœ… ç¿»è¯‘çŠ¶æ€è‡ªåŠ¨æ¢å¤æˆåŠŸ');
                } catch (error) {
                  console.warn('âš ï¸ è‡ªåŠ¨æ¢å¤ç¿»è¯‘å¤±è´¥:', error);
                  currentLanguage = 'chinese_simplified';
                }
              }, 500);
            }
            
            window.glmTranslateInitialized = true;
            console.log('âœ… GLMç¿»è¯‘åŠŸèƒ½åˆå§‹åŒ–å®Œæˆ');
            console.log('ğŸ¯ ä¼˜åŒ–åŠŸèƒ½çŠ¶æ€:');
            console.log(`  - Web Workers: ${TranslationWorkerManager.workers.length > 0 ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨'}`);
            console.log(`  - è™šæ‹Ÿæ»šåŠ¨: ${VirtualScrollOptimizer.observer ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨'}`);
            console.log(`  - å¿«æ·é”®æ”¯æŒ: ${ShortcutManager.isInitialized ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨'}`);
            console.log(`  - è¯­ä¹‰ç¼“å­˜: ${semanticCache ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨'}`);
            console.log(`  - ä¸“ä¸šæœ¯è¯­: ${Object.keys(TECHNICAL_TERMS).length > 0 ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨'}`);
            
          } catch (error) {
            console.error('ğŸ’¥ GLMç¿»è¯‘åŠŸèƒ½åˆå§‹åŒ–å¤±è´¥:', error);
            currentLanguage = 'chinese_simplified';
            globalTranslationPreference = null;
          }
        }
        
        if (document.readyState === 'complete') {
          initGLMTranslate();
        } else {
          document.addEventListener('DOMContentLoaded', initGLMTranslate);
        }
        
        // é¡µé¢å¸è½½æ—¶æ¸…ç†èµ„æº
        window.addEventListener('beforeunload', () => {
          try {
            if (TranslationWorkerManager && TranslationWorkerManager.destroy) {
              TranslationWorkerManager.destroy();
            }
            if (VirtualScrollOptimizer && VirtualScrollOptimizer.destroy) {
              VirtualScrollOptimizer.destroy();
            }
            console.log('ğŸ§¹ ç¿»è¯‘åŠŸèƒ½èµ„æºå·²æ¸…ç†');
          } catch (error) {
            console.warn('âš ï¸ æ¸…ç†ç¿»è¯‘åŠŸèƒ½èµ„æºæ—¶å‡ºé”™:', error);
          }
        });
        
      })();
      </script>

      <!-- é¡µè„šåŠŸèƒ½è„šæœ¬ - å·²ä¼˜åŒ– -->
      <script>
        (() => {
          'use strict';
          
          if (window.footerInitialized) return;
          
          const START_DATE = new Date('2022-10-20T00:00:00').getTime();
          let timeUpdateInterval;
          let visitCountObserver;
          
          // ä¼˜åŒ–çš„æ—¶é—´è®¡ç®—
          const calculateRuntime = () => {
            const diff = Math.floor((Date.now() - START_DATE) / 1000);
            const days = Math.floor(diff / 86400);
            const hours = Math.floor((diff % 86400) / 3600);
            const minutes = Math.floor((diff % 3600) / 60);
            const seconds = diff % 60;
            return `${days}å¤©${hours}æ—¶${minutes}åˆ†${seconds}ç§’`;
          };
          
          const updateTime = () => {
            const time = calculateRuntime();
            const desktop = document.getElementById('box1');
            const mobile = document.getElementById('box1_mobile');
            
            if (desktop) desktop.textContent = time;
            if (mobile) mobile.textContent = time;
          };
          
          const loadVisitCounter = () => {
            if (document.querySelector('script[src*="finicounter.eu.org"]')) return;
            
            const script = document.createElement('script');
            script.src = '//finicounter.eu.org/finicounter.js';
            script.async = true;
            script.onerror = () => {
              const desktop = document.getElementById('finicount_views');
              const mobile = document.getElementById('finicount_views_mobile');
              if (desktop) desktop.textContent = 'ç»Ÿè®¡ä¸­...';
              if (mobile) mobile.textContent = 'ç»Ÿè®¡ä¸­...';
            };
            document.head.appendChild(script);
          };
          
          const syncVisitCount = () => {
            const desktop = document.getElementById('finicount_views');
            const mobile = document.getElementById('finicount_views_mobile');
            if (desktop?.textContent && mobile && !desktop.textContent.includes('åŠ è½½ä¸­')) {
              mobile.textContent = desktop.textContent;
            }
          };
          
          const setupVisitCountObserver = () => {
            const desktop = document.getElementById('finicount_views');
            if (!desktop) return;
            if (visitCountObserver) visitCountObserver.disconnect();
            visitCountObserver = new MutationObserver(syncVisitCount);
            visitCountObserver.observe(desktop, { childList: true, characterData: true });
          };
          
          const cleanup = () => {
            if (timeUpdateInterval) {
              clearInterval(timeUpdateInterval);
              timeUpdateInterval = null;
            }
            if (visitCountObserver) {
              visitCountObserver.disconnect();
              visitCountObserver = null;
            }
          };
          
          const init = () => {
            cleanup();
            updateTime();
            timeUpdateInterval = setInterval(updateTime, 1000);
            loadVisitCounter();
            setupVisitCountObserver();
          };
          
          if (window.document$ && !window.document$.isStopped) {
            window.document$.subscribe(() => setTimeout(init, 200));
          } else {
            if (document.readyState === 'loading') {
              document.addEventListener('DOMContentLoaded', init);
            } else {
              setTimeout(init, 100);
            }
          }
          
          window.addEventListener('beforeunload', cleanup);
          window.footerInitialized = true;
        })();
      </script>

      <!-- ä¼˜åŒ–çš„æ ·å¼ -->
      <style>
        /* Footer backgrounds */
        .md-footer {
          background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        }
        .md-footer-meta {
          background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }

        /* Layout containers */
        .footer-wrapper {
          width: 100%;
          padding: 0.2rem 0;
          text-align: center;
        }
        .footer-content {
          max-width: 900px;
          margin: 0 auto;
          padding: 0.4rem 0 0;
          display: flex;
          justify-content: center;
        }
        .footer-bottom-section {
          max-width: 900px;
          margin: 0.4rem auto 0;
          padding: 0.4rem 1rem;
          border-top: 1px solid rgba(255, 255, 255, 0.15);
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        /* Visit count styles */
        .footer-visit-count {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.3rem;
          font-size: 0.75rem;
          color: var(--md-footer-fg-color--light);
          width: 100%;
        }
        .footer-item {
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 0.4rem 0.8rem;
          border-radius: 16px;
          background: rgba(255, 255, 255, 0.1);
          border: 1px solid rgba(255, 255, 255, 0.15);
          -webkit-backdrop-filter: blur(10px);
          backdrop-filter: blur(10px);
          min-width: 160px;
          font-size: 0.8rem;
          transition: all 0.2s ease;
        }
        .footer-item:hover {
          background: rgba(255, 255, 255, 0.15);
          border-color: rgba(81, 143, 193, 0.4);
          transform: translateY(-1px);
        }
        .footer-highlight {
          color: #C2C4C9;
          font-weight: 600;
          margin-left: 0.3rem;
        }

        /* Copyright and social styles */
        .md-footer-copyright {
          text-align: left;
          font-size: 0.75rem;
          opacity: 0.8;
          line-height: 1.2;
        }
        .footer-social {
          display: flex;
          gap: 0.3rem;
          align-items: center;
        }
        .icp-link {
          color: inherit;
          text-decoration: none;
        }
        .icp-link:hover {
          color: #518FC1;
        }

        /* Mobile responsive design */
        @media (max-width: 76.1875em) {
          .footer-visit-count { display: none; }
          .footer-visit-count-mobile {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 0.4em 0.8em;
            padding: 0.2em 0;
            font-size: 0.75rem;
            color: var(--md-footer-fg-color--light);
            text-align: center;
          }
          .footer-bottom-section {
            flex-direction: column;
            gap: 0.6rem;
            text-align: center;
          }
          .md-footer-copyright { text-align: center; }
        }

        /* Desktop specific styles */
        @media (min-width: 76.1875em) {
          .footer-visit-count-mobile { display: none; }
          .footer-visit-count { 
            flex-direction: row; 
            gap: 2rem;
            justify-content: center;
          }
        }
      </style>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "navigation.prune", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "search.share", "toc.follow", "navigation.expand", "navigation.indexes", "content.tabs.link", "content.tooltips", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/javascripts/unified-instant-handler.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/javascripts/extra.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/javascripts/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/javascripts/view.js"></script>
      
    
  </body>
</html>